# CubiCal Docker - Quick Start

## 1. Check NVIDIA Docker Runtime

```bash
docker run --rm --gpus all nvidia/cuda:11.1-base nvidia-smi
```

If this fails, install nvidia-docker2 (see README.md).

## 2. Build Image

```bash
cd /data/dsa110-contimg/docker/cubical_experimental
docker build -t dsa110-cubical:experimental -f Dockerfile ../..
```

This may take 10-20 minutes (downloads and builds dependencies).

## 3. Run Calibration

### Option A: Using convenience script

```bash
./run_cubical.sh \
  --ms /scratch/ms/timesetv3/caltables/2025-10-29T13:54:17.cal.ms \
  --field 0 \
  --output-dir /scratch/calibration_test/cubical
```

### Option B: Interactive container

```bash
docker run -it --rm --gpus all \
  -v /scratch:/scratch:ro \
  -v /scratch/calibration_test:/workspace/output:rw \
  -v /data/dsa110-contimg/src/dsa110_contimg/calibration/cubical_experimental:/workspace/cubical_experimental:ro \
  dsa110-cubical:experimental \
  bash

# Inside container:
conda activate cubical
python -m cubical_experimental.cubical_cli \
  --ms /scratch/ms/timesetv3/caltables/2025-10-29T13:54:17.cal.ms \
  --field 0 \
  --output-dir /workspace/output
```

## Benefits

:check_mark: Isolated from Ubuntu 18.x compatibility issues :check_mark: Clean Ubuntu 20.04
environment :check_mark: GPU access via NVIDIA runtime :check_mark: No conflicts with existing CASA
installation :check_mark: Easy to remove if not needed
