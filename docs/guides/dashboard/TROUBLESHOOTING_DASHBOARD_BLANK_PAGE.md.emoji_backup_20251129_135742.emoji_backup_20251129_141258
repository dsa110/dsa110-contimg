# Troubleshooting: Dashboard Blank White Page

Quick reference guide for fixing the blank white page issue and related
problems.

## Symptoms

- Dashboard loads but shows only a blank white page
- Browser console shows JavaScript errors preventing React from rendering
- API connection failures
- Test failures after dependency upgrades

## Root Causes & Solutions

### 1. TypeScript Import/Export Errors

**Error:**
`The requested module '/src/types/workflow.ts' does not provide an export named 'BreadcrumbItem'`

**Cause:** With `verbatimModuleSyntax: true` in `tsconfig.app.json`, type-only
imports must use `import type`.

**Fix:**

```typescript
// :cross_mark: Wrong - causes runtime error
import { BreadcrumbItem, WorkflowType } from "../types/workflow";

// :white_heavy_check_mark: Correct - separates type and value imports
import type { BreadcrumbItem, WorkflowType } from "../types/workflow";
import { NAVIGATION_RULES } from "../types/workflow";
```

**Also ensure:** Type definitions are declared before they're used in other
interfaces.

### 2. MUI v7 Compatibility Issues

**Error:** `'@mui/material' does not provide an export named 'SlideProps'`

**Cause:** MUI v7 doesn't export `SlideProps` directly.

**Fix:**

```typescript
// :cross_mark: Wrong
import { Slide, SlideProps } from "@mui/material";
function SlideTransition(props: SlideProps) { ... }

// :white_heavy_check_mark: Correct
import { Slide } from "@mui/material";
import type { ComponentProps } from "react";
function SlideTransition(props: ComponentProps<typeof Slide>) { ... }
```

### 3. Vitest Running Playwright Tests

**Error:** `Playwright Test did not expect test.describe() to be called here`

**Cause:** After dependency upgrades, Vitest tries to run Playwright E2E tests.

**Fix in `vitest.config.ts`:**

```typescript
test: {
  // ... other config ...
  include: ["**/*.{test,spec}.{js,mjs,cjs,ts,mts,cts,jsx,tsx}"],
  exclude: [
    "**/node_modules/**",
    "**/dist/**",
    "**/e2e/**",
    "**/tests/e2e/**",
    "**/tests/playwright/**",  // :arrow_left: Add this
    // ... other excludes ...
  ],
  // Fix worker timeout issues on FUSE filesystems
  pool: "threads",
  poolOptions: {
    threads: {
      singleThread: true,
    },
  },
}
```

### 4. npm Install Failures on FUSE Filesystems

**Error:** `ENOTEMPTY: directory not empty` during npm install

**Cause:** FUSE filesystems have issues with atomic rename operations.

**Fix:** Use installation script with FUSE-friendly flags:

```bash
cd /data/dsa110-contimg/frontend
conda activate casa6
npm install \
  --no-optional \
  --legacy-peer-deps \
  --prefer-offline \
  --loglevel=error
```

Or move `node_modules` instead of deleting:

```bash
mv node_modules node_modules.old
npm install
```

### 5. Backend API Not Running

**Error:** API connection failures in dashboard

**Check:**

```bash
# Check if backend is running
lsof -i :8000

# Test backend directly
curl http://127.0.0.1:8000/api/health

# Test through Vite proxy
curl http://localhost:5173/api/health
```

**Start backend:**

```bash
cd /data/dsa110-contimg
source /opt/miniforge/etc/profile.d/conda.sh
conda activate casa6
uvicorn dsa110_contimg.api:app --host 0.0.0.0 --port 8000 --reload
```

## Quick Diagnostic Checklist

When dashboard shows blank page:

1. **Open browser console (F12)** - Look for JavaScript errors
2. **Check for import/export errors** - Look for "does not provide an export"
   messages
3. **Verify TypeScript config** - Check `verbatimModuleSyntax` setting
4. **Check MUI version compatibility** - Use `ComponentProps<typeof Component>`
   instead of `ComponentProps`
5. **Verify backend is running** - Test `/api/health` endpoint
6. **Clear Vite cache** - `rm -rf node_modules/.vite` and restart dev server
7. **Hard refresh browser** - Ctrl+Shift+R (or Cmd+Shift+R on Mac)

## Common Patterns

### Type-Only Imports Pattern

```typescript
// Always separate type imports from value imports
import type { Type1, Type2 } from "./types";
import { value1, value2 } from "./values";
```

### Component Props Pattern (MUI v7)

```typescript
// Use ComponentProps instead of exported Props types
import type { ComponentProps } from "react";
import { Slide } from "@mui/material";

type SlideProps = ComponentProps<typeof Slide>;
```

### Interface Declaration Order

```typescript
// Declare interfaces before they're used
export interface BreadcrumbItem { ... }
export interface WorkflowContext {
  breadcrumbs: BreadcrumbItem[];  // :white_heavy_check_mark: BreadcrumbItem already defined
}
```

## Prevention

1. **After dependency upgrades:**
   - Run tests immediately
   - Check for new TypeScript/MUI breaking changes
   - Review changelogs for import/export changes

2. **When adding new imports:**
   - Use `import type` for interfaces/types
   - Use regular `import` only for runtime values
   - Verify with TypeScript compiler: `npx tsc --noEmit`

3. **Before committing:**
   - Clear Vite cache and test fresh build
   - Verify backend connectivity
   - Check browser console for errors

## Related Files

- `frontend/vitest.config.ts` - Test configuration
- `frontend/tsconfig.app.json` - TypeScript configuration
- `frontend/vite.config.ts` - Vite/API proxy configuration
- `frontend/src/types/workflow.ts` - Type definitions
- `frontend/src/contexts/WorkflowContext.tsx` - Context using types
