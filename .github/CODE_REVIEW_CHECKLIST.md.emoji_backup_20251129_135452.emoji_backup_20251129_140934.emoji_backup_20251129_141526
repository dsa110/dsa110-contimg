# Code Review Checklist

**For reviewers:** Use this checklist when reviewing pull requests.

---

## Critical Checks (Must Pass)

### Environment & Setup

- [ ] **Python environment:** Code uses casa6 Python, not system Python
  - Check for: `/opt/miniforge/envs/casa6/bin/python` or wrapper scripts
  - Reject if: Uses `python` or `python3` directly

- [ ] **Documentation location:** No markdown files in root directory
  - Check: Are any `.md` files in root (except README.md)?
  - Reject if: New markdown files in root

- [ ] **Test organization:** Tests follow taxonomy
  - Check: `tests/<type>/<module>/test_*.py`
  - Reject if: Tests in wrong location

### Code Quality

- [ ] **No hardcoded secrets:** Secrets use environment variables
  - Check: No passwords, API keys, tokens in code
  - Reject if: Secrets hardcoded

- [ ] **No console.log in production:** Debug statements removed
  - Check: Frontend code has no `console.log` or `console.debug`
  - Reject if: Debug statements present (unless intentional)

- [ ] **Error handling:** Appropriate error handling present
  - Check: Errors are caught and handled
  - Reject if: Errors are ignored or swallowed

---

## Important Checks (Should Pass)

### Documentation

- [ ] **Code comments:** Complex logic is commented
  - Check: "Why" comments, not just "what"
  - Request changes if: Logic is unclear

- [ ] **API documentation:** API changes are documented
  - Check: New endpoints documented
  - Request changes if: API changes undocumented

- [ ] **README updates:** README updated if needed
  - Check: New features documented
  - Request changes if: User-facing changes undocumented

### Testing

- [ ] **Test coverage:** New code has tests
  - Check: Tests for new functionality
  - Request changes if: No tests for new code

- [ ] **Test quality:** Tests are meaningful
  - Check: Tests actually test functionality
  - Request changes if: Tests are trivial or missing

### Code Style

- [ ] **Prettier formatting:** Code is formatted
  - Check: No formatting issues
  - Request changes if: Code not formatted

- [ ] **TypeScript types:** Types are correct
  - Check: No `any` types (unless justified)
  - Request changes if: Types are incorrect

- [ ] **Linting:** No linting errors
  - Check: ESLint passes
  - Request changes if: Linting errors

---

## Nice-to-Have Checks

### Architecture

- [ ] **Pattern consistency:** Follows existing patterns
  - Check: Code matches project patterns
  - Comment if: Different pattern used (may be intentional)

- [ ] **Code duplication:** No unnecessary duplication
  - Check: Code is DRY
  - Comment if: Duplication could be reduced

- [ ] **Performance:** Performance considerations addressed
  - Check: No obvious performance issues
  - Comment if: Performance could be improved

### Domain Knowledge

- [ ] **Radio astronomy correctness:** Scientific correctness
  - Check: Radio astronomy terms used correctly
  - Request expert review if: Scientific code changed

- [ ] **CASA usage:** CASA commands are correct
  - Check: CASA usage follows patterns
  - Request expert review if: CASA code changed

---

## Documentation-Specific Review

### When Reviewing Documentation Changes

- [ ] **Location:** Documentation in correct location
  - Check: `docs/` structure followed
  - Reject if: In root or wrong location

- [ ] **Format:** Documentation follows format
  - Check: Markdown formatting correct
  - Request changes if: Formatting issues

- [ ] **Completeness:** Documentation is complete
  - Check: All sections filled
  - Request changes if: Incomplete

- [ ] **Accuracy:** Documentation is accurate
  - Check: Matches code
  - Request changes if: Outdated or incorrect

---

## Red Flags (Immediate Reject)

### Security

- [ ] **Secrets:** No secrets in code
- [ ] **SQL injection:** No SQL injection vulnerabilities
- [ ] **XSS:** No XSS vulnerabilities
- [ ] **Authentication:** Authentication handled correctly

### Data Integrity

- [ ] **Data paths:** Correct data paths used
- [ ] **Database schema:** Schema changes are safe
- [ ] **Data validation:** Input validation present

### Critical Bugs

- [ ] **Python environment:** Correct Python used
- [ ] **Dependencies:** Dependencies are correct
- [ ] **Breaking changes:** Breaking changes documented

---

## Review Comments Template

### For Documentation Issues

```
:cross_mark: Documentation Location Issue

The file `FILENAME.md` is in the root directory. Documentation must be in the `docs/` structure.

Please move to: `docs/dev/status/YYYY-MM/FILENAME.md`

See: `docs/DOCUMENTATION_QUICK_REFERENCE.md`
```

### For Python Environment Issues

```
:cross_mark: Python Environment Issue

This code uses system Python instead of casa6 Python.

Please use:
- `/opt/miniforge/envs/casa6/bin/python`
- Or: `./scripts/run-python.sh script.py`

See: `docs/reference/CRITICAL_PYTHON_ENVIRONMENT.md`
```

### For Test Organization Issues

```
:cross_mark: Test Organization Issue

The test file is not in the correct location.

Please move to: `tests/<type>/<module>/test_*.py`

Types: unit, integration, smoke, science, e2e

See: `docs/concepts/TEST_ORGANIZATION.md`
```

---

## Approval Criteria

**Approve if:**

- All critical checks pass
- All important checks pass (or minor issues)
- Code is ready for merge

**Request changes if:**

- Any critical check fails
- Multiple important checks fail
- Code needs significant improvement

**Comment if:**

- Nice-to-have improvements possible
- Questions about implementation
- Suggestions for future improvements

---

## Related Documentation

- `docs/how-to/DEVELOPER_HANDOFF_WARNINGS.md` - Developer warnings
- `docs/how-to/CODE_REVIEW_GUIDELINES.md` - Detailed review guidelines (if
  exists)
- `docs/concepts/TEST_ORGANIZATION.md` - Test organization rules
- `docs/DOCUMENTATION_QUICK_REFERENCE.md` - Documentation location rules
