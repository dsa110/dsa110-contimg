#!/bin/bash
# Setup script to add PYTHONWARNINGS to shell profile for persistent warning suppression

set -e

# Find shell profile file
PROFILE_FILE=""
if [ -f "$HOME/.bashrc" ]; then
    PROFILE_FILE="$HOME/.bashrc"
elif [ -f "$HOME/.bash_profile" ]; then
    PROFILE_FILE="$HOME/.bash_profile"
elif [ -f "$HOME/.zshrc" ]; then
    PROFILE_FILE="$HOME/.zshrc"
elif [ -f "$HOME/.profile" ]; then
    PROFILE_FILE="$HOME/.profile"
else
    echo "No shell profile found. Creating ~/.bashrc"
    PROFILE_FILE="$HOME/.bashrc"
    touch "$PROFILE_FILE"
fi

# Check if already set
if grep -q "PYTHONWARNINGS.*ignore::DeprecationWarning" "$PROFILE_FILE" 2>/dev/null; then
    echo ":check_mark: PYTHONWARNINGS already set in $PROFILE_FILE"
    exit 0
fi

# Add to profile
echo "" >> "$PROFILE_FILE"
echo "# Suppress SWIG deprecation warnings from CASA/casacore" >> "$PROFILE_FILE"
echo "# Added by dsa110-contimg setup script" >> "$PROFILE_FILE"
echo "export PYTHONWARNINGS=\"ignore::DeprecationWarning\"" >> "$PROFILE_FILE"

echo ":check_mark: Added PYTHONWARNINGS to $PROFILE_FILE"
echo ""
echo "To apply immediately, run:"
echo "  source $PROFILE_FILE"
echo ""
echo "Or start a new terminal session."

