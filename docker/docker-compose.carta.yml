version: "3.3"

services:
  carta:
    image: cartavis/carta:latest
    container_name: carta-backend
    restart: unless-stopped
    ports:
      - "9002:3002" # CARTA frontend and backend (unified port)
    volumes:
      - /data/dsa110-contimg:/images/data:ro
      - /stage/dsa110-contimg:/images/stage:ro
    environment:
      - CARTA_AUTH_TOKEN=
    healthcheck:
      test: ["CMD-SHELL", "pgrep carta_backend || exit 1"]
      interval: 30s
      timeout: 10s
      retries: 3
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"
