import{r as x,j as e,L as N}from"./index-DJCdKSO1.js";import{b as S}from"./useQueries-HkAdx01S.js";import{r as v}from"./relativeTime-Dp84ug83.js";import{a as o,L as w}from"./appStore-B4B387X2.js";import{u as k,S as u}from"./SortableTableHeader-Dy-EIrof.js";const $=()=>{const{data:d,isLoading:b,error:h}=S(),{sortKey:n,sortDirection:a,handleSort:c,sortItems:m}=k("started_at","desc"),l=o(t=>t.selectedJobs),p=o(t=>t.toggleJobSelection),j=o(t=>t.selectAllJobs),f=o(t=>t.clearJobSelection),s=x.useMemo(()=>Array.from(l),[l]),i=x.useCallback(async t=>{if(s.length===0)return;const g="https://ronnie-unsectarian-antone.ngrok-free.dev/api";t==="export"?window.open(`${g}/jobs/export?ids=${s.join(",")}`,"_blank"):await fetch(`${g}/jobs/bulk-${t}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({runIds:s})})},[s]),r=x.useMemo(()=>d?m(d,n,a):[],[d,n,a,m]);if(b)return e.jsx(w,{label:"Loading jobs..."});if(h)return e.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:["Failed to load jobs: ",h.message]});const y=t=>{switch(t){case"completed":return"badge-success";case"running":return"badge-info";case"failed":return"badge-error";case"pending":return"badge-warning";default:return"bg-gray-100 text-gray-800"}};return e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Pipeline Jobs"}),s.length>0&&e.jsxs("span",{className:"text-sm text-gray-500",children:[s.length," selected"]})]}),s.length>0&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>i("rerun"),className:"px-3 py-1.5 rounded text-sm font-medium bg-blue-600 text-white hover:bg-blue-700",children:"Rerun Selected"}),e.jsx("button",{onClick:()=>i("cancel"),className:"px-3 py-1.5 rounded text-sm font-medium bg-orange-600 text-white hover:bg-orange-700",children:"Cancel Selected"}),e.jsx("button",{onClick:()=>i("export"),className:"px-3 py-1.5 rounded text-sm font-medium bg-green-600 text-white hover:bg-green-700",children:"Export Logs"})]})]}),r&&r.length>0?e.jsx("div",{className:"card overflow-hidden",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"w-10 px-3 py-3",children:e.jsx("input",{type:"checkbox",checked:s.length===r.length&&r.length>0,ref:t=>{t&&(t.indeterminate=s.length>0&&s.length<r.length)},onChange:()=>{s.length===r.length?f():j(r.map(t=>t.run_id))},className:"h-4 w-4 text-blue-600 rounded"})}),e.jsx(u,{label:"Run ID",sortKey:"run_id",currentSortKey:n,direction:a,onSort:c}),e.jsx(u,{label:"Status",sortKey:"status",currentSortKey:n,direction:a,onSort:c,className:"text-center"}),e.jsx(u,{label:"Started",sortKey:"started_at",currentSortKey:n,direction:a,onSort:c,className:"text-right"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:r.map(t=>e.jsxs("tr",{className:l.has(t.run_id)?"bg-blue-50":"",children:[e.jsx("td",{className:"px-3",children:e.jsx("input",{type:"checkbox",checked:l.has(t.run_id),onChange:()=>p(t.run_id),className:"h-4 w-4 text-blue-600 rounded"})}),e.jsx("td",{children:e.jsx(N,{to:`/jobs/${t.run_id}`,className:"text-blue-600 hover:text-blue-800 font-medium",children:t.run_id})}),e.jsx("td",{className:"text-center",children:e.jsx("span",{className:`badge ${y(t.status)}`,children:t.status})}),e.jsx("td",{className:"text-right text-gray-500",children:t.started_at?v(t.started_at):"â€”"})]},t.run_id))})]})}):e.jsx("p",{className:"text-gray-500",children:"No jobs found."})]})};export{$ as default};
//# sourceMappingURL=JobsListPage-Bag4nXtH.js.map
