{"version":3,"file":"ImageDetailPage-DHISEv8R.js","sources":["../../src/components/common/ImageThumbnail.tsx","../../src/components/fits/FitsViewerControls.tsx","../../src/components/fits/FitsViewer.tsx","../../src/components/rating/RatingCard.tsx","../../src/pages/ImageDetailPage.tsx"],"sourcesContent":["import React, { useState } from \"react\";\n\nexport interface ImageThumbnailProps {\n  /** Image ID for fetching thumbnail */\n  imageId: string;\n  /** Alt text for the image */\n  alt?: string;\n  /** Size variant */\n  size?: \"sm\" | \"md\" | \"lg\";\n  /** Click handler */\n  onClick?: () => void;\n  /** Show expand on hover */\n  expandable?: boolean;\n  /** API base URL */\n  apiUrl?: string;\n}\n\nconst sizeClasses = {\n  sm: \"w-24 h-24\",\n  md: \"w-48 h-48\",\n  lg: \"w-72 h-72\",\n};\n\n/**\n * Display an image thumbnail with loading state and error handling.\n * Falls back to a placeholder if the image can't be loaded.\n */\nconst ImageThumbnail: React.FC<ImageThumbnailProps> = ({\n  imageId,\n  alt = \"Image preview\",\n  size = \"md\",\n  onClick,\n  expandable = true,\n  apiUrl = import.meta.env.VITE_API_URL || \"http://127.0.0.1:8000/api\",\n}) => {\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(false);\n  const [expanded, setExpanded] = useState(false);\n\n  // Thumbnail URL - assumes backend provides /images/{id}/thumbnail endpoint\n  const thumbnailUrl = `${apiUrl}/images/${imageId}/thumbnail`;\n\n  const handleLoad = () => {\n    setLoading(false);\n    setError(false);\n  };\n\n  const handleError = () => {\n    setLoading(false);\n    setError(true);\n  };\n\n  const handleClick = () => {\n    if (onClick) {\n      onClick();\n    } else if (expandable) {\n      setExpanded(!expanded);\n    }\n  };\n\n  return (\n    <>\n      <div\n        className={`relative ${\n          sizeClasses[size]\n        } bg-gray-100 rounded-lg overflow-hidden border border-gray-200 ${\n          onClick || expandable ? \"cursor-pointer hover:border-blue-400 transition-colors\" : \"\"\n        }`}\n        onClick={handleClick}\n        role={onClick || expandable ? \"button\" : undefined}\n        tabIndex={onClick || expandable ? 0 : undefined}\n        onKeyDown={(e) => {\n          if ((e.key === \"Enter\" || e.key === \" \") && (onClick || expandable)) {\n            handleClick();\n          }\n        }}\n      >\n        {/* Loading state */}\n        {loading && !error && (\n          <div className=\"absolute inset-0 flex items-center justify-center\">\n            <div className=\"animate-pulse flex flex-col items-center\">\n              <svg\n                className=\"w-8 h-8 text-gray-300\"\n                fill=\"none\"\n                stroke=\"currentColor\"\n                viewBox=\"0 0 24 24\"\n              >\n                <path\n                  strokeLinecap=\"round\"\n                  strokeLinejoin=\"round\"\n                  strokeWidth={2}\n                  d=\"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z\"\n                />\n              </svg>\n              <span className=\"text-xs text-gray-400 mt-1\">Loading...</span>\n            </div>\n          </div>\n        )}\n\n        {/* Error/placeholder state */}\n        {error && (\n          <div className=\"absolute inset-0 flex items-center justify-center bg-gray-50\">\n            <div className=\"flex flex-col items-center text-gray-400\">\n              <svg className=\"w-8 h-8\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path\n                  strokeLinecap=\"round\"\n                  strokeLinejoin=\"round\"\n                  strokeWidth={2}\n                  d=\"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z\"\n                />\n              </svg>\n              <span className=\"text-xs mt-1\">No preview</span>\n            </div>\n          </div>\n        )}\n\n        {/* Actual image */}\n        <img\n          src={thumbnailUrl}\n          alt={alt}\n          className={`w-full h-full object-cover ${loading || error ? \"hidden\" : \"\"}`}\n          onLoad={handleLoad}\n          onError={handleError}\n        />\n\n        {/* Expand indicator */}\n        {expandable && !error && !loading && (\n          <div className=\"absolute bottom-1 right-1 bg-black/50 rounded p-1\">\n            <svg\n              className=\"w-4 h-4 text-white\"\n              fill=\"none\"\n              stroke=\"currentColor\"\n              viewBox=\"0 0 24 24\"\n            >\n              <path\n                strokeLinecap=\"round\"\n                strokeLinejoin=\"round\"\n                strokeWidth={2}\n                d=\"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4\"\n              />\n            </svg>\n          </div>\n        )}\n      </div>\n\n      {/* Expanded modal */}\n      {expanded && (\n        <div\n          className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/80\"\n          onClick={() => setExpanded(false)}\n          role=\"dialog\"\n          aria-modal=\"true\"\n        >\n          <div className=\"relative max-w-4xl max-h-[90vh] p-4\">\n            <img\n              src={thumbnailUrl}\n              alt={alt}\n              className=\"max-w-full max-h-[85vh] object-contain rounded-lg\"\n            />\n            <button\n              className=\"absolute top-2 right-2 bg-white/90 rounded-full p-2 hover:bg-white transition-colors\"\n              onClick={() => setExpanded(false)}\n              aria-label=\"Close\"\n            >\n              <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path\n                  strokeLinecap=\"round\"\n                  strokeLinejoin=\"round\"\n                  strokeWidth={2}\n                  d=\"M6 18L18 6M6 6l12 12\"\n                />\n              </svg>\n            </button>\n          </div>\n        </div>\n      )}\n    </>\n  );\n};\n\nexport default ImageThumbnail;\n","import React, { useState } from \"react\";\n\nexport interface FitsViewerControlsProps {\n  /** Current color map */\n  colorMap: string;\n  /** Current scale type */\n  scale: string;\n  /** Current contrast level (0-1) */\n  contrast: number;\n  /** Current bias level (0-1) */\n  bias: number;\n  /** Whether regions are visible */\n  showRegions: boolean;\n  /** Whether crosshair is visible */\n  showCrosshair: boolean;\n  /** Change handler */\n  onChange: (values: Partial<FitsViewerControlsValues>) => void;\n  /** Zoom in handler */\n  onZoomIn?: () => void;\n  /** Zoom out handler */\n  onZoomOut?: () => void;\n  /** Zoom to fit handler */\n  onZoomFit?: () => void;\n  /** Export handler */\n  onExport?: (format: \"png\" | \"fits\") => void;\n}\n\nexport interface FitsViewerControlsValues {\n  colorMap: string;\n  scale: string;\n  contrast: number;\n  bias: number;\n  showRegions: boolean;\n  showCrosshair: boolean;\n}\n\nconst COLOR_MAPS = [\n  \"grey\",\n  \"heat\",\n  \"cool\",\n  \"rainbow\",\n  \"viridis\",\n  \"plasma\",\n  \"magma\",\n  \"inferno\",\n  \"cubehelix\",\n  \"red\",\n  \"green\",\n  \"blue\",\n];\n\nconst SCALES = [\"linear\", \"log\", \"sqrt\", \"squared\", \"asinh\", \"sinh\", \"histeq\", \"power\"];\n\n/**\n * Control panel for FITS viewer settings.\n */\nconst FitsViewerControls: React.FC<FitsViewerControlsProps> = ({\n  colorMap,\n  scale,\n  contrast,\n  bias,\n  showRegions,\n  showCrosshair,\n  onChange,\n  onZoomIn,\n  onZoomOut,\n  onZoomFit,\n  onExport,\n}) => {\n  const [isExpanded, setIsExpanded] = useState(true);\n\n  return (\n    <div className=\"bg-white border border-gray-200 rounded-lg overflow-hidden\">\n      {/* Header */}\n      <button\n        onClick={() => setIsExpanded(!isExpanded)}\n        className=\"w-full flex items-center justify-between px-3 py-2 bg-gray-50 hover:bg-gray-100 transition-colors\"\n      >\n        <span className=\"font-semibold text-sm text-gray-700\">Display Settings</span>\n        <svg\n          className={`w-4 h-4 text-gray-500 transition-transform ${isExpanded ? \"rotate-180\" : \"\"}`}\n          fill=\"none\"\n          stroke=\"currentColor\"\n          viewBox=\"0 0 24 24\"\n        >\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 9l-7 7-7-7\" />\n        </svg>\n      </button>\n\n      {isExpanded && (\n        <div className=\"p-3 space-y-4\">\n          {/* Zoom buttons */}\n          <div className=\"flex gap-2\">\n            <button\n              onClick={onZoomIn}\n              className=\"flex-1 px-2 py-1.5 text-sm bg-gray-100 hover:bg-gray-200 rounded transition-colors\"\n              title=\"Zoom in\"\n            >\n              <svg\n                className=\"w-4 h-4 mx-auto\"\n                fill=\"none\"\n                stroke=\"currentColor\"\n                viewBox=\"0 0 24 24\"\n              >\n                <path\n                  strokeLinecap=\"round\"\n                  strokeLinejoin=\"round\"\n                  strokeWidth={2}\n                  d=\"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM10 7v6m3-3H7\"\n                />\n              </svg>\n            </button>\n            <button\n              onClick={onZoomOut}\n              className=\"flex-1 px-2 py-1.5 text-sm bg-gray-100 hover:bg-gray-200 rounded transition-colors\"\n              title=\"Zoom out\"\n            >\n              <svg\n                className=\"w-4 h-4 mx-auto\"\n                fill=\"none\"\n                stroke=\"currentColor\"\n                viewBox=\"0 0 24 24\"\n              >\n                <path\n                  strokeLinecap=\"round\"\n                  strokeLinejoin=\"round\"\n                  strokeWidth={2}\n                  d=\"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM7 10h6\"\n                />\n              </svg>\n            </button>\n            <button\n              onClick={onZoomFit}\n              className=\"flex-1 px-2 py-1.5 text-sm bg-gray-100 hover:bg-gray-200 rounded transition-colors\"\n              title=\"Fit to window\"\n            >\n              <svg\n                className=\"w-4 h-4 mx-auto\"\n                fill=\"none\"\n                stroke=\"currentColor\"\n                viewBox=\"0 0 24 24\"\n              >\n                <path\n                  strokeLinecap=\"round\"\n                  strokeLinejoin=\"round\"\n                  strokeWidth={2}\n                  d=\"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4\"\n                />\n              </svg>\n            </button>\n          </div>\n\n          {/* Color map */}\n          <div>\n            <label className=\"block text-sm text-gray-600 mb-1\">Color Map</label>\n            <select\n              value={colorMap}\n              onChange={(e) => onChange({ colorMap: e.target.value })}\n              className=\"w-full px-2 py-1.5 border border-gray-300 rounded text-sm\"\n            >\n              {COLOR_MAPS.map((cm) => (\n                <option key={cm} value={cm}>\n                  {cm.charAt(0).toUpperCase() + cm.slice(1)}\n                </option>\n              ))}\n            </select>\n          </div>\n\n          {/* Scale */}\n          <div>\n            <label className=\"block text-sm text-gray-600 mb-1\">Scale</label>\n            <select\n              value={scale}\n              onChange={(e) => onChange({ scale: e.target.value })}\n              className=\"w-full px-2 py-1.5 border border-gray-300 rounded text-sm\"\n            >\n              {SCALES.map((s) => (\n                <option key={s} value={s}>\n                  {s.charAt(0).toUpperCase() + s.slice(1)}\n                </option>\n              ))}\n            </select>\n          </div>\n\n          {/* Contrast slider */}\n          <div>\n            <label className=\"flex items-center justify-between text-sm text-gray-600 mb-1\">\n              <span>Contrast</span>\n              <span className=\"text-gray-400\">{(contrast * 100).toFixed(0)}%</span>\n            </label>\n            <input\n              type=\"range\"\n              min={0}\n              max={1}\n              step={0.01}\n              value={contrast}\n              onChange={(e) => onChange({ contrast: parseFloat(e.target.value) })}\n              className=\"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-primary\"\n            />\n          </div>\n\n          {/* Bias slider */}\n          <div>\n            <label className=\"flex items-center justify-between text-sm text-gray-600 mb-1\">\n              <span>Bias</span>\n              <span className=\"text-gray-400\">{(bias * 100).toFixed(0)}%</span>\n            </label>\n            <input\n              type=\"range\"\n              min={0}\n              max={1}\n              step={0.01}\n              value={bias}\n              onChange={(e) => onChange({ bias: parseFloat(e.target.value) })}\n              className=\"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-primary\"\n            />\n          </div>\n\n          {/* Toggle options */}\n          <div className=\"space-y-2 pt-2 border-t border-gray-100\">\n            <label className=\"flex items-center gap-2 cursor-pointer\">\n              <input\n                type=\"checkbox\"\n                checked={showRegions}\n                onChange={(e) => onChange({ showRegions: e.target.checked })}\n                className=\"w-4 h-4 rounded\"\n              />\n              <span className=\"text-sm\">Show regions</span>\n            </label>\n            <label className=\"flex items-center gap-2 cursor-pointer\">\n              <input\n                type=\"checkbox\"\n                checked={showCrosshair}\n                onChange={(e) => onChange({ showCrosshair: e.target.checked })}\n                className=\"w-4 h-4 rounded\"\n              />\n              <span className=\"text-sm\">Show crosshair</span>\n            </label>\n          </div>\n\n          {/* Export buttons */}\n          {onExport && (\n            <div className=\"flex gap-2 pt-2 border-t border-gray-100\">\n              <button\n                onClick={() => onExport(\"png\")}\n                className=\"flex-1 px-2 py-1.5 text-sm bg-primary text-white rounded hover:bg-primary-dark transition-colors\"\n              >\n                Export PNG\n              </button>\n              <button\n                onClick={() => onExport(\"fits\")}\n                className=\"flex-1 px-2 py-1.5 text-sm border border-primary text-primary rounded hover:bg-primary/10 transition-colors\"\n              >\n                Export FITS\n              </button>\n            </div>\n          )}\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default FitsViewerControls;\n","import React, { useEffect, useRef, useCallback, useState } from \"react\";\nimport FitsViewerControls, { FitsViewerControlsValues } from \"./FitsViewerControls\";\n\n// Declare JS9 global from CDN\ndeclare global {\n  interface Window {\n    JS9: any;\n  }\n}\n\nexport interface FitsViewerProps {\n  /** URL to FITS file */\n  fitsUrl: string;\n  /** Optional display ID for multiple viewers */\n  displayId?: string;\n  /** Width of the viewer */\n  width?: number;\n  /** Height of the viewer */\n  height?: number;\n  /** Whether to show controls panel */\n  showControls?: boolean;\n  /** Initial center coordinates (RA, Dec in degrees) */\n  initialCenter?: { ra: number; dec: number };\n  /** Initial field of view in arcminutes */\n  initialFov?: number;\n  /** Callback on coordinate click */\n  onCoordinateClick?: (ra: number, dec: number) => void;\n  /** Callback when image loads */\n  onLoad?: () => void;\n  /** Callback on error */\n  onError?: (error: string) => void;\n  /** Custom class name */\n  className?: string;\n}\n\n/**\n * FITS image viewer using JS9 library.\n * Provides pan, zoom, color map, and scale controls.\n */\nconst FitsViewer: React.FC<FitsViewerProps> = ({\n  fitsUrl,\n  displayId = \"JS9\",\n  width = 512,\n  height = 512,\n  showControls = true,\n  initialCenter,\n  initialFov,\n  onCoordinateClick,\n  onLoad,\n  onError,\n  className = \"\",\n}) => {\n  const containerRef = useRef<HTMLDivElement>(null);\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [isJS9Ready, setIsJS9Ready] = useState(false);\n  const [cursorWCS, setCursorWCS] = useState<{ ra: string; dec: string } | null>(null);\n  const initialControlsRef = useRef<FitsViewerControlsValues | null>(null);\n\n  // Control state\n  const [controls, setControls] = useState<FitsViewerControlsValues>({\n    colorMap: \"grey\",\n    scale: \"log\",\n    contrast: 0.5,\n    bias: 0.5,\n    showRegions: true,\n    showCrosshair: false,\n  });\n\n  // Store initial controls to detect changes\n  if (initialControlsRef.current === null) {\n    initialControlsRef.current = { ...controls };\n  }\n\n  // Check if JS9 is loaded\n  useEffect(() => {\n    const checkJS9 = () => {\n      if (window.JS9 && window.JS9.Load) {\n        setIsJS9Ready(true);\n        return true;\n      }\n      return false;\n    };\n\n    if (checkJS9()) return;\n\n    // Poll for JS9 to load\n    const interval = setInterval(() => {\n      if (checkJS9()) {\n        clearInterval(interval);\n      }\n    }, 100);\n\n    // Timeout after 10 seconds\n    const timeout = setTimeout(() => {\n      clearInterval(interval);\n      if (!isJS9Ready) {\n        setError(\"JS9 library failed to load. Make sure JS9 CDN is included.\");\n        setIsLoading(false);\n      }\n    }, 10000);\n\n    return () => {\n      clearInterval(interval);\n      clearTimeout(timeout);\n    };\n  }, [isJS9Ready]);\n\n  // Load FITS image\n  useEffect(() => {\n    if (!isJS9Ready || !fitsUrl) return;\n\n    setIsLoading(true);\n    setError(null);\n\n    try {\n      window.JS9.Load(fitsUrl, {\n        display: displayId,\n        onload: (im: any) => {\n          setIsLoading(false);\n\n          // Apply initial settings\n          if (initialCenter) {\n            window.JS9.SetPan(initialCenter.ra, initialCenter.dec, {\n              display: displayId,\n            });\n          }\n          if (initialFov) {\n            window.JS9.SetZoom(\"tofit\", { display: displayId });\n          }\n\n          // Apply initial controls (from ref, not state to avoid dependency)\n          const initControls = initialControlsRef.current;\n          if (initControls) {\n            window.JS9.SetColormap(initControls.colorMap, { display: displayId });\n            window.JS9.SetScale(initControls.scale, { display: displayId });\n          }\n\n          onLoad?.();\n        },\n        onerror: (msg: string) => {\n          setError(msg || \"Failed to load FITS file\");\n          setIsLoading(false);\n          onError?.(msg);\n        },\n      });\n\n      // Set up click handler\n      if (onCoordinateClick) {\n        window.JS9.SetCallback(\n          \"onclick\",\n          (im: any, xreg: any, evt: any) => {\n            const wcs = window.JS9.PixToWCS(evt.x, evt.y, { display: displayId });\n            if (wcs) {\n              onCoordinateClick(wcs.ra, wcs.dec);\n            }\n          },\n          { display: displayId }\n        );\n      }\n\n      // Set up mouse move handler for live WCS display\n      window.JS9.SetCallback(\n        \"onmousemove\",\n        (im: any, xreg: any, evt: any) => {\n          try {\n            const wcs = window.JS9.PixToWCS(evt.x, evt.y, { display: displayId });\n            if (wcs && wcs.ra !== undefined && wcs.dec !== undefined) {\n              // Format as sexagesimal\n              const raH = wcs.ra / 15;\n              const raHours = Math.floor(raH);\n              const raMin = Math.floor((raH - raHours) * 60);\n              const raSec = ((raH - raHours) * 60 - raMin) * 60;\n              const raStr = `${raHours.toString().padStart(2, \"0\")}:${raMin\n                .toString()\n                .padStart(2, \"0\")}:${raSec.toFixed(2).padStart(5, \"0\")}`;\n\n              const decSign = wcs.dec >= 0 ? \"+\" : \"-\";\n              const decAbs = Math.abs(wcs.dec);\n              const decDeg = Math.floor(decAbs);\n              const decMin = Math.floor((decAbs - decDeg) * 60);\n              const decSec = ((decAbs - decDeg) * 60 - decMin) * 60;\n              const decStr = `${decSign}${decDeg.toString().padStart(2, \"0\")}:${decMin\n                .toString()\n                .padStart(2, \"0\")}:${decSec.toFixed(1).padStart(4, \"0\")}`;\n\n              setCursorWCS({ ra: raStr, dec: decStr });\n            }\n          } catch (e) {\n            // WCS may not be available\n          }\n        },\n        { display: displayId }\n      );\n    } catch (err) {\n      setError(String(err));\n      setIsLoading(false);\n      onError?.(String(err));\n    }\n\n    return () => {\n      if (window.JS9?.CloseImage) {\n        window.JS9.CloseImage({ display: displayId });\n      }\n    };\n  }, [\n    isJS9Ready,\n    fitsUrl,\n    displayId,\n    initialCenter,\n    initialFov,\n    onLoad,\n    onError,\n    onCoordinateClick,\n  ]);\n\n  // Apply control changes\n  useEffect(() => {\n    if (!isJS9Ready || isLoading) return;\n\n    try {\n      window.JS9.SetColormap(controls.colorMap, { display: displayId });\n      window.JS9.SetScale(controls.scale, { display: displayId });\n      window.JS9.SetParam(\"contrast\", controls.contrast, { display: displayId });\n      window.JS9.SetParam(\"bias\", controls.bias, { display: displayId });\n\n      // Toggle regions visibility (hide/show, don't delete)\n      // Use ChangeRegions to set visibility property\n      try {\n        const regions = window.JS9.GetRegions(\"all\", { display: displayId });\n        if (regions && regions.length > 0) {\n          regions.forEach((region: any) => {\n            window.JS9.ChangeRegions(\n              region.id,\n              {\n                visibility: controls.showRegions,\n              },\n              { display: displayId }\n            );\n          });\n        }\n      } catch (regionErr) {\n        // Regions may not exist yet or API differs\n        console.debug(\"Region visibility toggle:\", regionErr);\n      }\n\n      // Toggle crosshair\n      window.JS9.SetParam(\"crosshair\", controls.showCrosshair, { display: displayId });\n    } catch (err) {\n      console.warn(\"Failed to apply JS9 settings:\", err);\n    }\n  }, [controls, isJS9Ready, isLoading, displayId]);\n\n  const handleZoomIn = useCallback(() => {\n    if (window.JS9) {\n      window.JS9.SetZoom(\"in\", { display: displayId });\n    }\n  }, [displayId]);\n\n  const handleZoomOut = useCallback(() => {\n    if (window.JS9) {\n      window.JS9.SetZoom(\"out\", { display: displayId });\n    }\n  }, [displayId]);\n\n  const handleZoomFit = useCallback(() => {\n    if (window.JS9) {\n      window.JS9.SetZoom(\"tofit\", { display: displayId });\n    }\n  }, [displayId]);\n\n  const handleExport = useCallback(\n    (format: \"png\" | \"fits\") => {\n      if (!window.JS9) return;\n\n      if (format === \"png\") {\n        window.JS9.SavePNG({ display: displayId });\n      } else {\n        window.JS9.SaveFITS({ display: displayId });\n      }\n    },\n    [displayId]\n  );\n\n  const handleControlChange = (values: Partial<FitsViewerControlsValues>) => {\n    setControls((prev) => ({ ...prev, ...values }));\n  };\n\n  return (\n    <div className={`flex gap-4 ${className}`}>\n      {/* Viewer area */}\n      <div className=\"flex-1\">\n        <div\n          ref={containerRef}\n          className=\"relative bg-black rounded-lg overflow-hidden\"\n          style={{ width, height }}\n        >\n          {/* JS9 display div */}\n          <div className=\"JS9\" id={displayId} style={{ width: \"100%\", height: \"100%\" }} />\n\n          {/* Loading overlay */}\n          {isLoading && (\n            <div className=\"absolute inset-0 bg-black/50 flex items-center justify-center\">\n              <div className=\"text-center\">\n                <div className=\"w-8 h-8 border-4 border-white border-t-transparent rounded-full animate-spin mx-auto mb-2\" />\n                <span className=\"text-white text-sm\">Loading FITS...</span>\n              </div>\n            </div>\n          )}\n\n          {/* Error overlay */}\n          {error && (\n            <div className=\"absolute inset-0 bg-red-900/80 flex items-center justify-center p-4\">\n              <div className=\"text-center\">\n                <svg\n                  className=\"w-8 h-8 text-red-300 mx-auto mb-2\"\n                  fill=\"none\"\n                  stroke=\"currentColor\"\n                  viewBox=\"0 0 24 24\"\n                >\n                  <path\n                    strokeLinecap=\"round\"\n                    strokeLinejoin=\"round\"\n                    strokeWidth={2}\n                    d=\"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\"\n                  />\n                </svg>\n                <p className=\"text-red-100 text-sm\">{error}</p>\n              </div>\n            </div>\n          )}\n\n          {/* JS9 not loaded warning */}\n          {!isJS9Ready && !isLoading && !error && (\n            <div className=\"absolute inset-0 bg-gray-800 flex items-center justify-center p-4\">\n              <div className=\"text-center\">\n                <p className=\"text-gray-300 text-sm\">\n                  JS9 library not loaded. Add the following to your index.html:\n                </p>\n                <code className=\"text-xs text-gray-400 mt-2 block\">\n                  {'<script src=\"https://js9.si.edu/js9/js9.min.js\"></script>'}\n                </code>\n              </div>\n            </div>\n          )}\n        </div>\n\n        {/* Coordinate display bar */}\n        <div className=\"mt-2 flex justify-between items-center text-xs text-gray-500 bg-gray-100 rounded px-2 py-1\">\n          <span className=\"font-mono\">\n            {cursorWCS ? (\n              <>\n                <span className=\"text-gray-700\">RA:</span> {cursorWCS.ra}{\" \"}\n                <span className=\"text-gray-700 ml-2\">Dec:</span> {cursorWCS.dec}\n              </>\n            ) : (\n              <span className=\"text-gray-400\">Move cursor over image for coordinates</span>\n            )}\n          </span>\n          <span className=\"text-gray-400 truncate max-w-[150px]\" title={fitsUrl}>\n            {fitsUrl.split(\"/\").pop()?.substring(0, 25) || \"No file\"}\n          </span>\n        </div>\n      </div>\n\n      {/* Controls panel */}\n      {showControls && (\n        <div className=\"w-48 flex-shrink-0\">\n          <FitsViewerControls\n            {...controls}\n            onChange={handleControlChange}\n            onZoomIn={handleZoomIn}\n            onZoomOut={handleZoomOut}\n            onZoomFit={handleZoomFit}\n            onExport={handleExport}\n          />\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default FitsViewer;\n","import React, { useState, useCallback } from \"react\";\n\nexport type ConfidenceLevel = \"true\" | \"false\" | \"unsure\";\n\nexport interface RatingTag {\n  id: string;\n  name: string;\n  color?: string;\n  description?: string;\n}\n\nexport interface PreviousRating {\n  id: string;\n  confidence: ConfidenceLevel;\n  tag: RatingTag;\n  notes?: string;\n  user: string;\n  date: string;\n}\n\nexport interface RatingCardProps {\n  /** ID of the item being rated */\n  itemId: string;\n  /** Display name for the item */\n  itemName: string;\n  /** Available classification tags */\n  tags: RatingTag[];\n  /** Previous rating if exists */\n  previousRating?: PreviousRating;\n  /** Callback when rating is submitted */\n  onSubmit: (rating: {\n    itemId: string;\n    confidence: ConfidenceLevel;\n    tagId: string;\n    notes: string;\n  }) => Promise<void>;\n  /** Callback to navigate to next unrated item */\n  onNextUnrated?: () => void;\n  /** Callback to create a new tag */\n  onCreateTag?: (name: string, description: string) => Promise<RatingTag>;\n  /** Loading state */\n  isLoading?: boolean;\n  /** Custom class name */\n  className?: string;\n}\n\nconst CONFIDENCE_OPTIONS: { value: ConfidenceLevel; label: string; color: string }[] = [\n  { value: \"true\", label: \"True\", color: \"bg-green-500\" },\n  { value: \"false\", label: \"False\", color: \"bg-red-500\" },\n  { value: \"unsure\", label: \"Unsure\", color: \"bg-yellow-500\" },\n];\n\n/**\n * Rating card component for classifying candidates.\n * Displays previous rating if exists and allows updating.\n */\nconst RatingCard: React.FC<RatingCardProps> = ({\n  itemId,\n  itemName,\n  tags,\n  previousRating,\n  onSubmit,\n  onNextUnrated,\n  onCreateTag,\n  isLoading = false,\n  className = \"\",\n}) => {\n  const [confidence, setConfidence] = useState<ConfidenceLevel>(\n    previousRating?.confidence || \"false\"\n  );\n  const [selectedTagId, setSelectedTagId] = useState<string>(\n    previousRating?.tag.id || tags[0]?.id || \"\"\n  );\n  const [notes, setNotes] = useState<string>(previousRating?.notes || \"\");\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [showNewTagForm, setShowNewTagForm] = useState(false);\n  const [newTagName, setNewTagName] = useState(\"\");\n  const [newTagDescription, setNewTagDescription] = useState(\"\");\n\n  const handleSubmit = useCallback(\n    async (e: React.FormEvent) => {\n      e.preventDefault();\n      if (!selectedTagId) return;\n\n      setIsSubmitting(true);\n      try {\n        await onSubmit({\n          itemId,\n          confidence,\n          tagId: selectedTagId,\n          notes,\n        });\n      } finally {\n        setIsSubmitting(false);\n      }\n    },\n    [itemId, confidence, selectedTagId, notes, onSubmit]\n  );\n\n  const handleCreateTag = useCallback(async () => {\n    if (!newTagName.trim() || !onCreateTag) return;\n\n    try {\n      const newTag = await onCreateTag(newTagName.trim(), newTagDescription.trim());\n      setSelectedTagId(newTag.id);\n      setNewTagName(\"\");\n      setNewTagDescription(\"\");\n      setShowNewTagForm(false);\n    } catch (error) {\n      console.error(\"Failed to create tag:\", error);\n    }\n  }, [newTagName, newTagDescription, onCreateTag]);\n\n  const formatDate = (dateStr: string) => {\n    return new Date(dateStr).toLocaleString();\n  };\n\n  return (\n    <div className={`card ${className}`}>\n      <div className=\"card-header\">\n        <h4 className=\"text-lg font-semibold\">Rate: {itemName}</h4>\n      </div>\n\n      <div className=\"card-body space-y-4\">\n        {/* Previous Rating Display */}\n        {previousRating && (\n          <div className=\"bg-gray-50 rounded-lg p-3 border border-gray-200\">\n            <p className=\"text-sm text-gray-600 mb-2\">Your previous rating:</p>\n            <div className=\"space-y-1 text-sm\">\n              <div className=\"flex gap-2\">\n                <span className=\"font-medium\">Real variable?</span>\n                <span\n                  className={`badge ${\n                    previousRating.confidence === \"true\"\n                      ? \"badge-success\"\n                      : previousRating.confidence === \"false\"\n                      ? \"badge-error\"\n                      : \"badge-warning\"\n                  }`}\n                >\n                  {previousRating.confidence.charAt(0).toUpperCase() +\n                    previousRating.confidence.slice(1)}\n                </span>\n              </div>\n              <div className=\"flex gap-2\">\n                <span className=\"font-medium\">Tag:</span>\n                <span className=\"badge badge-info\">{previousRating.tag.name}</span>\n              </div>\n              <div className=\"flex gap-2\">\n                <span className=\"font-medium\">Date:</span>\n                <span>{formatDate(previousRating.date)}</span>\n              </div>\n              {previousRating.notes && (\n                <div>\n                  <span className=\"font-medium\">Notes:</span>\n                  <p className=\"mt-1 text-gray-600 bg-white p-2 rounded border max-h-24 overflow-y-auto\">\n                    {previousRating.notes}\n                  </p>\n                </div>\n              )}\n            </div>\n          </div>\n        )}\n\n        <hr className=\"border-gray-200\" />\n\n        {/* Rating Form */}\n        <form onSubmit={handleSubmit} className=\"space-y-4\">\n          {/* Confidence Selection */}\n          <div className=\"form-group\">\n            <label className=\"form-label\">Real variable?</label>\n            <div className=\"flex gap-2\">\n              {CONFIDENCE_OPTIONS.map((option) => (\n                <button\n                  key={option.value}\n                  type=\"button\"\n                  onClick={() => setConfidence(option.value)}\n                  className={`flex-1 py-2 px-3 rounded-md font-medium transition-all ${\n                    confidence === option.value\n                      ? `${option.color} text-white shadow-md`\n                      : \"bg-gray-100 text-gray-700 hover:bg-gray-200\"\n                  }`}\n                >\n                  {option.label}\n                </button>\n              ))}\n            </div>\n          </div>\n\n          {/* Tag Selection */}\n          <div className=\"form-group\">\n            <label className=\"form-label\">Classification Tag</label>\n            <div className=\"flex gap-2\">\n              <select\n                value={selectedTagId}\n                onChange={(e) => setSelectedTagId(e.target.value)}\n                className=\"form-select flex-1\"\n              >\n                <option value=\"\">Select a tag...</option>\n                {tags.map((tag) => (\n                  <option key={tag.id} value={tag.id}>\n                    {tag.name}\n                  </option>\n                ))}\n              </select>\n              {onCreateTag && (\n                <button\n                  type=\"button\"\n                  onClick={() => setShowNewTagForm(!showNewTagForm)}\n                  className=\"btn btn-success btn-sm\"\n                  title=\"Create new tag\"\n                >\n                  +\n                </button>\n              )}\n            </div>\n          </div>\n\n          {/* New Tag Form */}\n          {showNewTagForm && onCreateTag && (\n            <div className=\"bg-gray-50 rounded-lg p-3 border border-gray-200 space-y-2\">\n              <input\n                type=\"text\"\n                value={newTagName}\n                onChange={(e) => setNewTagName(e.target.value)}\n                placeholder=\"Tag name\"\n                className=\"form-control\"\n              />\n              <textarea\n                value={newTagDescription}\n                onChange={(e) => setNewTagDescription(e.target.value)}\n                placeholder=\"Description (optional)\"\n                rows={2}\n                className=\"form-control\"\n              />\n              <div className=\"flex justify-end gap-2\">\n                <button\n                  type=\"button\"\n                  onClick={() => setShowNewTagForm(false)}\n                  className=\"btn btn-secondary btn-sm\"\n                >\n                  Cancel\n                </button>\n                <button\n                  type=\"button\"\n                  onClick={handleCreateTag}\n                  disabled={!newTagName.trim()}\n                  className=\"btn btn-primary btn-sm\"\n                >\n                  Add Tag\n                </button>\n              </div>\n            </div>\n          )}\n\n          {/* Notes */}\n          <div className=\"form-group\">\n            <label className=\"form-label\">Notes</label>\n            <textarea\n              value={notes}\n              onChange={(e) => setNotes(e.target.value)}\n              placeholder=\"Add any observations or notes...\"\n              rows={4}\n              className=\"form-control\"\n            />\n          </div>\n\n          {/* Action Buttons */}\n          <div className=\"space-y-2\">\n            <button\n              type=\"submit\"\n              disabled={isSubmitting || isLoading || !selectedTagId}\n              className=\"btn btn-primary w-full\"\n            >\n              {isSubmitting ? (\n                <span className=\"flex items-center justify-center gap-2\">\n                  <span className=\"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin\" />\n                  Saving...\n                </span>\n              ) : previousRating ? (\n                \"Update Rating\"\n              ) : (\n                \"Submit Rating\"\n              )}\n            </button>\n\n            {onNextUnrated && (\n              <button type=\"button\" onClick={onNextUnrated} className=\"btn btn-success w-full\">\n                Next Unrated Candidate â†’\n              </button>\n            )}\n          </div>\n        </form>\n      </div>\n    </div>\n  );\n};\n\nexport default RatingCard;\n","import React, { useState } from \"react\";\nimport { useParams, Link } from \"react-router-dom\";\nimport ProvenanceStrip from \"../components/provenance/ProvenanceStrip\";\nimport ErrorDisplay from \"../components/errors/ErrorDisplay\";\nimport {\n  Card,\n  CoordinateDisplay,\n  ImageThumbnail,\n  LoadingSpinner,\n  QAMetrics,\n} from \"../components/common\";\nimport { AladinLiteViewer, GifPlayer } from \"../components/widgets\";\nimport { FitsViewer } from \"../components/fits\";\nimport { RatingCard, RatingTag } from \"../components/rating\";\nimport { mapProvenanceFromImageDetail, ImageDetailResponse } from \"../utils/provenanceMappers\";\nimport { relativeTime } from \"../utils/relativeTime\";\nimport type { ErrorResponse } from \"../types/errors\";\nimport { useImage } from \"../hooks/useQueries\";\nimport { usePreferencesStore } from \"../stores/appStore\";\n\n/**\n * Detail page for a single image.\n * Displays image metadata, provenance strip, and visualization options.\n */\nconst ImageDetailPage: React.FC = () => {\n  const { imageId } = useParams<{ imageId: string }>();\n  const { data: image, isLoading, error, refetch } = useImage(imageId);\n  const addRecentImage = usePreferencesStore((state) => state.addRecentImage);\n  const [showSkyViewer, setShowSkyViewer] = useState(true);\n  const [showFitsViewer, setShowFitsViewer] = useState(false);\n  const [showRatingCard, setShowRatingCard] = useState(false);\n\n  // Rating tags for QA assessment\n  const ratingTags: RatingTag[] = [\n    { id: \"artifact\", name: \"Artifact\", color: \"#EF4444\", description: \"Image contains artifacts\" },\n    { id: \"good\", name: \"Good Quality\", color: \"#22C55E\", description: \"Image passes QA\" },\n    { id: \"marginal\", name: \"Marginal\", color: \"#F59E0B\", description: \"Borderline quality\" },\n    { id: \"rfi\", name: \"RFI\", color: \"#8B5CF6\", description: \"Radio frequency interference\" },\n  ];\n\n  const handleRatingSubmit = async (rating: {\n    itemId: string;\n    confidence: \"true\" | \"false\" | \"unsure\";\n    tagId: string;\n    notes: string;\n  }) => {\n    const baseUrl = import.meta.env.VITE_API_URL || \"/api\";\n    await fetch(`${baseUrl}/images/${rating.itemId}/rating`, {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify(rating),\n    });\n    // Refresh image data\n    refetch();\n  };\n\n  // Track in recent items when image loads\n  React.useEffect(() => {\n    if (image && imageId) {\n      addRecentImage(imageId);\n    }\n  }, [image, imageId, addRecentImage]);\n\n  if (isLoading) {\n    return <LoadingSpinner label=\"Loading image details...\" />;\n  }\n\n  if (error) {\n    return (\n      <div className=\"max-w-4xl mx-auto p-6\">\n        <ErrorDisplay error={error as unknown as ErrorResponse} onRetry={() => refetch()} />\n      </div>\n    );\n  }\n\n  if (!image) {\n    return (\n      <div className=\"max-w-4xl mx-auto p-6\">\n        <Card>\n          <p className=\"text-gray-500 mb-4\">Image not found.</p>\n          <Link to=\"/images\" className=\"link\">\n            Back to Images\n          </Link>\n        </Card>\n      </div>\n    );\n  }\n\n  // Cast to expected response type for mapper\n  const imageData = image as ImageDetailResponse;\n  const provenance = mapProvenanceFromImageDetail(imageData);\n  const filename = image.path?.split(\"/\").pop() || image.id;\n\n  return (\n    <div className=\"max-w-6xl mx-auto p-6\">\n      {/* Header */}\n      <div className=\"mb-6\">\n        <Link to=\"/images\" className=\"text-sm text-gray-500 hover:text-gray-700 mb-2 inline-block\">\n          Back to Images\n        </Link>\n        <h1 className=\"text-2xl font-bold text-gray-900 mb-2\">{filename}</h1>\n        <ProvenanceStrip {...provenance} />\n      </div>\n\n      {/* Main content grid */}\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n        {/* Left column - Preview and actions (sticky on desktop) */}\n        <div className=\"lg:col-span-1 sticky-sidebar\">\n          {/* Image preview */}\n          <Card title=\"Preview\">\n            <div className=\"flex justify-center\">\n              <ImageThumbnail imageId={imageId || \"\"} size=\"lg\" alt={filename} />\n            </div>\n          </Card>\n\n          {/* Actions */}\n          <Card title=\"Actions\">\n            <div className=\"flex flex-col gap-2\">\n              <a\n                href={`${import.meta.env.VITE_API_URL || \"/api\"}/images/${imageId}/fits`}\n                target=\"_blank\"\n                rel=\"noreferrer\"\n                className=\"btn btn-primary text-center\"\n              >\n                Download FITS\n              </a>\n              <button\n                type=\"button\"\n                className={`btn ${showFitsViewer ? \"btn-primary\" : \"btn-secondary\"}`}\n                onClick={() => setShowFitsViewer(!showFitsViewer)}\n              >\n                {showFitsViewer ? \"Hide\" : \"Show\"} FITS Viewer\n              </button>\n              <button\n                type=\"button\"\n                className={`btn ${showRatingCard ? \"btn-primary\" : \"btn-secondary\"}`}\n                onClick={() => setShowRatingCard(!showRatingCard)}\n              >\n                {showRatingCard ? \"Hide\" : \"Show\"} Rating\n              </button>\n              {imageData.qa_grade && (\n                <Link to={`/qa/image/${imageId}`} className=\"btn btn-secondary text-center\">\n                  View QA Report\n                </Link>\n              )}\n            </div>\n          </Card>\n        </div>\n\n        {/* Right column - Details */}\n        <div className=\"lg:col-span-2 space-y-6\">\n          {/* Interactive FITS Viewer */}\n          {showFitsViewer && (\n            <Card title=\"FITS Viewer\">\n              <FitsViewer\n                fitsUrl={`${import.meta.env.VITE_API_URL || \"/api\"}/images/${imageId}/fits`}\n                displayId={`fits-${imageId}`}\n                width={600}\n                height={500}\n                showControls\n                initialCenter={\n                  imageData.pointing_ra_deg != null && imageData.pointing_dec_deg != null\n                    ? { ra: imageData.pointing_ra_deg, dec: imageData.pointing_dec_deg }\n                    : undefined\n                }\n              />\n            </Card>\n          )}\n\n          {/* Rating Card */}\n          {showRatingCard && (\n            <Card title=\"Image Rating\">\n              <RatingCard\n                itemId={imageId || \"\"}\n                itemName={filename}\n                tags={ratingTags}\n                previousRating={\n                  imageData.qa_grade\n                    ? {\n                        id: `rating-${imageId}`,\n                        confidence:\n                          imageData.qa_grade === \"good\"\n                            ? \"true\"\n                            : imageData.qa_grade === \"fail\"\n                            ? \"false\"\n                            : \"unsure\",\n                        tag:\n                          ratingTags.find(\n                            (t) =>\n                              t.id ===\n                              (imageData.qa_grade === \"good\"\n                                ? \"good\"\n                                : imageData.qa_grade === \"fail\"\n                                ? \"artifact\"\n                                : \"marginal\")\n                          ) || ratingTags[0],\n                        user: \"system\",\n                        date: imageData.created_at || new Date().toISOString(),\n                      }\n                    : undefined\n                }\n                onSubmit={handleRatingSubmit}\n              />\n            </Card>\n          )}\n\n          {/* QA Metrics */}\n          {(imageData.qa_grade || imageData.noise_jy || imageData.dynamic_range) && (\n            <Card title=\"Quality Assessment\">\n              <QAMetrics\n                grade={imageData.qa_grade as \"good\" | \"warn\" | \"fail\" | undefined}\n                summary={imageData.qa_summary}\n                noiseJy={imageData.noise_jy}\n                dynamicRange={imageData.dynamic_range}\n                beamMajorArcsec={imageData.beam_major_arcsec}\n                beamMinorArcsec={imageData.beam_minor_arcsec}\n                beamPaDeg={imageData.beam_pa_deg}\n              />\n            </Card>\n          )}\n\n          {/* Coordinates */}\n          {imageData.pointing_ra_deg != null && imageData.pointing_dec_deg != null && (\n            <Card\n              title=\"Pointing\"\n              subtitle={\n                <button\n                  type=\"button\"\n                  onClick={() => setShowSkyViewer(!showSkyViewer)}\n                  className=\"text-xs text-blue-600 hover:text-blue-800\"\n                >\n                  {showSkyViewer ? \"Hide Sky View\" : \"Show Sky View\"}\n                </button>\n              }\n            >\n              <CoordinateDisplay\n                raDeg={imageData.pointing_ra_deg}\n                decDeg={imageData.pointing_dec_deg}\n                showDecimal\n                allowFormatToggle\n              />\n              {showSkyViewer && (\n                <div className=\"mt-4\">\n                  <AladinLiteViewer\n                    raDeg={imageData.pointing_ra_deg}\n                    decDeg={imageData.pointing_dec_deg}\n                    fov={0.5}\n                    height={250}\n                    className=\"rounded-lg overflow-hidden\"\n                  />\n                </div>\n              )}\n            </Card>\n          )}\n\n          {/* Metadata */}\n          <Card title=\"Metadata\">\n            <dl className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\n              <div>\n                <dt className=\"text-xs text-gray-500 uppercase tracking-wide\">Image ID</dt>\n                <dd className=\"font-mono text-sm text-gray-900 break-all\">{image.id}</dd>\n              </div>\n              <div>\n                <dt className=\"text-xs text-gray-500 uppercase tracking-wide\">Created</dt>\n                <dd className=\"text-sm text-gray-900\">\n                  {image.created_at ? (\n                    <>\n                      {new Date(image.created_at).toLocaleString()}\n                      <span className=\"text-gray-500 ml-1\">({relativeTime(image.created_at)})</span>\n                    </>\n                  ) : (\n                    <span className=\"text-gray-400\">Unknown</span>\n                  )}\n                </dd>\n              </div>\n              <div className=\"sm:col-span-2\">\n                <dt className=\"text-xs text-gray-500 uppercase tracking-wide\">Path</dt>\n                <dd className=\"font-mono text-sm text-gray-900 break-all\">{image.path}</dd>\n              </div>\n              {image.ms_path && (\n                <div className=\"sm:col-span-2\">\n                  <dt className=\"text-xs text-gray-500 uppercase tracking-wide\">\n                    Source Measurement Set\n                  </dt>\n                  <dd className=\"font-mono text-sm break-all\">\n                    <Link\n                      to={`/ms/${encodeURIComponent(image.ms_path)}`}\n                      className=\"text-blue-600 hover:text-blue-800 hover:underline\"\n                    >\n                      {image.ms_path}\n                    </Link>\n                  </dd>\n                </div>\n              )}\n              {image.cal_table && (\n                <div className=\"sm:col-span-2\">\n                  <dt className=\"text-xs text-gray-500 uppercase tracking-wide\">\n                    Calibration Table\n                  </dt>\n                  <dd className=\"font-mono text-sm text-gray-900 break-all\">{image.cal_table}</dd>\n                </div>\n              )}\n              {image.run_id && (\n                <div>\n                  <dt className=\"text-xs text-gray-500 uppercase tracking-wide\">Pipeline Run</dt>\n                  <dd className=\"text-sm\">\n                    <Link\n                      to={`/jobs/${image.run_id}`}\n                      className=\"text-blue-600 hover:text-blue-800 hover:underline\"\n                    >\n                      {image.run_id}\n                    </Link>\n                  </dd>\n                </div>\n              )}\n            </dl>\n          </Card>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default ImageDetailPage;\n"],"names":["sizeClasses","ImageThumbnail","imageId","alt","size","onClick","expandable","apiUrl","loading","setLoading","useState","error","setError","expanded","setExpanded","thumbnailUrl","handleLoad","handleError","handleClick","jsxs","Fragment","e","jsx","COLOR_MAPS","SCALES","FitsViewerControls","colorMap","scale","contrast","bias","showRegions","showCrosshair","onChange","onZoomIn","onZoomOut","onZoomFit","onExport","isExpanded","setIsExpanded","cm","s","FitsViewer","fitsUrl","displayId","width","height","showControls","initialCenter","initialFov","onCoordinateClick","onLoad","onError","className","containerRef","useRef","isLoading","setIsLoading","isJS9Ready","setIsJS9Ready","cursorWCS","setCursorWCS","initialControlsRef","controls","setControls","useEffect","checkJS9","interval","timeout","im","initControls","msg","xreg","evt","wcs","raH","raHours","raMin","raSec","raStr","decSign","decAbs","decDeg","decMin","decSec","decStr","err","_a","regions","region","regionErr","handleZoomIn","useCallback","handleZoomOut","handleZoomFit","handleExport","format","handleControlChange","values","prev","CONFIDENCE_OPTIONS","RatingCard","itemId","itemName","tags","previousRating","onSubmit","onNextUnrated","onCreateTag","confidence","setConfidence","selectedTagId","setSelectedTagId","notes","setNotes","isSubmitting","setIsSubmitting","showNewTagForm","setShowNewTagForm","newTagName","setNewTagName","newTagDescription","setNewTagDescription","handleSubmit","handleCreateTag","newTag","formatDate","dateStr","option","tag","ImageDetailPage","useParams","image","refetch","useImage","addRecentImage","usePreferencesStore","state","showSkyViewer","setShowSkyViewer","showFitsViewer","setShowFitsViewer","showRatingCard","setShowRatingCard","ratingTags","handleRatingSubmit","rating","React","LoadingSpinner","ErrorDisplay","Card","Link","imageData","provenance","mapProvenanceFromImageDetail","filename","ProvenanceStrip","t","QAMetrics","CoordinateDisplay","AladinLiteViewer","relativeTime"],"mappings":"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"}