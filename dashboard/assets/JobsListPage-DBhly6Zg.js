import{r as i,j as e,L as p}from"./index-BMUX2-2Z.js";import{b as j}from"./useQueries-gIUS99rZ.js";import{r as y}from"./relativeTime-Dp84ug83.js";import{a,L as f}from"./appStore-2-QcJAZJ.js";import{S as d}from"./SortableTableHeader-x9p_prdP.js";const J=()=>{const{data:o,isLoading:h,error:c}=j(),n=a(t=>t.selectedJobs),u=a(t=>t.toggleJobSelection),m=a(t=>t.selectAllJobs),g=a(t=>t.clearJobSelection),s=i.useMemo(()=>Array.from(n),[n]),l=i.useCallback(async t=>{if(s.length===0)return;const x="https://ronnie-unsectarian-antone.ngrok-free.dev/api";t==="export"?window.open(`${x}/jobs/export?ids=${s.join(",")}`,"_blank"):await fetch(`${x}/jobs/bulk-${t}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({runIds:s})})},[s]),r=i.useMemo(()=>o?sortItems(o,sortKey,sortDirection):[],[o,sortKey,sortDirection,sortItems]);if(h)return e.jsx(f,{label:"Loading jobs..."});if(c)return e.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:["Failed to load jobs: ",c.message]});const b=t=>{switch(t){case"completed":return"badge-success";case"running":return"badge-info";case"failed":return"badge-error";case"pending":return"badge-warning";default:return"bg-gray-100 text-gray-800"}};return e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Pipeline Jobs"}),s.length>0&&e.jsxs("span",{className:"text-sm text-gray-500",children:[s.length," selected"]})]}),s.length>0&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>l("rerun"),className:"px-3 py-1.5 rounded text-sm font-medium bg-blue-600 text-white hover:bg-blue-700",children:"Rerun Selected"}),e.jsx("button",{onClick:()=>l("cancel"),className:"px-3 py-1.5 rounded text-sm font-medium bg-orange-600 text-white hover:bg-orange-700",children:"Cancel Selected"}),e.jsx("button",{onClick:()=>l("export"),className:"px-3 py-1.5 rounded text-sm font-medium bg-green-600 text-white hover:bg-green-700",children:"Export Logs"})]})]}),r&&r.length>0?e.jsx("div",{className:"card overflow-hidden",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"w-10 px-3 py-3",children:e.jsx("input",{type:"checkbox",checked:s.length===r.length&&r.length>0,ref:t=>{t&&(t.indeterminate=s.length>0&&s.length<r.length)},onChange:()=>{s.length===r.length?g():m(r.map(t=>t.run_id))},className:"h-4 w-4 text-blue-600 rounded"})}),e.jsx(d,{label:"Run ID",sortKey:"run_id",currentSortKey:sortKey,direction:sortDirection,onSort:handleSort}),e.jsx(d,{label:"Status",sortKey:"status",currentSortKey:sortKey,direction:sortDirection,onSort:handleSort,className:"text-center"}),e.jsx(d,{label:"Started",sortKey:"started_at",currentSortKey:sortKey,direction:sortDirection,onSort:handleSort,className:"text-right"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:r.map(t=>e.jsxs("tr",{className:n.has(t.run_id)?"bg-blue-50":"",children:[e.jsx("td",{className:"px-3",children:e.jsx("input",{type:"checkbox",checked:n.has(t.run_id),onChange:()=>u(t.run_id),className:"h-4 w-4 text-blue-600 rounded"})}),e.jsx("td",{children:e.jsx(p,{to:`/jobs/${t.run_id}`,className:"text-blue-600 hover:text-blue-800 font-medium",children:t.run_id})}),e.jsx("td",{className:"text-center",children:e.jsx("span",{className:`badge ${b(t.status)}`,children:t.status})}),e.jsx("td",{className:"text-right text-gray-500",children:t.started_at?y(t.started_at):"â€”"})]},t.run_id))})]})}):e.jsx("p",{className:"text-gray-500",children:"No jobs found."})]})};export{J as default};
//# sourceMappingURL=JobsListPage-DBhly6Zg.js.map
