{"version":3,"file":"FitsViewer-3zCpbA8h.js","sources":["../../src/components/fits/FitsViewerControls.tsx","../../src/components/fits/FitsViewer.tsx"],"sourcesContent":["import React, { useState } from \"react\";\n\nexport interface FitsViewerControlsProps {\n  /** Current color map */\n  colorMap: string;\n  /** Current scale type */\n  scale: string;\n  /** Current contrast level (0-1) */\n  contrast: number;\n  /** Current bias level (0-1) */\n  bias: number;\n  /** Whether regions are visible */\n  showRegions: boolean;\n  /** Whether crosshair is visible */\n  showCrosshair: boolean;\n  /** Change handler */\n  onChange: (values: Partial<FitsViewerControlsValues>) => void;\n  /** Zoom in handler */\n  onZoomIn?: () => void;\n  /** Zoom out handler */\n  onZoomOut?: () => void;\n  /** Zoom to fit handler */\n  onZoomFit?: () => void;\n  /** Export handler */\n  onExport?: (format: \"png\" | \"fits\") => void;\n}\n\nexport interface FitsViewerControlsValues {\n  colorMap: string;\n  scale: string;\n  contrast: number;\n  bias: number;\n  showRegions: boolean;\n  showCrosshair: boolean;\n}\n\nconst COLOR_MAPS = [\n  \"grey\",\n  \"heat\",\n  \"cool\",\n  \"rainbow\",\n  \"viridis\",\n  \"plasma\",\n  \"magma\",\n  \"inferno\",\n  \"cubehelix\",\n  \"red\",\n  \"green\",\n  \"blue\",\n];\n\nconst SCALES = [\"linear\", \"log\", \"sqrt\", \"squared\", \"asinh\", \"sinh\", \"histeq\", \"power\"];\n\n/**\n * Control panel for FITS viewer settings.\n */\nconst FitsViewerControls: React.FC<FitsViewerControlsProps> = ({\n  colorMap,\n  scale,\n  contrast,\n  bias,\n  showRegions,\n  showCrosshair,\n  onChange,\n  onZoomIn,\n  onZoomOut,\n  onZoomFit,\n  onExport,\n}) => {\n  const [isExpanded, setIsExpanded] = useState(true);\n\n  return (\n    <div className=\"bg-white border border-gray-200 rounded-lg overflow-hidden\">\n      {/* Header */}\n      <button\n        onClick={() => setIsExpanded(!isExpanded)}\n        className=\"w-full flex items-center justify-between px-3 py-2 bg-gray-50 hover:bg-gray-100 transition-colors\"\n      >\n        <span className=\"font-semibold text-sm text-gray-700\">Display Settings</span>\n        <svg\n          className={`w-4 h-4 text-gray-500 transition-transform ${isExpanded ? \"rotate-180\" : \"\"}`}\n          fill=\"none\"\n          stroke=\"currentColor\"\n          viewBox=\"0 0 24 24\"\n        >\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 9l-7 7-7-7\" />\n        </svg>\n      </button>\n\n      {isExpanded && (\n        <div className=\"p-3 space-y-4\">\n          {/* Zoom buttons */}\n          <div className=\"flex gap-2\">\n            <button\n              onClick={onZoomIn}\n              className=\"flex-1 px-2 py-1.5 text-sm bg-gray-100 hover:bg-gray-200 rounded transition-colors\"\n              title=\"Zoom in\"\n            >\n              <svg\n                className=\"w-4 h-4 mx-auto\"\n                fill=\"none\"\n                stroke=\"currentColor\"\n                viewBox=\"0 0 24 24\"\n              >\n                <path\n                  strokeLinecap=\"round\"\n                  strokeLinejoin=\"round\"\n                  strokeWidth={2}\n                  d=\"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM10 7v6m3-3H7\"\n                />\n              </svg>\n            </button>\n            <button\n              onClick={onZoomOut}\n              className=\"flex-1 px-2 py-1.5 text-sm bg-gray-100 hover:bg-gray-200 rounded transition-colors\"\n              title=\"Zoom out\"\n            >\n              <svg\n                className=\"w-4 h-4 mx-auto\"\n                fill=\"none\"\n                stroke=\"currentColor\"\n                viewBox=\"0 0 24 24\"\n              >\n                <path\n                  strokeLinecap=\"round\"\n                  strokeLinejoin=\"round\"\n                  strokeWidth={2}\n                  d=\"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM7 10h6\"\n                />\n              </svg>\n            </button>\n            <button\n              onClick={onZoomFit}\n              className=\"flex-1 px-2 py-1.5 text-sm bg-gray-100 hover:bg-gray-200 rounded transition-colors\"\n              title=\"Fit to window\"\n            >\n              <svg\n                className=\"w-4 h-4 mx-auto\"\n                fill=\"none\"\n                stroke=\"currentColor\"\n                viewBox=\"0 0 24 24\"\n              >\n                <path\n                  strokeLinecap=\"round\"\n                  strokeLinejoin=\"round\"\n                  strokeWidth={2}\n                  d=\"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4\"\n                />\n              </svg>\n            </button>\n          </div>\n\n          {/* Color map */}\n          <div>\n            <label className=\"block text-sm text-gray-600 mb-1\">Color Map</label>\n            <select\n              value={colorMap}\n              onChange={(e) => onChange({ colorMap: e.target.value })}\n              className=\"w-full px-2 py-1.5 border border-gray-300 rounded text-sm\"\n            >\n              {COLOR_MAPS.map((cm) => (\n                <option key={cm} value={cm}>\n                  {cm.charAt(0).toUpperCase() + cm.slice(1)}\n                </option>\n              ))}\n            </select>\n          </div>\n\n          {/* Scale */}\n          <div>\n            <label className=\"block text-sm text-gray-600 mb-1\">Scale</label>\n            <select\n              value={scale}\n              onChange={(e) => onChange({ scale: e.target.value })}\n              className=\"w-full px-2 py-1.5 border border-gray-300 rounded text-sm\"\n            >\n              {SCALES.map((s) => (\n                <option key={s} value={s}>\n                  {s.charAt(0).toUpperCase() + s.slice(1)}\n                </option>\n              ))}\n            </select>\n          </div>\n\n          {/* Contrast slider */}\n          <div>\n            <label className=\"flex items-center justify-between text-sm text-gray-600 mb-1\">\n              <span>Contrast</span>\n              <span className=\"text-gray-400\">{(contrast * 100).toFixed(0)}%</span>\n            </label>\n            <input\n              type=\"range\"\n              min={0}\n              max={1}\n              step={0.01}\n              value={contrast}\n              onChange={(e) => onChange({ contrast: parseFloat(e.target.value) })}\n              className=\"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-primary\"\n            />\n          </div>\n\n          {/* Bias slider */}\n          <div>\n            <label className=\"flex items-center justify-between text-sm text-gray-600 mb-1\">\n              <span>Bias</span>\n              <span className=\"text-gray-400\">{(bias * 100).toFixed(0)}%</span>\n            </label>\n            <input\n              type=\"range\"\n              min={0}\n              max={1}\n              step={0.01}\n              value={bias}\n              onChange={(e) => onChange({ bias: parseFloat(e.target.value) })}\n              className=\"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-primary\"\n            />\n          </div>\n\n          {/* Toggle options */}\n          <div className=\"space-y-2 pt-2 border-t border-gray-100\">\n            <label className=\"flex items-center gap-2 cursor-pointer\">\n              <input\n                type=\"checkbox\"\n                checked={showRegions}\n                onChange={(e) => onChange({ showRegions: e.target.checked })}\n                className=\"w-4 h-4 rounded\"\n              />\n              <span className=\"text-sm\">Show regions</span>\n            </label>\n            <label className=\"flex items-center gap-2 cursor-pointer\">\n              <input\n                type=\"checkbox\"\n                checked={showCrosshair}\n                onChange={(e) => onChange({ showCrosshair: e.target.checked })}\n                className=\"w-4 h-4 rounded\"\n              />\n              <span className=\"text-sm\">Show crosshair</span>\n            </label>\n          </div>\n\n          {/* Export buttons */}\n          {onExport && (\n            <div className=\"flex gap-2 pt-2 border-t border-gray-100\">\n              <button\n                onClick={() => onExport(\"png\")}\n                className=\"flex-1 px-2 py-1.5 text-sm bg-primary text-white rounded hover:bg-primary-dark transition-colors\"\n              >\n                Export PNG\n              </button>\n              <button\n                onClick={() => onExport(\"fits\")}\n                className=\"flex-1 px-2 py-1.5 text-sm border border-primary text-primary rounded hover:bg-primary/10 transition-colors\"\n              >\n                Export FITS\n              </button>\n            </div>\n          )}\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default FitsViewerControls;\n","import React, { useEffect, useRef, useCallback, useState } from \"react\";\nimport FitsViewerControls, { FitsViewerControlsValues } from \"./FitsViewerControls\";\n\n// Declare JS9 global from CDN\ndeclare global {\n  interface Window {\n    JS9: any;\n  }\n}\n\nexport interface FitsViewerProps {\n  /** URL to FITS file */\n  fitsUrl: string;\n  /** Optional display ID for multiple viewers */\n  displayId?: string;\n  /** Width of the viewer */\n  width?: number;\n  /** Height of the viewer */\n  height?: number;\n  /** Whether to show controls panel */\n  showControls?: boolean;\n  /** Initial center coordinates (RA, Dec in degrees) */\n  initialCenter?: { ra: number; dec: number };\n  /** Initial field of view in arcminutes */\n  initialFov?: number;\n  /** Callback on coordinate click */\n  onCoordinateClick?: (ra: number, dec: number) => void;\n  /** Callback when image loads */\n  onLoad?: () => void;\n  /** Callback on error */\n  onError?: (error: string) => void;\n  /** Custom class name */\n  className?: string;\n}\n\n/**\n * FITS image viewer using JS9 library.\n * Provides pan, zoom, color map, and scale controls.\n */\nconst FitsViewer: React.FC<FitsViewerProps> = ({\n  fitsUrl,\n  displayId = \"JS9\",\n  width = 512,\n  height = 512,\n  showControls = true,\n  initialCenter,\n  initialFov,\n  onCoordinateClick,\n  onLoad,\n  onError,\n  className = \"\",\n}) => {\n  const containerRef = useRef<HTMLDivElement>(null);\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [isJS9Ready, setIsJS9Ready] = useState(false);\n  const [cursorWCS, setCursorWCS] = useState<{ ra: string; dec: string } | null>(null);\n  const initialControlsRef = useRef<FitsViewerControlsValues | null>(null);\n\n  // Control state\n  const [controls, setControls] = useState<FitsViewerControlsValues>({\n    colorMap: \"grey\",\n    scale: \"log\",\n    contrast: 0.5,\n    bias: 0.5,\n    showRegions: true,\n    showCrosshair: false,\n  });\n\n  // Store initial controls to detect changes\n  if (initialControlsRef.current === null) {\n    initialControlsRef.current = { ...controls };\n  }\n\n  // Check if JS9 is loaded\n  useEffect(() => {\n    const checkJS9 = () => {\n      if (window.JS9 && window.JS9.Load) {\n        setIsJS9Ready(true);\n        return true;\n      }\n      return false;\n    };\n\n    if (checkJS9()) return;\n\n    // Poll for JS9 to load\n    const interval = setInterval(() => {\n      if (checkJS9()) {\n        clearInterval(interval);\n      }\n    }, 100);\n\n    // Timeout after 10 seconds\n    const timeout = setTimeout(() => {\n      clearInterval(interval);\n      if (!isJS9Ready) {\n        setError(\"JS9 library failed to load. Make sure JS9 CDN is included.\");\n        setIsLoading(false);\n      }\n    }, 10000);\n\n    return () => {\n      clearInterval(interval);\n      clearTimeout(timeout);\n    };\n  }, [isJS9Ready]);\n\n  // Load FITS image\n  useEffect(() => {\n    if (!isJS9Ready || !fitsUrl) return;\n\n    setIsLoading(true);\n    setError(null);\n\n    try {\n      window.JS9.Load(fitsUrl, {\n        display: displayId,\n        onload: (im: any) => {\n          setIsLoading(false);\n\n          // Apply initial settings\n          if (initialCenter) {\n            window.JS9.SetPan(initialCenter.ra, initialCenter.dec, {\n              display: displayId,\n            });\n          }\n          if (initialFov) {\n            window.JS9.SetZoom(\"tofit\", { display: displayId });\n          }\n\n          // Apply initial controls (from ref, not state to avoid dependency)\n          const initControls = initialControlsRef.current;\n          if (initControls) {\n            window.JS9.SetColormap(initControls.colorMap, { display: displayId });\n            window.JS9.SetScale(initControls.scale, { display: displayId });\n          }\n\n          onLoad?.();\n        },\n        onerror: (msg: string) => {\n          setError(msg || \"Failed to load FITS file\");\n          setIsLoading(false);\n          onError?.(msg);\n        },\n      });\n\n      // Set up click handler\n      if (onCoordinateClick) {\n        window.JS9.SetCallback(\n          \"onclick\",\n          (im: any, xreg: any, evt: any) => {\n            const wcs = window.JS9.PixToWCS(evt.x, evt.y, { display: displayId });\n            if (wcs) {\n              onCoordinateClick(wcs.ra, wcs.dec);\n            }\n          },\n          { display: displayId }\n        );\n      }\n\n      // Set up mouse move handler for live WCS display\n      window.JS9.SetCallback(\n        \"onmousemove\",\n        (im: any, xreg: any, evt: any) => {\n          try {\n            const wcs = window.JS9.PixToWCS(evt.x, evt.y, { display: displayId });\n            if (wcs && wcs.ra !== undefined && wcs.dec !== undefined) {\n              // Format as sexagesimal\n              const raH = wcs.ra / 15;\n              const raHours = Math.floor(raH);\n              const raMin = Math.floor((raH - raHours) * 60);\n              const raSec = ((raH - raHours) * 60 - raMin) * 60;\n              const raStr = `${raHours.toString().padStart(2, \"0\")}:${raMin\n                .toString()\n                .padStart(2, \"0\")}:${raSec.toFixed(2).padStart(5, \"0\")}`;\n\n              const decSign = wcs.dec >= 0 ? \"+\" : \"-\";\n              const decAbs = Math.abs(wcs.dec);\n              const decDeg = Math.floor(decAbs);\n              const decMin = Math.floor((decAbs - decDeg) * 60);\n              const decSec = ((decAbs - decDeg) * 60 - decMin) * 60;\n              const decStr = `${decSign}${decDeg.toString().padStart(2, \"0\")}:${decMin\n                .toString()\n                .padStart(2, \"0\")}:${decSec.toFixed(1).padStart(4, \"0\")}`;\n\n              setCursorWCS({ ra: raStr, dec: decStr });\n            }\n          } catch (e) {\n            // WCS may not be available\n          }\n        },\n        { display: displayId }\n      );\n    } catch (err) {\n      setError(String(err));\n      setIsLoading(false);\n      onError?.(String(err));\n    }\n\n    return () => {\n      if (window.JS9?.CloseImage) {\n        window.JS9.CloseImage({ display: displayId });\n      }\n    };\n  }, [\n    isJS9Ready,\n    fitsUrl,\n    displayId,\n    initialCenter,\n    initialFov,\n    onLoad,\n    onError,\n    onCoordinateClick,\n  ]);\n\n  // Apply control changes\n  useEffect(() => {\n    if (!isJS9Ready || isLoading) return;\n\n    try {\n      window.JS9.SetColormap(controls.colorMap, { display: displayId });\n      window.JS9.SetScale(controls.scale, { display: displayId });\n      window.JS9.SetParam(\"contrast\", controls.contrast, { display: displayId });\n      window.JS9.SetParam(\"bias\", controls.bias, { display: displayId });\n\n      // Toggle regions visibility (hide/show, don't delete)\n      // Use ChangeRegions to set visibility property\n      try {\n        const regions = window.JS9.GetRegions(\"all\", { display: displayId });\n        if (regions && regions.length > 0) {\n          regions.forEach((region: any) => {\n            window.JS9.ChangeRegions(\n              region.id,\n              {\n                visibility: controls.showRegions,\n              },\n              { display: displayId }\n            );\n          });\n        }\n      } catch (regionErr) {\n        // Regions may not exist yet or API differs\n        console.debug(\"Region visibility toggle:\", regionErr);\n      }\n\n      // Toggle crosshair\n      window.JS9.SetParam(\"crosshair\", controls.showCrosshair, { display: displayId });\n    } catch (err) {\n      console.warn(\"Failed to apply JS9 settings:\", err);\n    }\n  }, [controls, isJS9Ready, isLoading, displayId]);\n\n  const handleZoomIn = useCallback(() => {\n    if (window.JS9) {\n      window.JS9.SetZoom(\"in\", { display: displayId });\n    }\n  }, [displayId]);\n\n  const handleZoomOut = useCallback(() => {\n    if (window.JS9) {\n      window.JS9.SetZoom(\"out\", { display: displayId });\n    }\n  }, [displayId]);\n\n  const handleZoomFit = useCallback(() => {\n    if (window.JS9) {\n      window.JS9.SetZoom(\"tofit\", { display: displayId });\n    }\n  }, [displayId]);\n\n  const handleExport = useCallback(\n    (format: \"png\" | \"fits\") => {\n      if (!window.JS9) return;\n\n      if (format === \"png\") {\n        window.JS9.SavePNG({ display: displayId });\n      } else {\n        window.JS9.SaveFITS({ display: displayId });\n      }\n    },\n    [displayId]\n  );\n\n  const handleControlChange = (values: Partial<FitsViewerControlsValues>) => {\n    setControls((prev) => ({ ...prev, ...values }));\n  };\n\n  return (\n    <div className={`flex gap-4 ${className}`}>\n      {/* Viewer area */}\n      <div className=\"flex-1\">\n        <div\n          ref={containerRef}\n          className=\"relative bg-black rounded-lg overflow-hidden\"\n          style={{ width, height }}\n        >\n          {/* JS9 display div */}\n          <div className=\"JS9\" id={displayId} style={{ width: \"100%\", height: \"100%\" }} />\n\n          {/* Loading overlay */}\n          {isLoading && (\n            <div className=\"absolute inset-0 bg-black/50 flex items-center justify-center\">\n              <div className=\"text-center\">\n                <div className=\"w-8 h-8 border-4 border-white border-t-transparent rounded-full animate-spin mx-auto mb-2\" />\n                <span className=\"text-white text-sm\">Loading FITS...</span>\n              </div>\n            </div>\n          )}\n\n          {/* Error overlay */}\n          {error && (\n            <div className=\"absolute inset-0 bg-red-900/80 flex items-center justify-center p-4\">\n              <div className=\"text-center\">\n                <svg\n                  className=\"w-8 h-8 text-red-300 mx-auto mb-2\"\n                  fill=\"none\"\n                  stroke=\"currentColor\"\n                  viewBox=\"0 0 24 24\"\n                >\n                  <path\n                    strokeLinecap=\"round\"\n                    strokeLinejoin=\"round\"\n                    strokeWidth={2}\n                    d=\"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\"\n                  />\n                </svg>\n                <p className=\"text-red-100 text-sm\">{error}</p>\n              </div>\n            </div>\n          )}\n\n          {/* JS9 not loaded warning */}\n          {!isJS9Ready && !isLoading && !error && (\n            <div className=\"absolute inset-0 bg-gray-800 flex items-center justify-center p-4\">\n              <div className=\"text-center\">\n                <p className=\"text-gray-300 text-sm\">\n                  JS9 library not loaded. Add the following to your index.html:\n                </p>\n                <code className=\"text-xs text-gray-400 mt-2 block\">\n                  {'<script src=\"https://js9.si.edu/js9/js9.min.js\"></script>'}\n                </code>\n              </div>\n            </div>\n          )}\n        </div>\n\n        {/* Coordinate display bar */}\n        <div className=\"mt-2 flex justify-between items-center text-xs text-gray-500 bg-gray-100 rounded px-2 py-1\">\n          <span className=\"font-mono\">\n            {cursorWCS ? (\n              <>\n                <span className=\"text-gray-700\">RA:</span> {cursorWCS.ra}{\" \"}\n                <span className=\"text-gray-700 ml-2\">Dec:</span> {cursorWCS.dec}\n              </>\n            ) : (\n              <span className=\"text-gray-400\">Move cursor over image for coordinates</span>\n            )}\n          </span>\n          <span className=\"text-gray-400 truncate max-w-[150px]\" title={fitsUrl}>\n            {fitsUrl.split(\"/\").pop()?.substring(0, 25) || \"No file\"}\n          </span>\n        </div>\n      </div>\n\n      {/* Controls panel */}\n      {showControls && (\n        <div className=\"w-48 flex-shrink-0\">\n          <FitsViewerControls\n            {...controls}\n            onChange={handleControlChange}\n            onZoomIn={handleZoomIn}\n            onZoomOut={handleZoomOut}\n            onZoomFit={handleZoomFit}\n            onExport={handleExport}\n          />\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default FitsViewer;\n"],"names":["COLOR_MAPS","SCALES","FitsViewerControls","colorMap","scale","contrast","bias","showRegions","showCrosshair","onChange","onZoomIn","onZoomOut","onZoomFit","onExport","isExpanded","setIsExpanded","useState","jsxs","jsx","e","cm","s","FitsViewer","fitsUrl","displayId","width","height","showControls","initialCenter","initialFov","onCoordinateClick","onLoad","onError","className","containerRef","useRef","isLoading","setIsLoading","error","setError","isJS9Ready","setIsJS9Ready","cursorWCS","setCursorWCS","initialControlsRef","controls","setControls","useEffect","checkJS9","interval","timeout","im","initControls","msg","xreg","evt","wcs","raH","raHours","raMin","raSec","raStr","decSign","decAbs","decDeg","decMin","decSec","decStr","err","regions","region","regionErr","handleZoomIn","useCallback","handleZoomOut","handleZoomFit","handleExport","format","handleControlChange","values","prev","Fragment"],"mappings":"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"}