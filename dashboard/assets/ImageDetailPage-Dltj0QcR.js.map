{"version":3,"file":"ImageDetailPage-Dltj0QcR.js","sources":["../../src/components/common/ImageThumbnail.tsx","../../src/components/rating/RatingCard.tsx","../../src/pages/ImageDetailPage.tsx"],"sourcesContent":["import React, { useState } from \"react\";\n\nexport interface ImageThumbnailProps {\n  /** Image ID for fetching thumbnail */\n  imageId: string;\n  /** Alt text for the image */\n  alt?: string;\n  /** Size variant */\n  size?: \"sm\" | \"md\" | \"lg\";\n  /** Click handler */\n  onClick?: () => void;\n  /** Show expand on hover */\n  expandable?: boolean;\n  /** API base URL */\n  apiUrl?: string;\n}\n\nconst sizeClasses = {\n  sm: \"w-24 h-24\",\n  md: \"w-48 h-48\",\n  lg: \"w-72 h-72\",\n};\n\n/**\n * Display an image thumbnail with loading state and error handling.\n * Falls back to a placeholder if the image can't be loaded.\n */\nconst ImageThumbnail: React.FC<ImageThumbnailProps> = ({\n  imageId,\n  alt = \"Image preview\",\n  size = \"md\",\n  onClick,\n  expandable = true,\n  apiUrl = import.meta.env.VITE_API_URL || \"http://127.0.0.1:8000/api\",\n}) => {\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(false);\n  const [expanded, setExpanded] = useState(false);\n\n  // Thumbnail URL - assumes backend provides /images/{id}/thumbnail endpoint\n  const thumbnailUrl = `${apiUrl}/images/${imageId}/thumbnail`;\n\n  const handleLoad = () => {\n    setLoading(false);\n    setError(false);\n  };\n\n  const handleError = () => {\n    setLoading(false);\n    setError(true);\n  };\n\n  const handleClick = () => {\n    if (onClick) {\n      onClick();\n    } else if (expandable) {\n      setExpanded(!expanded);\n    }\n  };\n\n  return (\n    <>\n      <div\n        className={`relative ${\n          sizeClasses[size]\n        } bg-gray-100 rounded-lg overflow-hidden border border-gray-200 ${\n          onClick || expandable ? \"cursor-pointer hover:border-blue-400 transition-colors\" : \"\"\n        }`}\n        onClick={handleClick}\n        role={onClick || expandable ? \"button\" : undefined}\n        tabIndex={onClick || expandable ? 0 : undefined}\n        onKeyDown={(e) => {\n          if ((e.key === \"Enter\" || e.key === \" \") && (onClick || expandable)) {\n            handleClick();\n          }\n        }}\n      >\n        {/* Loading state */}\n        {loading && !error && (\n          <div className=\"absolute inset-0 flex items-center justify-center\">\n            <div className=\"animate-pulse flex flex-col items-center\">\n              <svg\n                className=\"w-8 h-8 text-gray-300\"\n                fill=\"none\"\n                stroke=\"currentColor\"\n                viewBox=\"0 0 24 24\"\n              >\n                <path\n                  strokeLinecap=\"round\"\n                  strokeLinejoin=\"round\"\n                  strokeWidth={2}\n                  d=\"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z\"\n                />\n              </svg>\n              <span className=\"text-xs text-gray-400 mt-1\">Loading...</span>\n            </div>\n          </div>\n        )}\n\n        {/* Error/placeholder state */}\n        {error && (\n          <div className=\"absolute inset-0 flex items-center justify-center bg-gray-50\">\n            <div className=\"flex flex-col items-center text-gray-400\">\n              <svg className=\"w-8 h-8\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path\n                  strokeLinecap=\"round\"\n                  strokeLinejoin=\"round\"\n                  strokeWidth={2}\n                  d=\"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z\"\n                />\n              </svg>\n              <span className=\"text-xs mt-1\">No preview</span>\n            </div>\n          </div>\n        )}\n\n        {/* Actual image */}\n        <img\n          src={thumbnailUrl}\n          alt={alt}\n          className={`w-full h-full object-cover ${loading || error ? \"hidden\" : \"\"}`}\n          onLoad={handleLoad}\n          onError={handleError}\n        />\n\n        {/* Expand indicator */}\n        {expandable && !error && !loading && (\n          <div className=\"absolute bottom-1 right-1 bg-black/50 rounded p-1\">\n            <svg\n              className=\"w-4 h-4 text-white\"\n              fill=\"none\"\n              stroke=\"currentColor\"\n              viewBox=\"0 0 24 24\"\n            >\n              <path\n                strokeLinecap=\"round\"\n                strokeLinejoin=\"round\"\n                strokeWidth={2}\n                d=\"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4\"\n              />\n            </svg>\n          </div>\n        )}\n      </div>\n\n      {/* Expanded modal */}\n      {expanded && (\n        <div\n          className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/80\"\n          onClick={() => setExpanded(false)}\n          role=\"dialog\"\n          aria-modal=\"true\"\n        >\n          <div className=\"relative max-w-4xl max-h-[90vh] p-4\">\n            <img\n              src={thumbnailUrl}\n              alt={alt}\n              className=\"max-w-full max-h-[85vh] object-contain rounded-lg\"\n            />\n            <button\n              className=\"absolute top-2 right-2 bg-white/90 rounded-full p-2 hover:bg-white transition-colors\"\n              onClick={() => setExpanded(false)}\n              aria-label=\"Close\"\n            >\n              <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path\n                  strokeLinecap=\"round\"\n                  strokeLinejoin=\"round\"\n                  strokeWidth={2}\n                  d=\"M6 18L18 6M6 6l12 12\"\n                />\n              </svg>\n            </button>\n          </div>\n        </div>\n      )}\n    </>\n  );\n};\n\nexport default ImageThumbnail;\n","import React, { useState, useCallback } from \"react\";\n\nexport type ConfidenceLevel = \"true\" | \"false\" | \"unsure\";\n\nexport interface RatingTag {\n  id: string;\n  name: string;\n  color?: string;\n  description?: string;\n}\n\nexport interface PreviousRating {\n  id: string;\n  confidence: ConfidenceLevel;\n  tag: RatingTag;\n  notes?: string;\n  user: string;\n  date: string;\n}\n\nexport interface RatingCardProps {\n  /** ID of the item being rated */\n  itemId: string;\n  /** Display name for the item */\n  itemName: string;\n  /** Available classification tags */\n  tags: RatingTag[];\n  /** Previous rating if exists */\n  previousRating?: PreviousRating;\n  /** Callback when rating is submitted */\n  onSubmit: (rating: {\n    itemId: string;\n    confidence: ConfidenceLevel;\n    tagId: string;\n    notes: string;\n  }) => Promise<void>;\n  /** Callback to navigate to next unrated item */\n  onNextUnrated?: () => void;\n  /** Callback to create a new tag */\n  onCreateTag?: (name: string, description: string) => Promise<RatingTag>;\n  /** Loading state */\n  isLoading?: boolean;\n  /** Custom class name */\n  className?: string;\n}\n\nconst CONFIDENCE_OPTIONS: { value: ConfidenceLevel; label: string; color: string }[] = [\n  { value: \"true\", label: \"True\", color: \"bg-green-500\" },\n  { value: \"false\", label: \"False\", color: \"bg-red-500\" },\n  { value: \"unsure\", label: \"Unsure\", color: \"bg-yellow-500\" },\n];\n\n/**\n * Rating card component for classifying candidates.\n * Displays previous rating if exists and allows updating.\n */\nconst RatingCard: React.FC<RatingCardProps> = ({\n  itemId,\n  itemName,\n  tags,\n  previousRating,\n  onSubmit,\n  onNextUnrated,\n  onCreateTag,\n  isLoading = false,\n  className = \"\",\n}) => {\n  const [confidence, setConfidence] = useState<ConfidenceLevel>(\n    previousRating?.confidence || \"false\"\n  );\n  const [selectedTagId, setSelectedTagId] = useState<string>(\n    previousRating?.tag.id || tags[0]?.id || \"\"\n  );\n  const [notes, setNotes] = useState<string>(previousRating?.notes || \"\");\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [showNewTagForm, setShowNewTagForm] = useState(false);\n  const [newTagName, setNewTagName] = useState(\"\");\n  const [newTagDescription, setNewTagDescription] = useState(\"\");\n\n  const handleSubmit = useCallback(\n    async (e: React.FormEvent) => {\n      e.preventDefault();\n      if (!selectedTagId) return;\n\n      setIsSubmitting(true);\n      try {\n        await onSubmit({\n          itemId,\n          confidence,\n          tagId: selectedTagId,\n          notes,\n        });\n      } finally {\n        setIsSubmitting(false);\n      }\n    },\n    [itemId, confidence, selectedTagId, notes, onSubmit]\n  );\n\n  const handleCreateTag = useCallback(async () => {\n    if (!newTagName.trim() || !onCreateTag) return;\n\n    try {\n      const newTag = await onCreateTag(newTagName.trim(), newTagDescription.trim());\n      setSelectedTagId(newTag.id);\n      setNewTagName(\"\");\n      setNewTagDescription(\"\");\n      setShowNewTagForm(false);\n    } catch (error) {\n      console.error(\"Failed to create tag:\", error);\n    }\n  }, [newTagName, newTagDescription, onCreateTag]);\n\n  const formatDate = (dateStr: string) => {\n    return new Date(dateStr).toLocaleString();\n  };\n\n  return (\n    <div className={`card ${className}`}>\n      <div className=\"card-header\">\n        <h4 className=\"text-lg font-semibold\">Rate: {itemName}</h4>\n      </div>\n\n      <div className=\"card-body space-y-4\">\n        {/* Previous Rating Display */}\n        {previousRating && (\n          <div className=\"bg-gray-50 rounded-lg p-3 border border-gray-200\">\n            <p className=\"text-sm text-gray-600 mb-2\">Your previous rating:</p>\n            <div className=\"space-y-1 text-sm\">\n              <div className=\"flex gap-2\">\n                <span className=\"font-medium\">Real variable?</span>\n                <span\n                  className={`badge ${\n                    previousRating.confidence === \"true\"\n                      ? \"badge-success\"\n                      : previousRating.confidence === \"false\"\n                      ? \"badge-error\"\n                      : \"badge-warning\"\n                  }`}\n                >\n                  {previousRating.confidence.charAt(0).toUpperCase() +\n                    previousRating.confidence.slice(1)}\n                </span>\n              </div>\n              <div className=\"flex gap-2\">\n                <span className=\"font-medium\">Tag:</span>\n                <span className=\"badge badge-info\">{previousRating.tag.name}</span>\n              </div>\n              <div className=\"flex gap-2\">\n                <span className=\"font-medium\">Date:</span>\n                <span>{formatDate(previousRating.date)}</span>\n              </div>\n              {previousRating.notes && (\n                <div>\n                  <span className=\"font-medium\">Notes:</span>\n                  <p className=\"mt-1 text-gray-600 bg-white p-2 rounded border max-h-24 overflow-y-auto\">\n                    {previousRating.notes}\n                  </p>\n                </div>\n              )}\n            </div>\n          </div>\n        )}\n\n        <hr className=\"border-gray-200\" />\n\n        {/* Rating Form */}\n        <form onSubmit={handleSubmit} className=\"space-y-4\">\n          {/* Confidence Selection */}\n          <div className=\"form-group\">\n            <label className=\"form-label\">Real variable?</label>\n            <div className=\"flex gap-2\">\n              {CONFIDENCE_OPTIONS.map((option) => (\n                <button\n                  key={option.value}\n                  type=\"button\"\n                  onClick={() => setConfidence(option.value)}\n                  className={`flex-1 py-2 px-3 rounded-md font-medium transition-all ${\n                    confidence === option.value\n                      ? `${option.color} text-white shadow-md`\n                      : \"bg-gray-100 text-gray-700 hover:bg-gray-200\"\n                  }`}\n                >\n                  {option.label}\n                </button>\n              ))}\n            </div>\n          </div>\n\n          {/* Tag Selection */}\n          <div className=\"form-group\">\n            <label className=\"form-label\">Classification Tag</label>\n            <div className=\"flex gap-2\">\n              <select\n                value={selectedTagId}\n                onChange={(e) => setSelectedTagId(e.target.value)}\n                className=\"form-select flex-1\"\n              >\n                <option value=\"\">Select a tag...</option>\n                {tags.map((tag) => (\n                  <option key={tag.id} value={tag.id}>\n                    {tag.name}\n                  </option>\n                ))}\n              </select>\n              {onCreateTag && (\n                <button\n                  type=\"button\"\n                  onClick={() => setShowNewTagForm(!showNewTagForm)}\n                  className=\"btn btn-success btn-sm\"\n                  title=\"Create new tag\"\n                >\n                  +\n                </button>\n              )}\n            </div>\n          </div>\n\n          {/* New Tag Form */}\n          {showNewTagForm && onCreateTag && (\n            <div className=\"bg-gray-50 rounded-lg p-3 border border-gray-200 space-y-2\">\n              <input\n                type=\"text\"\n                value={newTagName}\n                onChange={(e) => setNewTagName(e.target.value)}\n                placeholder=\"Tag name\"\n                className=\"form-control\"\n              />\n              <textarea\n                value={newTagDescription}\n                onChange={(e) => setNewTagDescription(e.target.value)}\n                placeholder=\"Description (optional)\"\n                rows={2}\n                className=\"form-control\"\n              />\n              <div className=\"flex justify-end gap-2\">\n                <button\n                  type=\"button\"\n                  onClick={() => setShowNewTagForm(false)}\n                  className=\"btn btn-secondary btn-sm\"\n                >\n                  Cancel\n                </button>\n                <button\n                  type=\"button\"\n                  onClick={handleCreateTag}\n                  disabled={!newTagName.trim()}\n                  className=\"btn btn-primary btn-sm\"\n                >\n                  Add Tag\n                </button>\n              </div>\n            </div>\n          )}\n\n          {/* Notes */}\n          <div className=\"form-group\">\n            <label className=\"form-label\">Notes</label>\n            <textarea\n              value={notes}\n              onChange={(e) => setNotes(e.target.value)}\n              placeholder=\"Add any observations or notes...\"\n              rows={4}\n              className=\"form-control\"\n            />\n          </div>\n\n          {/* Action Buttons */}\n          <div className=\"space-y-2\">\n            <button\n              type=\"submit\"\n              disabled={isSubmitting || isLoading || !selectedTagId}\n              className=\"btn btn-primary w-full\"\n            >\n              {isSubmitting ? (\n                <span className=\"flex items-center justify-center gap-2\">\n                  <span className=\"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin\" />\n                  Saving...\n                </span>\n              ) : previousRating ? (\n                \"Update Rating\"\n              ) : (\n                \"Submit Rating\"\n              )}\n            </button>\n\n            {onNextUnrated && (\n              <button type=\"button\" onClick={onNextUnrated} className=\"btn btn-success w-full\">\n                Next Unrated Candidate â†’\n              </button>\n            )}\n          </div>\n        </form>\n      </div>\n    </div>\n  );\n};\n\nexport default RatingCard;\n","import React, { useState } from \"react\";\nimport { useParams, Link } from \"react-router-dom\";\nimport ProvenanceStrip from \"../components/provenance/ProvenanceStrip\";\nimport ErrorDisplay from \"../components/errors/ErrorDisplay\";\nimport {\n  Card,\n  CoordinateDisplay,\n  ImageThumbnail,\n  LoadingSpinner,\n  QAMetrics,\n} from \"../components/common\";\nimport { AladinLiteViewer, GifPlayer } from \"../components/widgets\";\nimport { FitsViewer } from \"../components/fits\";\nimport { RatingCard, RatingTag } from \"../components/rating\";\nimport { mapProvenanceFromImageDetail, ImageDetailResponse } from \"../utils/provenanceMappers\";\nimport { relativeTime } from \"../utils/relativeTime\";\nimport type { ErrorResponse } from \"../types/errors\";\nimport { useImage } from \"../hooks/useQueries\";\nimport { usePreferencesStore } from \"../stores/appStore\";\n\n/**\n * Detail page for a single image.\n * Displays image metadata, provenance strip, and visualization options.\n */\nconst ImageDetailPage: React.FC = () => {\n  const { imageId } = useParams<{ imageId: string }>();\n  const { data: image, isLoading, error, refetch } = useImage(imageId);\n  const addRecentImage = usePreferencesStore((state) => state.addRecentImage);\n  const [showSkyViewer, setShowSkyViewer] = useState(true);\n  const [showFitsViewer, setShowFitsViewer] = useState(false);\n  const [showRatingCard, setShowRatingCard] = useState(false);\n\n  // Rating tags for QA assessment\n  const ratingTags: RatingTag[] = [\n    { id: \"artifact\", name: \"Artifact\", color: \"#EF4444\", description: \"Image contains artifacts\" },\n    { id: \"good\", name: \"Good Quality\", color: \"#22C55E\", description: \"Image passes QA\" },\n    { id: \"marginal\", name: \"Marginal\", color: \"#F59E0B\", description: \"Borderline quality\" },\n    { id: \"rfi\", name: \"RFI\", color: \"#8B5CF6\", description: \"Radio frequency interference\" },\n  ];\n\n  const handleRatingSubmit = async (rating: {\n    itemId: string;\n    confidence: \"true\" | \"false\" | \"unsure\";\n    tagId: string;\n    notes: string;\n  }) => {\n    const baseUrl = import.meta.env.VITE_API_URL || \"/api\";\n    await fetch(`${baseUrl}/images/${rating.itemId}/rating`, {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify(rating),\n    });\n    // Refresh image data\n    refetch();\n  };\n\n  // Track in recent items when image loads\n  React.useEffect(() => {\n    if (image && imageId) {\n      addRecentImage(imageId);\n    }\n  }, [image, imageId, addRecentImage]);\n\n  if (isLoading) {\n    return <LoadingSpinner label=\"Loading image details...\" />;\n  }\n\n  if (error) {\n    return (\n      <div className=\"max-w-4xl mx-auto p-6\">\n        <ErrorDisplay error={error as unknown as ErrorResponse} onRetry={() => refetch()} />\n      </div>\n    );\n  }\n\n  if (!image) {\n    return (\n      <div className=\"max-w-4xl mx-auto p-6\">\n        <Card>\n          <p className=\"text-gray-500 mb-4\">Image not found.</p>\n          <Link to=\"/images\" className=\"link\">\n            Back to Images\n          </Link>\n        </Card>\n      </div>\n    );\n  }\n\n  // Cast to expected response type for mapper\n  const imageData = image as ImageDetailResponse;\n  const provenance = mapProvenanceFromImageDetail(imageData);\n  const filename = image.path?.split(\"/\").pop() || image.id;\n\n  return (\n    <div className=\"max-w-6xl mx-auto p-6\">\n      {/* Header */}\n      <div className=\"mb-6\">\n        <Link to=\"/images\" className=\"text-sm text-gray-500 hover:text-gray-700 mb-2 inline-block\">\n          Back to Images\n        </Link>\n        <h1 className=\"text-2xl font-bold text-gray-900 mb-2\">{filename}</h1>\n        <ProvenanceStrip {...provenance} />\n      </div>\n\n      {/* Main content grid */}\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n        {/* Left column - Preview and actions (sticky on desktop) */}\n        <div className=\"lg:col-span-1 sticky-sidebar\">\n          {/* Image preview */}\n          <Card title=\"Preview\">\n            <div className=\"flex justify-center\">\n              <ImageThumbnail imageId={imageId || \"\"} size=\"lg\" alt={filename} />\n            </div>\n          </Card>\n\n          {/* Actions */}\n          <Card title=\"Actions\">\n            <div className=\"flex flex-col gap-2\">\n              <a\n                href={`${import.meta.env.VITE_API_URL || \"/api\"}/images/${imageId}/fits`}\n                target=\"_blank\"\n                rel=\"noreferrer\"\n                className=\"btn btn-primary text-center\"\n              >\n                Download FITS\n              </a>\n              <button\n                type=\"button\"\n                className={`btn ${showFitsViewer ? \"btn-primary\" : \"btn-secondary\"}`}\n                onClick={() => setShowFitsViewer(!showFitsViewer)}\n              >\n                {showFitsViewer ? \"Hide\" : \"Show\"} FITS Viewer\n              </button>\n              <button\n                type=\"button\"\n                className={`btn ${showRatingCard ? \"btn-primary\" : \"btn-secondary\"}`}\n                onClick={() => setShowRatingCard(!showRatingCard)}\n              >\n                {showRatingCard ? \"Hide\" : \"Show\"} Rating\n              </button>\n              {imageData.qa_grade && (\n                <Link to={`/qa/image/${imageId}`} className=\"btn btn-secondary text-center\">\n                  View QA Report\n                </Link>\n              )}\n            </div>\n          </Card>\n        </div>\n\n        {/* Right column - Details */}\n        <div className=\"lg:col-span-2 space-y-6\">\n          {/* Interactive FITS Viewer */}\n          {showFitsViewer && (\n            <Card title=\"FITS Viewer\">\n              <FitsViewer\n                fitsUrl={`${import.meta.env.VITE_API_URL || \"/api\"}/images/${imageId}/fits`}\n                displayId={`fits-${imageId}`}\n                width={600}\n                height={500}\n                showControls\n                initialCenter={\n                  imageData.pointing_ra_deg != null && imageData.pointing_dec_deg != null\n                    ? { ra: imageData.pointing_ra_deg, dec: imageData.pointing_dec_deg }\n                    : undefined\n                }\n              />\n            </Card>\n          )}\n\n          {/* Rating Card */}\n          {showRatingCard && (\n            <Card title=\"Image Rating\">\n              <RatingCard\n                itemId={imageId || \"\"}\n                itemName={filename}\n                tags={ratingTags}\n                previousRating={\n                  imageData.qa_grade\n                    ? {\n                        id: `rating-${imageId}`,\n                        confidence:\n                          imageData.qa_grade === \"good\"\n                            ? \"true\"\n                            : imageData.qa_grade === \"fail\"\n                            ? \"false\"\n                            : \"unsure\",\n                        tag:\n                          ratingTags.find(\n                            (t) =>\n                              t.id ===\n                              (imageData.qa_grade === \"good\"\n                                ? \"good\"\n                                : imageData.qa_grade === \"fail\"\n                                ? \"artifact\"\n                                : \"marginal\")\n                          ) || ratingTags[0],\n                        user: \"system\",\n                        date: imageData.created_at || new Date().toISOString(),\n                      }\n                    : undefined\n                }\n                onSubmit={handleRatingSubmit}\n              />\n            </Card>\n          )}\n\n          {/* QA Metrics */}\n          {(imageData.qa_grade || imageData.noise_jy || imageData.dynamic_range) && (\n            <Card title=\"Quality Assessment\">\n              <QAMetrics\n                grade={imageData.qa_grade as \"good\" | \"warn\" | \"fail\" | undefined}\n                summary={imageData.qa_summary}\n                noiseJy={imageData.noise_jy}\n                dynamicRange={imageData.dynamic_range}\n                beamMajorArcsec={imageData.beam_major_arcsec}\n                beamMinorArcsec={imageData.beam_minor_arcsec}\n                beamPaDeg={imageData.beam_pa_deg}\n              />\n            </Card>\n          )}\n\n          {/* Coordinates */}\n          {imageData.pointing_ra_deg != null && imageData.pointing_dec_deg != null && (\n            <Card\n              title=\"Pointing\"\n              subtitle={\n                <button\n                  type=\"button\"\n                  onClick={() => setShowSkyViewer(!showSkyViewer)}\n                  className=\"text-xs text-blue-600 hover:text-blue-800\"\n                >\n                  {showSkyViewer ? \"Hide Sky View\" : \"Show Sky View\"}\n                </button>\n              }\n            >\n              <CoordinateDisplay\n                raDeg={imageData.pointing_ra_deg}\n                decDeg={imageData.pointing_dec_deg}\n                showDecimal\n                allowFormatToggle\n              />\n              {showSkyViewer && (\n                <div className=\"mt-4\">\n                  <AladinLiteViewer\n                    raDeg={imageData.pointing_ra_deg}\n                    decDeg={imageData.pointing_dec_deg}\n                    fov={0.5}\n                    height={250}\n                    className=\"rounded-lg overflow-hidden\"\n                  />\n                </div>\n              )}\n            </Card>\n          )}\n\n          {/* Metadata */}\n          <Card title=\"Metadata\">\n            <dl className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\n              <div>\n                <dt className=\"text-xs text-gray-500 uppercase tracking-wide\">Image ID</dt>\n                <dd className=\"font-mono text-sm text-gray-900 break-all\">{image.id}</dd>\n              </div>\n              <div>\n                <dt className=\"text-xs text-gray-500 uppercase tracking-wide\">Created</dt>\n                <dd className=\"text-sm text-gray-900\">\n                  {image.created_at ? (\n                    <>\n                      {new Date(image.created_at).toLocaleString()}\n                      <span className=\"text-gray-500 ml-1\">({relativeTime(image.created_at)})</span>\n                    </>\n                  ) : (\n                    <span className=\"text-gray-400\">Unknown</span>\n                  )}\n                </dd>\n              </div>\n              <div className=\"sm:col-span-2\">\n                <dt className=\"text-xs text-gray-500 uppercase tracking-wide\">Path</dt>\n                <dd className=\"font-mono text-sm text-gray-900 break-all\">{image.path}</dd>\n              </div>\n              {image.ms_path && (\n                <div className=\"sm:col-span-2\">\n                  <dt className=\"text-xs text-gray-500 uppercase tracking-wide\">\n                    Source Measurement Set\n                  </dt>\n                  <dd className=\"font-mono text-sm break-all\">\n                    <Link\n                      to={`/ms/${encodeURIComponent(image.ms_path)}`}\n                      className=\"text-blue-600 hover:text-blue-800 hover:underline\"\n                    >\n                      {image.ms_path}\n                    </Link>\n                  </dd>\n                </div>\n              )}\n              {image.cal_table && (\n                <div className=\"sm:col-span-2\">\n                  <dt className=\"text-xs text-gray-500 uppercase tracking-wide\">\n                    Calibration Table\n                  </dt>\n                  <dd className=\"font-mono text-sm text-gray-900 break-all\">{image.cal_table}</dd>\n                </div>\n              )}\n              {image.run_id && (\n                <div>\n                  <dt className=\"text-xs text-gray-500 uppercase tracking-wide\">Pipeline Run</dt>\n                  <dd className=\"text-sm\">\n                    <Link\n                      to={`/jobs/${image.run_id}`}\n                      className=\"text-blue-600 hover:text-blue-800 hover:underline\"\n                    >\n                      {image.run_id}\n                    </Link>\n                  </dd>\n                </div>\n              )}\n            </dl>\n          </Card>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default ImageDetailPage;\n"],"names":["sizeClasses","ImageThumbnail","imageId","alt","size","onClick","expandable","apiUrl","loading","setLoading","useState","error","setError","expanded","setExpanded","thumbnailUrl","handleLoad","handleError","handleClick","jsxs","Fragment","e","jsx","CONFIDENCE_OPTIONS","RatingCard","itemId","itemName","tags","previousRating","onSubmit","onNextUnrated","onCreateTag","isLoading","className","confidence","setConfidence","selectedTagId","setSelectedTagId","notes","setNotes","isSubmitting","setIsSubmitting","showNewTagForm","setShowNewTagForm","newTagName","setNewTagName","newTagDescription","setNewTagDescription","handleSubmit","useCallback","handleCreateTag","newTag","formatDate","dateStr","option","tag","ImageDetailPage","useParams","image","refetch","useImage","addRecentImage","usePreferencesStore","state","showSkyViewer","setShowSkyViewer","showFitsViewer","setShowFitsViewer","showRatingCard","setShowRatingCard","ratingTags","handleRatingSubmit","rating","React","LoadingSpinner","ErrorDisplay","Card","Link","imageData","provenance","mapProvenanceFromImageDetail","filename","ProvenanceStrip","FitsViewer","t","QAMetrics","CoordinateDisplay","AladinLiteViewer","relativeTime"],"mappings":"2dAiBA,MAAMA,EAAc,CAClB,GAAI,YACJ,GAAI,YACJ,GAAI,WACN,EAMMC,EAAgD,CAAC,CACrD,QAAAC,EACA,IAAAC,EAAM,gBACN,KAAAC,EAAO,KACP,QAAAC,EACA,WAAAC,EAAa,GACb,OAAAC,EAAS,sDACX,IAAM,CACJ,KAAM,CAACC,EAASC,CAAU,EAAIC,EAAAA,SAAS,EAAI,EACrC,CAACC,EAAOC,CAAQ,EAAIF,EAAAA,SAAS,EAAK,EAClC,CAACG,EAAUC,CAAW,EAAIJ,EAAAA,SAAS,EAAK,EAGxCK,EAAe,GAAGR,CAAM,WAAWL,CAAO,aAE1Cc,EAAa,IAAM,CACvBP,EAAW,EAAK,EAChBG,EAAS,EAAK,CAChB,EAEMK,EAAc,IAAM,CACxBR,EAAW,EAAK,EAChBG,EAAS,EAAI,CACf,EAEMM,EAAc,IAAM,CACpBb,EACFA,EAAA,EACSC,GACTQ,EAAY,CAACD,CAAQ,CAEzB,EAEA,OACEM,EAAAA,KAAAC,WAAA,CACE,SAAA,CAAAD,EAAAA,KAAC,MAAA,CACC,UAAW,YACTnB,EAAYI,CAAI,CAClB,kEACEC,GAAWC,EAAa,yDAA2D,EACrF,GACA,QAASY,EACT,KAAMb,GAAWC,EAAa,SAAW,OACzC,SAAUD,GAAWC,EAAa,EAAI,OACtC,UAAYe,GAAM,EACXA,EAAE,MAAQ,SAAWA,EAAE,MAAQ,OAAShB,GAAWC,IACtDY,EAAA,CAEJ,EAGC,SAAA,CAAAV,GAAW,CAACG,GACXW,EAAAA,IAAC,MAAA,CAAI,UAAU,oDACb,SAAAH,EAAAA,KAAC,MAAA,CAAI,UAAU,2CACb,SAAA,CAAAG,EAAAA,IAAC,MAAA,CACC,UAAU,wBACV,KAAK,OACL,OAAO,eACP,QAAQ,YAER,SAAAA,EAAAA,IAAC,OAAA,CACC,cAAc,QACd,eAAe,QACf,YAAa,EACb,EAAE,2JAAA,CAAA,CACJ,CAAA,QAED,OAAA,CAAK,UAAU,6BAA6B,SAAA,aAAU,CAAA,CAAA,CACzD,CAAA,CACF,EAIDX,SACE,MAAA,CAAI,UAAU,+DACb,SAAAQ,EAAAA,KAAC,MAAA,CAAI,UAAU,2CACb,SAAA,CAAAG,EAAAA,IAAC,MAAA,CAAI,UAAU,UAAU,KAAK,OAAO,OAAO,eAAe,QAAQ,YACjE,SAAAA,EAAAA,IAAC,OAAA,CACC,cAAc,QACd,eAAe,QACf,YAAa,EACb,EAAE,2JAAA,CAAA,EAEN,QACC,OAAA,CAAK,UAAU,eAAe,SAAA,aAAU,CAAA,CAAA,CAC3C,CAAA,CACF,EAIFA,EAAAA,IAAC,MAAA,CACC,IAAKP,EACL,IAAAZ,EACA,UAAW,8BAA8BK,GAAWG,EAAQ,SAAW,EAAE,GACzE,OAAQK,EACR,QAASC,CAAA,CAAA,EAIVX,GAAc,CAACK,GAAS,CAACH,SACvB,MAAA,CAAI,UAAU,oDACb,SAAAc,EAAAA,IAAC,MAAA,CACC,UAAU,qBACV,KAAK,OACL,OAAO,eACP,QAAQ,YAER,SAAAA,EAAAA,IAAC,OAAA,CACC,cAAc,QACd,eAAe,QACf,YAAa,EACb,EAAE,2FAAA,CAAA,CACJ,CAAA,EAEJ,CAAA,CAAA,CAAA,EAKHT,GACCS,EAAAA,IAAC,MAAA,CACC,UAAU,kEACV,QAAS,IAAMR,EAAY,EAAK,EAChC,KAAK,SACL,aAAW,OAEX,SAAAK,EAAAA,KAAC,MAAA,CAAI,UAAU,sCACb,SAAA,CAAAG,EAAAA,IAAC,MAAA,CACC,IAAKP,EACL,IAAAZ,EACA,UAAU,mDAAA,CAAA,EAEZmB,EAAAA,IAAC,SAAA,CACC,UAAU,uFACV,QAAS,IAAMR,EAAY,EAAK,EAChC,aAAW,QAEX,SAAAQ,EAAAA,IAAC,OAAI,UAAU,UAAU,KAAK,OAAO,OAAO,eAAe,QAAQ,YACjE,SAAAA,EAAAA,IAAC,OAAA,CACC,cAAc,QACd,eAAe,QACf,YAAa,EACb,EAAE,sBAAA,CAAA,EAEN,CAAA,CAAA,CACF,EACF,CAAA,CAAA,CACF,EAEJ,CAEJ,ECpIMC,EAAiF,CACrF,CAAE,MAAO,OAAQ,MAAO,OAAQ,MAAO,cAAA,EACvC,CAAE,MAAO,QAAS,MAAO,QAAS,MAAO,YAAA,EACzC,CAAE,MAAO,SAAU,MAAO,SAAU,MAAO,eAAA,CAC7C,EAMMC,EAAwC,CAAC,CAC7C,OAAAC,EACA,SAAAC,EACA,KAAAC,EACA,eAAAC,EACA,SAAAC,EACA,cAAAC,EACA,YAAAC,EACA,UAAAC,EAAY,GACZ,UAAAC,EAAY,EACd,IAAM,CACJ,KAAM,CAACC,EAAYC,CAAa,EAAIzB,EAAAA,SAClCkB,GAAgB,YAAc,OAAA,EAE1B,CAACQ,EAAeC,CAAgB,EAAI3B,EAAAA,SACxCkB,GAAgB,IAAI,IAAMD,EAAK,CAAC,GAAG,IAAM,EAAA,EAErC,CAACW,EAAOC,CAAQ,EAAI7B,EAAAA,SAAiBkB,GAAgB,OAAS,EAAE,EAChE,CAACY,EAAcC,CAAe,EAAI/B,EAAAA,SAAS,EAAK,EAChD,CAACgC,EAAgBC,CAAiB,EAAIjC,EAAAA,SAAS,EAAK,EACpD,CAACkC,EAAYC,CAAa,EAAInC,EAAAA,SAAS,EAAE,EACzC,CAACoC,EAAmBC,CAAoB,EAAIrC,EAAAA,SAAS,EAAE,EAEvDsC,EAAeC,EAAAA,YACnB,MAAO5B,GAAuB,CAE5B,GADAA,EAAE,eAAA,EACE,EAACe,EAEL,CAAAK,EAAgB,EAAI,EACpB,GAAI,CACF,MAAMZ,EAAS,CACb,OAAAJ,EACA,WAAAS,EACA,MAAOE,EACP,MAAAE,CAAA,CACD,CACH,QAAA,CACEG,EAAgB,EAAK,CACvB,EACF,EACA,CAAChB,EAAQS,EAAYE,EAAeE,EAAOT,CAAQ,CAAA,EAG/CqB,EAAkBD,EAAAA,YAAY,SAAY,CAC9C,GAAI,GAACL,EAAW,KAAA,GAAU,CAACb,GAE3B,GAAI,CACF,MAAMoB,EAAS,MAAMpB,EAAYa,EAAW,OAAQE,EAAkB,MAAM,EAC5ET,EAAiBc,EAAO,EAAE,EAC1BN,EAAc,EAAE,EAChBE,EAAqB,EAAE,EACvBJ,EAAkB,EAAK,CACzB,OAAShC,EAAO,CACd,QAAQ,MAAM,wBAAyBA,CAAK,CAC9C,CACF,EAAG,CAACiC,EAAYE,EAAmBf,CAAW,CAAC,EAEzCqB,EAAcC,GACX,IAAI,KAAKA,CAAO,EAAE,eAAA,EAG3B,OACElC,EAAAA,KAAC,MAAA,CAAI,UAAW,QAAQc,CAAS,GAC/B,SAAA,CAAAX,EAAAA,IAAC,OAAI,UAAU,cACb,SAAAH,EAAAA,KAAC,KAAA,CAAG,UAAU,wBAAwB,SAAA,CAAA,SAAOO,CAAA,CAAA,CAAS,CAAA,CACxD,EAEAP,EAAAA,KAAC,MAAA,CAAI,UAAU,sBAEZ,SAAA,CAAAS,GACCT,EAAAA,KAAC,MAAA,CAAI,UAAU,mDACb,SAAA,CAAAG,EAAAA,IAAC,IAAA,CAAE,UAAU,6BAA6B,SAAA,wBAAqB,EAC/DH,EAAAA,KAAC,MAAA,CAAI,UAAU,oBACb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,aACb,SAAA,CAAAG,EAAAA,IAAC,OAAA,CAAK,UAAU,cAAc,SAAA,iBAAc,EAC5CA,EAAAA,IAAC,OAAA,CACC,UAAW,SACTM,EAAe,aAAe,OAC1B,gBACAA,EAAe,aAAe,QAC9B,cACA,eACN,GAEC,SAAAA,EAAe,WAAW,OAAO,CAAC,EAAE,cACnCA,EAAe,WAAW,MAAM,CAAC,CAAA,CAAA,CACrC,EACF,EACAT,EAAAA,KAAC,MAAA,CAAI,UAAU,aACb,SAAA,CAAAG,EAAAA,IAAC,OAAA,CAAK,UAAU,cAAc,SAAA,OAAI,QACjC,OAAA,CAAK,UAAU,mBAAoB,SAAAM,EAAe,IAAI,IAAA,CAAK,CAAA,EAC9D,EACAT,EAAAA,KAAC,MAAA,CAAI,UAAU,aACb,SAAA,CAAAG,EAAAA,IAAC,OAAA,CAAK,UAAU,cAAc,SAAA,QAAK,EACnCA,EAAAA,IAAC,OAAA,CAAM,SAAA8B,EAAWxB,EAAe,IAAI,CAAA,CAAE,CAAA,EACzC,EACCA,EAAe,OACdT,EAAAA,KAAC,MAAA,CACC,SAAA,CAAAG,EAAAA,IAAC,OAAA,CAAK,UAAU,cAAc,SAAA,SAAM,EACpCA,EAAAA,IAAC,IAAA,CAAE,UAAU,0EACV,WAAe,KAAA,CAClB,CAAA,CAAA,CACF,CAAA,CAAA,CAEJ,CAAA,EACF,EAGFA,EAAAA,IAAC,KAAA,CAAG,UAAU,iBAAA,CAAkB,EAGhCH,EAAAA,KAAC,OAAA,CAAK,SAAU6B,EAAc,UAAU,YAEtC,SAAA,CAAA7B,EAAAA,KAAC,MAAA,CAAI,UAAU,aACb,SAAA,CAAAG,EAAAA,IAAC,QAAA,CAAM,UAAU,aAAa,SAAA,iBAAc,QAC3C,MAAA,CAAI,UAAU,aACZ,SAAAC,EAAmB,IAAK+B,GACvBhC,EAAAA,IAAC,SAAA,CAEC,KAAK,SACL,QAAS,IAAMa,EAAcmB,EAAO,KAAK,EACzC,UAAW,0DACTpB,IAAeoB,EAAO,MAClB,GAAGA,EAAO,KAAK,wBACf,6CACN,GAEC,SAAAA,EAAO,KAAA,EATHA,EAAO,KAAA,CAWf,CAAA,CACH,CAAA,EACF,EAGAnC,EAAAA,KAAC,MAAA,CAAI,UAAU,aACb,SAAA,CAAAG,EAAAA,IAAC,QAAA,CAAM,UAAU,aAAa,SAAA,qBAAkB,EAChDH,EAAAA,KAAC,MAAA,CAAI,UAAU,aACb,SAAA,CAAAA,EAAAA,KAAC,SAAA,CACC,MAAOiB,EACP,SAAWf,GAAMgB,EAAiBhB,EAAE,OAAO,KAAK,EAChD,UAAU,qBAEV,SAAA,CAAAC,EAAAA,IAAC,SAAA,CAAO,MAAM,GAAG,SAAA,kBAAe,EAC/BK,EAAK,IAAK4B,GACTjC,EAAAA,IAAC,SAAA,CAAoB,MAAOiC,EAAI,GAC7B,SAAAA,EAAI,IAAA,EADMA,EAAI,EAEjB,CACD,CAAA,CAAA,CAAA,EAEFxB,GACCT,EAAAA,IAAC,SAAA,CACC,KAAK,SACL,QAAS,IAAMqB,EAAkB,CAACD,CAAc,EAChD,UAAU,yBACV,MAAM,iBACP,SAAA,GAAA,CAAA,CAED,CAAA,CAEJ,CAAA,EACF,EAGCA,GAAkBX,GACjBZ,OAAC,MAAA,CAAI,UAAU,6DACb,SAAA,CAAAG,EAAAA,IAAC,QAAA,CACC,KAAK,OACL,MAAOsB,EACP,SAAWvB,GAAMwB,EAAcxB,EAAE,OAAO,KAAK,EAC7C,YAAY,WACZ,UAAU,cAAA,CAAA,EAEZC,EAAAA,IAAC,WAAA,CACC,MAAOwB,EACP,SAAWzB,GAAM0B,EAAqB1B,EAAE,OAAO,KAAK,EACpD,YAAY,yBACZ,KAAM,EACN,UAAU,cAAA,CAAA,EAEZF,EAAAA,KAAC,MAAA,CAAI,UAAU,yBACb,SAAA,CAAAG,EAAAA,IAAC,SAAA,CACC,KAAK,SACL,QAAS,IAAMqB,EAAkB,EAAK,EACtC,UAAU,2BACX,SAAA,QAAA,CAAA,EAGDrB,EAAAA,IAAC,SAAA,CACC,KAAK,SACL,QAAS4B,EACT,SAAU,CAACN,EAAW,KAAA,EACtB,UAAU,yBACX,SAAA,SAAA,CAAA,CAED,CAAA,CACF,CAAA,EACF,EAIFzB,EAAAA,KAAC,MAAA,CAAI,UAAU,aACb,SAAA,CAAAG,EAAAA,IAAC,QAAA,CAAM,UAAU,aAAa,SAAA,QAAK,EACnCA,EAAAA,IAAC,WAAA,CACC,MAAOgB,EACP,SAAWjB,GAAMkB,EAASlB,EAAE,OAAO,KAAK,EACxC,YAAY,mCACZ,KAAM,EACN,UAAU,cAAA,CAAA,CACZ,EACF,EAGAF,EAAAA,KAAC,MAAA,CAAI,UAAU,YACb,SAAA,CAAAG,EAAAA,IAAC,SAAA,CACC,KAAK,SACL,SAAUkB,GAAgBR,GAAa,CAACI,EACxC,UAAU,yBAET,SAAAI,EACCrB,OAAC,OAAA,CAAK,UAAU,yCACd,SAAA,CAAAG,EAAAA,IAAC,OAAA,CAAK,UAAU,8EAAA,CAA+E,EAAE,WAAA,EAEnG,EACEM,EACF,gBAEA,eAAA,CAAA,EAIHE,SACE,SAAA,CAAO,KAAK,SAAS,QAASA,EAAe,UAAU,yBAAyB,SAAA,0BAAA,CAEjF,CAAA,CAAA,CAEJ,CAAA,CAAA,CACF,CAAA,CAAA,CACF,CAAA,EACF,CAEJ,EChRM0B,GAA4B,IAAM,CACtC,KAAM,CAAE,QAAAtD,CAAA,EAAYuD,EAAA,EACd,CAAE,KAAMC,EAAO,UAAA1B,EAAW,MAAArB,EAAO,QAAAgD,CAAA,EAAYC,EAAS1D,CAAO,EAC7D2D,EAAiBC,EAAqBC,GAAUA,EAAM,cAAc,EACpE,CAACC,EAAeC,CAAgB,EAAIvD,EAAAA,SAAS,EAAI,EACjD,CAACwD,EAAgBC,CAAiB,EAAIzD,EAAAA,SAAS,EAAK,EACpD,CAAC0D,EAAgBC,CAAiB,EAAI3D,EAAAA,SAAS,EAAK,EAGpD4D,EAA0B,CAC9B,CAAE,GAAI,WAAY,KAAM,WAAY,MAAO,UAAW,YAAa,0BAAA,EACnE,CAAE,GAAI,OAAQ,KAAM,eAAgB,MAAO,UAAW,YAAa,iBAAA,EACnE,CAAE,GAAI,WAAY,KAAM,WAAY,MAAO,UAAW,YAAa,oBAAA,EACnE,CAAE,GAAI,MAAO,KAAM,MAAO,MAAO,UAAW,YAAa,8BAAA,CAA+B,EAGpFC,EAAqB,MAAOC,GAK5B,CAEJ,MAAM,MAAM,+DAAqBA,EAAO,MAAM,UAAW,CACvD,OAAQ,OACR,QAAS,CAAE,eAAgB,kBAAA,EAC3B,KAAM,KAAK,UAAUA,CAAM,CAAA,CAC5B,EAEDb,EAAA,CACF,EASA,GANAc,EAAM,UAAU,IAAM,CAChBf,GAASxD,GACX2D,EAAe3D,CAAO,CAE1B,EAAG,CAACwD,EAAOxD,EAAS2D,CAAc,CAAC,EAE/B7B,EACF,OAAOV,EAAAA,IAACoD,EAAA,CAAe,MAAM,2BAA2B,EAG1D,GAAI/D,EACF,aACG,MAAA,CAAI,UAAU,wBACb,SAAAW,EAAAA,IAACqD,EAAA,CAAa,MAAAhE,EAA0C,QAAS,IAAMgD,EAAA,CAAQ,CAAG,EACpF,EAIJ,GAAI,CAACD,EACH,OACEpC,EAAAA,IAAC,MAAA,CAAI,UAAU,wBACb,gBAACsD,EAAA,CACC,SAAA,OAAC,IAAA,CAAE,UAAU,qBAAqB,SAAA,mBAAgB,QACjDC,EAAA,CAAK,GAAG,UAAU,UAAU,OAAO,SAAA,gBAAA,CAEpC,CAAA,CAAA,CACF,CAAA,CACF,EAKJ,MAAMC,EAAYpB,EACZqB,EAAaC,EAA6BF,CAAS,EACnDG,EAAWvB,EAAM,MAAM,MAAM,GAAG,EAAE,OAASA,EAAM,GAEvD,OACEvC,EAAAA,KAAC,MAAA,CAAI,UAAU,wBAEb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,OACb,SAAA,CAAAG,MAACuD,EAAA,CAAK,GAAG,UAAU,UAAU,8DAA8D,SAAA,iBAE3F,QACC,KAAA,CAAG,UAAU,wCAAyC,SAAAI,EAAS,EAChE3D,MAAC4D,EAAA,CAAiB,GAAGH,EAAY,CAAA,EACnC,EAGA5D,EAAAA,KAAC,MAAA,CAAI,UAAU,wCAEb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,+BAEb,SAAA,CAAAG,EAAAA,IAACsD,GAAK,MAAM,UACV,SAAAtD,EAAAA,IAAC,MAAA,CAAI,UAAU,sBACb,SAAAA,MAACrB,EAAA,CAAe,QAASC,GAAW,GAAI,KAAK,KAAK,IAAK+E,EAAU,CAAA,CACnE,CAAA,CACF,QAGCL,EAAA,CAAK,MAAM,UACV,SAAAzD,EAAAA,KAAC,MAAA,CAAI,UAAU,sBACb,SAAA,CAAAG,EAAAA,IAAC,IAAA,CACC,KAAM,+DAAoDpB,CAAO,QACjE,OAAO,SACP,IAAI,aACJ,UAAU,8BACX,SAAA,eAAA,CAAA,EAGDiB,EAAAA,KAAC,SAAA,CACC,KAAK,SACL,UAAW,OAAO+C,EAAiB,cAAgB,eAAe,GAClE,QAAS,IAAMC,EAAkB,CAACD,CAAc,EAE/C,SAAA,CAAAA,EAAiB,OAAS,OAAO,cAAA,CAAA,CAAA,EAEpC/C,EAAAA,KAAC,SAAA,CACC,KAAK,SACL,UAAW,OAAOiD,EAAiB,cAAgB,eAAe,GAClE,QAAS,IAAMC,EAAkB,CAACD,CAAc,EAE/C,SAAA,CAAAA,EAAiB,OAAS,OAAO,SAAA,CAAA,CAAA,EAEnCU,EAAU,UACTxD,EAAAA,IAACuD,EAAA,CAAK,GAAI,aAAa3E,CAAO,GAAI,UAAU,gCAAgC,SAAA,iBAE5E,CAAA,CAAA,CAEJ,CAAA,CACF,CAAA,EACF,EAGAiB,EAAAA,KAAC,MAAA,CAAI,UAAU,0BAEZ,SAAA,CAAA+C,GACC5C,EAAAA,IAACsD,EAAA,CAAK,MAAM,cACV,SAAAtD,EAAAA,IAAC6D,EAAA,CACC,QAAS,+DAAoDjF,CAAO,QACpE,UAAW,QAAQA,CAAO,GAC1B,MAAO,IACP,OAAQ,IACR,aAAY,GACZ,cACE4E,EAAU,iBAAmB,MAAQA,EAAU,kBAAoB,KAC/D,CAAE,GAAIA,EAAU,gBAAiB,IAAKA,EAAU,kBAChD,MAAA,CAAA,EAGV,EAIDV,GACC9C,EAAAA,IAACsD,EAAA,CAAK,MAAM,eACV,SAAAtD,EAAAA,IAACE,EAAA,CACC,OAAQtB,GAAW,GACnB,SAAU+E,EACV,KAAMX,EACN,eACEQ,EAAU,SACN,CACE,GAAI,UAAU5E,CAAO,GACrB,WACE4E,EAAU,WAAa,OACnB,OACAA,EAAU,WAAa,OACvB,QACA,SACN,IACER,EAAW,KACRc,GACCA,EAAE,MACDN,EAAU,WAAa,OACpB,OACAA,EAAU,WAAa,OACvB,WACA,WAAA,GACHR,EAAW,CAAC,EACnB,KAAM,SACN,KAAMQ,EAAU,YAAc,IAAI,KAAA,EAAO,YAAA,CAAY,EAEvD,OAEN,SAAUP,CAAA,CAAA,EAEd,GAIAO,EAAU,UAAYA,EAAU,UAAYA,EAAU,gBACtDxD,EAAAA,IAACsD,EAAA,CAAK,MAAM,qBACV,SAAAtD,EAAAA,IAAC+D,EAAA,CACC,MAAOP,EAAU,SACjB,QAASA,EAAU,WACnB,QAASA,EAAU,SACnB,aAAcA,EAAU,cACxB,gBAAiBA,EAAU,kBAC3B,gBAAiBA,EAAU,kBAC3B,UAAWA,EAAU,WAAA,CAAA,EAEzB,EAIDA,EAAU,iBAAmB,MAAQA,EAAU,kBAAoB,MAClE3D,EAAAA,KAACyD,EAAA,CACC,MAAM,WACN,SACEtD,EAAAA,IAAC,SAAA,CACC,KAAK,SACL,QAAS,IAAM2C,EAAiB,CAACD,CAAa,EAC9C,UAAU,4CAET,WAAgB,gBAAkB,eAAA,CAAA,EAIvC,SAAA,CAAA1C,EAAAA,IAACgE,EAAA,CACC,MAAOR,EAAU,gBACjB,OAAQA,EAAU,iBAClB,YAAW,GACX,kBAAiB,EAAA,CAAA,EAElBd,GACC1C,EAAAA,IAAC,MAAA,CAAI,UAAU,OACb,SAAAA,EAAAA,IAACiE,EAAA,CACC,MAAOT,EAAU,gBACjB,OAAQA,EAAU,iBAClB,IAAK,GACL,OAAQ,IACR,UAAU,4BAAA,CAAA,EAEd,CAAA,CAAA,CAAA,QAMLF,EAAA,CAAK,MAAM,WACV,SAAAzD,EAAAA,KAAC,KAAA,CAAG,UAAU,wCACZ,SAAA,CAAAA,OAAC,MAAA,CACC,SAAA,OAAC,KAAA,CAAG,UAAU,gDAAgD,SAAA,WAAQ,EACtEG,EAAAA,IAAC,KAAA,CAAG,UAAU,4CAA6C,WAAM,GAAG,CAAA,EACtE,SACC,MAAA,CACC,SAAA,OAAC,KAAA,CAAG,UAAU,gDAAgD,SAAA,UAAO,QACpE,KAAA,CAAG,UAAU,wBACX,SAAAoC,EAAM,WACLvC,EAAAA,KAAAC,EAAAA,SAAA,CACG,SAAA,CAAA,IAAI,KAAKsC,EAAM,UAAU,EAAE,eAAA,EAC5BvC,EAAAA,KAAC,OAAA,CAAK,UAAU,qBAAqB,SAAA,CAAA,IAAEqE,EAAa9B,EAAM,UAAU,EAAE,GAAA,EAAC,CAAA,EACzE,EAEApC,EAAAA,IAAC,OAAA,CAAK,UAAU,gBAAgB,mBAAO,CAAA,CAE3C,CAAA,EACF,EACAH,EAAAA,KAAC,MAAA,CAAI,UAAU,gBACb,SAAA,OAAC,KAAA,CAAG,UAAU,gDAAgD,SAAA,OAAI,EAClEG,EAAAA,IAAC,KAAA,CAAG,UAAU,4CAA6C,WAAM,KAAK,CAAA,EACxE,EACCoC,EAAM,SACLvC,OAAC,MAAA,CAAI,UAAU,gBACb,SAAA,OAAC,KAAA,CAAG,UAAU,gDAAgD,SAAA,yBAE9D,EACAG,EAAAA,IAAC,KAAA,CAAG,UAAU,8BACZ,SAAAA,EAAAA,IAACuD,EAAA,CACC,GAAI,OAAO,mBAAmBnB,EAAM,OAAO,CAAC,GAC5C,UAAU,oDAET,SAAAA,EAAM,OAAA,CAAA,EAEX,CAAA,EACF,EAEDA,EAAM,WACLvC,OAAC,MAAA,CAAI,UAAU,gBACb,SAAA,OAAC,KAAA,CAAG,UAAU,gDAAgD,SAAA,oBAE9D,EACAG,EAAAA,IAAC,KAAA,CAAG,UAAU,4CAA6C,WAAM,UAAU,CAAA,EAC7E,EAEDoC,EAAM,QACLvC,EAAAA,KAAC,MAAA,CACC,SAAA,OAAC,KAAA,CAAG,UAAU,gDAAgD,SAAA,eAAY,EAC1EG,EAAAA,IAAC,KAAA,CAAG,UAAU,UACZ,SAAAA,EAAAA,IAACuD,EAAA,CACC,GAAI,SAASnB,EAAM,MAAM,GACzB,UAAU,oDAET,SAAAA,EAAM,MAAA,CAAA,EAEX,CAAA,EACF,CAAA,CAAA,CAEJ,CAAA,CACF,CAAA,EACF,CAAA,EACF,CAAA,EACF,CAEJ"}