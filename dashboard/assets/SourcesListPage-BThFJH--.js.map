{"version":3,"file":"SourcesListPage-BThFJH--.js","sources":["../../src/components/query/SesameResolver.tsx","../../src/components/query/FluxFilters.tsx","../../src/components/query/VariabilityFilters.tsx","../../src/components/query/TagFilter.tsx","../../src/utils/coordinateParser.ts","../../src/components/query/AdvancedQueryPanel.tsx","../../src/components/variability/VariabilityControls.tsx","../../src/components/variability/SourcePreview.tsx","../../src/components/variability/EtaVPlot.tsx","../../src/pages/SourcesListPage.tsx"],"sourcesContent":["import React, { useState, useCallback, useRef } from \"react\";\n\nexport interface SesameResolverProps {\n  /** Callback when coordinates are resolved */\n  onResolved: (ra: number, dec: number, objectName: string) => void;\n  /** Custom class name */\n  className?: string;\n}\n\ntype SesameService = \"all\" | \"simbad\" | \"ned\" | \"vizier\";\n\ninterface ResolveResult {\n  ra: number;\n  dec: number;\n  objectName: string;\n  service: string;\n}\n\n// Simple in-memory cache for resolved objects\nconst resolveCache = new Map<string, ResolveResult>();\n\n/**\n * Sesame name resolver component.\n * Resolves astronomical object names to coordinates using CDS Sesame service.\n */\nconst SesameResolver: React.FC<SesameResolverProps> = ({ onResolved, className = \"\" }) => {\n  const [objectName, setObjectName] = useState(\"\");\n  const [service, setService] = useState<SesameService>(\"all\");\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [result, setResult] = useState<ResolveResult | null>(null);\n\n  // AbortController for request cancellation\n  const abortControllerRef = useRef<AbortController | null>(null);\n\n  const resolveObject = useCallback(async () => {\n    const trimmedName = objectName.trim();\n    if (!trimmedName) {\n      setError(\"Please enter an object name\");\n      return;\n    }\n\n    // Check cache first\n    const cacheKey = `${service}:${trimmedName.toLowerCase()}`;\n    const cached = resolveCache.get(cacheKey);\n    if (cached) {\n      setResult(cached);\n      setError(null);\n      onResolved(cached.ra, cached.dec, cached.objectName);\n      return;\n    }\n\n    // Cancel any pending request\n    if (abortControllerRef.current) {\n      abortControllerRef.current.abort();\n    }\n    abortControllerRef.current = new AbortController();\n\n    setIsLoading(true);\n    setError(null);\n    setResult(null);\n\n    try {\n      // Use CDS Sesame service via their API\n      // Format: https://cdsweb.u-strasbg.fr/cgi-bin/nph-sesame/-oI/A?object_name\n      const serviceCode = service === \"all\" ? \"A\" : service.charAt(0).toUpperCase();\n      const url = `https://cdsweb.u-strasbg.fr/cgi-bin/nph-sesame/-oI/${serviceCode}?${encodeURIComponent(\n        trimmedName\n      )}`;\n\n      const response = await fetch(url, {\n        signal: abortControllerRef.current.signal,\n      });\n\n      if (!response.ok) {\n        throw new Error(`HTTP error: ${response.status}`);\n      }\n\n      const text = await response.text();\n\n      // Parse the Sesame response\n      // Format includes lines like:\n      // %J 83.63308 +22.01450 = 05 34 31.94 +22 00 52.2\n      const jLine = text.split(\"\\n\").find((line) => line.startsWith(\"%J\"));\n\n      if (!jLine) {\n        throw new Error(\"Could not resolve object. Please check the name and try again.\");\n      }\n\n      const match = jLine.match(/%J\\s+([\\d.+-]+)\\s+([\\d.+-]+)/);\n      if (!match) {\n        throw new Error(\"Failed to parse coordinates from response.\");\n      }\n\n      const ra = parseFloat(match[1]);\n      const dec = parseFloat(match[2]);\n\n      const resolved: ResolveResult = {\n        ra,\n        dec,\n        objectName: trimmedName,\n        service,\n      };\n\n      // Cache the result\n      resolveCache.set(cacheKey, resolved);\n\n      setResult(resolved);\n      onResolved(ra, dec, trimmedName);\n    } catch (err) {\n      // Don't show error for aborted requests\n      if (err instanceof Error && err.name === \"AbortError\") {\n        return;\n      }\n      const message = err instanceof Error ? err.message : \"Resolution failed\";\n      // Distinguish network errors\n      if (message.includes(\"fetch\") || message.includes(\"network\")) {\n        setError(\"Network error. CORS may be blocking the request. Try using a backend proxy.\");\n      } else {\n        setError(message);\n      }\n    } finally {\n      setIsLoading(false);\n    }\n  }, [objectName, service, onResolved]);\n\n  const handleKeyDown = (e: React.KeyboardEvent) => {\n    if (e.key === \"Enter\") {\n      resolveObject();\n    }\n  };\n\n  return (\n    <div className={`space-y-3 ${className}`}>\n      <div className=\"flex gap-2\">\n        <input\n          type=\"text\"\n          value={objectName}\n          onChange={(e) => setObjectName(e.target.value)}\n          onKeyDown={handleKeyDown}\n          placeholder=\"Object name (e.g., M31, Crab Nebula, PSR J0534+2200)\"\n          className=\"form-control flex-1\"\n        />\n        <button\n          onClick={resolveObject}\n          disabled={isLoading || !objectName.trim()}\n          className=\"btn btn-primary\"\n        >\n          {isLoading ? (\n            <span className=\"flex items-center gap-1\">\n              <span className=\"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin\" />\n              Resolving...\n            </span>\n          ) : (\n            \"Resolve\"\n          )}\n        </button>\n      </div>\n\n      {/* Service selection */}\n      <div className=\"flex items-center gap-4 text-sm\">\n        <span className=\"text-gray-600\">Service:</span>\n        {([\"all\", \"simbad\", \"ned\", \"vizier\"] as SesameService[]).map((svc) => (\n          <label key={svc} className=\"flex items-center gap-1 cursor-pointer\">\n            <input\n              type=\"radio\"\n              name=\"sesame-service\"\n              value={svc}\n              checked={service === svc}\n              onChange={() => setService(svc)}\n              className=\"w-4 h-4 text-vast-green\"\n            />\n            <span className=\"capitalize\">{svc === \"all\" ? \"All\" : svc.toUpperCase()}</span>\n          </label>\n        ))}\n      </div>\n\n      {/* Error display */}\n      {error && (\n        <div className=\"text-red-600 text-sm flex items-center gap-1\">\n          <svg className=\"w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n            <path\n              fillRule=\"evenodd\"\n              d=\"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z\"\n              clipRule=\"evenodd\"\n            />\n          </svg>\n          {error}\n        </div>\n      )}\n\n      {/* Success display */}\n      {result && (\n        <div className=\"text-green-600 text-sm flex items-center gap-1\">\n          <svg className=\"w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n            <path\n              fillRule=\"evenodd\"\n              d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z\"\n              clipRule=\"evenodd\"\n            />\n          </svg>\n          <span>\n            Resolved: RA={result.ra.toFixed(6)}°, Dec={result.dec.toFixed(6)}°\n          </span>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default SesameResolver;\n","import React from \"react\";\n\nexport interface FluxFiltersProps {\n  /** Current filter values */\n  values: {\n    minFlux?: { min?: number; max?: number; type: \"peak\" | \"int\" };\n    maxFlux?: { min?: number; max?: number; type: \"peak\" | \"int\" };\n    avgFlux?: { min?: number; max?: number; type: \"peak\" | \"int\" };\n  };\n  /** Callback when values change */\n  onChange: (values: FluxFiltersProps[\"values\"]) => void;\n  /** Custom class name */\n  className?: string;\n}\n\n/**\n * Flux range filter inputs for min, max, and average flux.\n */\nconst FluxFilters: React.FC<FluxFiltersProps> = ({ values, onChange, className = \"\" }) => {\n  const handleChange = (\n    field: \"minFlux\" | \"maxFlux\" | \"avgFlux\",\n    subfield: \"min\" | \"max\" | \"type\",\n    value: string | number\n  ) => {\n    const current = values[field] || { type: \"peak\" as const };\n    onChange({\n      ...values,\n      [field]: {\n        ...current,\n        [subfield]: subfield === \"type\" ? value : value === \"\" ? undefined : Number(value),\n      },\n    });\n  };\n\n  const renderFluxRow = (\n    label: string,\n    field: \"minFlux\" | \"maxFlux\" | \"avgFlux\",\n    tooltip: string\n  ) => {\n    const current = values[field] || { type: \"peak\" as const };\n    return (\n      <div className=\"form-group\">\n        <div className=\"flex items-center gap-2 mb-1\">\n          <label className=\"form-label mb-0 font-semibold\">{label}</label>\n          <span className=\"text-gray-400 cursor-help\" title={tooltip}>\n            <svg className=\"w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n              <path\n                fillRule=\"evenodd\"\n                d=\"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z\"\n                clipRule=\"evenodd\"\n              />\n            </svg>\n          </span>\n        </div>\n        <div className=\"grid grid-cols-3 gap-2\">\n          <input\n            type=\"number\"\n            value={current.min ?? \"\"}\n            onChange={(e) => handleChange(field, \"min\", e.target.value)}\n            placeholder=\"Min (mJy)\"\n            step=\"0.01\"\n            className=\"form-control\"\n          />\n          <input\n            type=\"number\"\n            value={current.max ?? \"\"}\n            onChange={(e) => handleChange(field, \"max\", e.target.value)}\n            placeholder=\"Max (mJy)\"\n            step=\"0.01\"\n            className=\"form-control\"\n          />\n          <select\n            value={current.type || \"peak\"}\n            onChange={(e) => handleChange(field, \"type\", e.target.value)}\n            className=\"form-select\"\n          >\n            <option value=\"peak\">Peak Flux</option>\n            <option value=\"int\">Int Flux</option>\n          </select>\n        </div>\n      </div>\n    );\n  };\n\n  return (\n    <div className={`space-y-4 ${className}`}>\n      {renderFluxRow(\n        \"Min. Flux\",\n        \"minFlux\",\n        \"The minimum flux of a source. Peak or integrated flux can be selected.\"\n      )}\n      {renderFluxRow(\n        \"Max. Flux\",\n        \"maxFlux\",\n        \"The maximum flux of a source. Peak or integrated flux can be selected.\"\n      )}\n      {renderFluxRow(\n        \"Avg. Flux\",\n        \"avgFlux\",\n        \"The average flux of a source. Peak or integrated flux can be selected.\"\n      )}\n    </div>\n  );\n};\n\nexport default FluxFilters;\n","import React from \"react\";\n\nexport interface VariabilityFiltersProps {\n  /** Current filter values */\n  values: {\n    eta?: { min?: number; max?: number; type: \"peak\" | \"int\" };\n    v?: { min?: number; max?: number; type: \"peak\" | \"int\" };\n    vs?: { min?: number; max?: number; type: \"peak\" | \"int\" };\n    m?: { min?: number; max?: number; type: \"peak\" | \"int\" };\n  };\n  /** Callback when values change */\n  onChange: (values: VariabilityFiltersProps[\"values\"]) => void;\n  /** Custom class name */\n  className?: string;\n}\n\n/**\n * Variability metric filter inputs (η, V, Vs, m).\n */\nconst VariabilityFilters: React.FC<VariabilityFiltersProps> = ({\n  values,\n  onChange,\n  className = \"\",\n}) => {\n  const handleChange = (\n    field: \"eta\" | \"v\" | \"vs\" | \"m\",\n    subfield: \"min\" | \"max\" | \"type\",\n    value: string | number\n  ) => {\n    const current = values[field] || { type: \"peak\" as const };\n    onChange({\n      ...values,\n      [field]: {\n        ...current,\n        [subfield]: subfield === \"type\" ? value : value === \"\" ? undefined : Number(value),\n      },\n    });\n  };\n\n  const renderMetricRow = (\n    label: string,\n    field: \"eta\" | \"v\" | \"vs\" | \"m\",\n    tooltip: string,\n    showType: boolean = true\n  ) => {\n    const current = values[field] || { type: \"peak\" as const };\n    return (\n      <div className=\"form-group\">\n        <div className=\"flex items-center gap-2 mb-1\">\n          <label className=\"form-label mb-0 font-semibold\">{label}</label>\n          <span className=\"text-gray-400 cursor-help\" title={tooltip}>\n            <svg className=\"w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n              <path\n                fillRule=\"evenodd\"\n                d=\"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z\"\n                clipRule=\"evenodd\"\n              />\n            </svg>\n          </span>\n        </div>\n        <div className={`grid ${showType ? \"grid-cols-3\" : \"grid-cols-2\"} gap-2`}>\n          <input\n            type=\"number\"\n            value={current.min ?? \"\"}\n            onChange={(e) => handleChange(field, \"min\", e.target.value)}\n            placeholder=\"Min\"\n            step=\"0.01\"\n            className=\"form-control\"\n          />\n          <input\n            type=\"number\"\n            value={current.max ?? \"\"}\n            onChange={(e) => handleChange(field, \"max\", e.target.value)}\n            placeholder=\"Max\"\n            step=\"0.01\"\n            className=\"form-control\"\n          />\n          {showType && (\n            <select\n              value={current.type || \"peak\"}\n              onChange={(e) => handleChange(field, \"type\", e.target.value)}\n              className=\"form-select\"\n            >\n              <option value=\"peak\">Peak Flux</option>\n              <option value=\"int\">Int Flux</option>\n            </select>\n          )}\n        </div>\n      </div>\n    );\n  };\n\n  return (\n    <div className={`space-y-4 ${className}`}>\n      {renderMetricRow(\n        \"η (Eta) Metric\",\n        \"eta\",\n        \"The weighted reduced chi-squared variability metric. Higher values indicate more variability.\"\n      )}\n      {renderMetricRow(\n        \"V Metric\",\n        \"v\",\n        \"The variability index, equivalent to fractional variability. V = σ/μ.\"\n      )}\n      {renderMetricRow(\n        \"Max |Vs| Metric\",\n        \"vs\",\n        \"The maximum two-epoch variability t-statistic value derived from the source.\"\n      )}\n      {renderMetricRow(\n        \"Max |m| Metric\",\n        \"m\",\n        \"The maximum two-epoch modulation index derived from the source (measure of variability).\"\n      )}\n    </div>\n  );\n};\n\nexport default VariabilityFilters;\n","import React, { useState } from \"react\";\n\nexport interface TagFilterProps {\n  /** Available tags */\n  availableTags: string[];\n  /** Currently included tags */\n  includeTags: string[];\n  /** Currently excluded tags */\n  excludeTags: string[];\n  /** Callback when include tags change */\n  onIncludeChange: (tags: string[]) => void;\n  /** Callback when exclude tags change */\n  onExcludeChange: (tags: string[]) => void;\n  /** Custom class name */\n  className?: string;\n}\n\n/**\n * Tag include/exclude filter with autocomplete.\n */\nconst TagFilter: React.FC<TagFilterProps> = ({\n  availableTags,\n  includeTags,\n  excludeTags,\n  onIncludeChange,\n  onExcludeChange,\n  className = \"\",\n}) => {\n  const [includeInput, setIncludeInput] = useState(\"\");\n  const [excludeInput, setExcludeInput] = useState(\"\");\n  const [showIncludeSuggestions, setShowIncludeSuggestions] = useState(false);\n  const [showExcludeSuggestions, setShowExcludeSuggestions] = useState(false);\n\n  const getFilteredSuggestions = (input: string, currentTags: string[]) => {\n    if (!input.trim()) return [];\n    const lower = input.toLowerCase();\n    return availableTags\n      .filter((tag) => tag.toLowerCase().includes(lower) && !currentTags.includes(tag))\n      .slice(0, 10);\n  };\n\n  const addTag = (\n    tag: string,\n    currentTags: string[],\n    onChange: (tags: string[]) => void,\n    setInput: (val: string) => void\n  ) => {\n    if (!currentTags.includes(tag)) {\n      onChange([...currentTags, tag]);\n    }\n    setInput(\"\");\n  };\n\n  const removeTag = (tag: string, currentTags: string[], onChange: (tags: string[]) => void) => {\n    onChange(currentTags.filter((t) => t !== tag));\n  };\n\n  const renderTagInput = (\n    label: string,\n    input: string,\n    setInput: (val: string) => void,\n    tags: string[],\n    onChange: (tags: string[]) => void,\n    showSuggestions: boolean,\n    setShowSuggestions: (show: boolean) => void,\n    tooltip: string\n  ) => {\n    const suggestions = getFilteredSuggestions(input, tags);\n\n    return (\n      <div className=\"form-group\">\n        <div className=\"flex items-center gap-2 mb-1\">\n          <label className=\"form-label mb-0 font-semibold\">{label}</label>\n          <span className=\"text-gray-400 cursor-help\" title={tooltip}>\n            <svg className=\"w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n              <path\n                fillRule=\"evenodd\"\n                d=\"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z\"\n                clipRule=\"evenodd\"\n              />\n            </svg>\n          </span>\n        </div>\n\n        {/* Selected tags */}\n        {tags.length > 0 && (\n          <div className=\"flex flex-wrap gap-1 mb-2\">\n            {tags.map((tag) => (\n              <span key={tag} className=\"badge badge-secondary flex items-center gap-1\">\n                {tag}\n                <button\n                  onClick={() => removeTag(tag, tags, onChange)}\n                  className=\"hover:text-red-500\"\n                >\n                  ×\n                </button>\n              </span>\n            ))}\n          </div>\n        )}\n\n        {/* Input with suggestions */}\n        <div className=\"relative\">\n          <input\n            type=\"text\"\n            value={input}\n            onChange={(e) => {\n              setInput(e.target.value);\n              setShowSuggestions(true);\n            }}\n            onFocus={() => setShowSuggestions(true)}\n            onBlur={() => setTimeout(() => setShowSuggestions(false), 200)}\n            onKeyDown={(e) => {\n              if (e.key === \"Enter\" && input.trim()) {\n                e.preventDefault();\n                if (suggestions.length > 0) {\n                  addTag(suggestions[0], tags, onChange, setInput);\n                } else if (availableTags.includes(input.trim())) {\n                  addTag(input.trim(), tags, onChange, setInput);\n                }\n              }\n            }}\n            placeholder=\"Type to search tags...\"\n            className=\"form-control w-full\"\n          />\n\n          {/* Suggestions dropdown */}\n          {showSuggestions && suggestions.length > 0 && (\n            <div className=\"absolute z-10 w-full mt-1 bg-white border border-gray-200 rounded-md shadow-lg max-h-48 overflow-auto\">\n              {suggestions.map((suggestion) => (\n                <button\n                  key={suggestion}\n                  onClick={() => addTag(suggestion, tags, onChange, setInput)}\n                  className=\"w-full text-left px-3 py-2 hover:bg-gray-100 text-sm\"\n                >\n                  {suggestion}\n                </button>\n              ))}\n            </div>\n          )}\n        </div>\n      </div>\n    );\n  };\n\n  return (\n    <div className={`space-y-4 ${className}`}>\n      {renderTagInput(\n        \"Include Tags\",\n        includeInput,\n        setIncludeInput,\n        includeTags,\n        onIncludeChange,\n        showIncludeSuggestions,\n        setShowIncludeSuggestions,\n        \"Only return sources that have the given tags.\"\n      )}\n      {renderTagInput(\n        \"Exclude Tags\",\n        excludeInput,\n        setExcludeInput,\n        excludeTags,\n        onExcludeChange,\n        showExcludeSuggestions,\n        setShowExcludeSuggestions,\n        \"Only return sources that do NOT have the given tags.\"\n      )}\n    </div>\n  );\n};\n\nexport default TagFilter;\n","/**\n * Parse astronomical coordinates from various formats.\n * Supports decimal degrees, HMS (hours:minutes:seconds) for RA,\n * and DMS (degrees:minutes:seconds) for Dec.\n */\n\n/**\n * Parse RA from various formats to decimal degrees.\n * Accepts:\n * - Decimal degrees: 180.5\n * - HMS with colons: 12:30:00 or 12:30:00.0\n * - HMS with letters: 12h30m00s\n * - HMS with spaces: 12 30 00\n *\n * @returns RA in decimal degrees [0, 360) or null if invalid\n */\nexport function parseRA(input: string): number | null {\n  if (!input || typeof input !== \"string\") return null;\n\n  const trimmed = input.trim();\n  if (!trimmed) return null;\n\n  // Try decimal degrees first\n  const decimal = parseFloat(trimmed);\n  if (!isNaN(decimal) && !trimmed.includes(\":\") && !trimmed.match(/[hms°'\"]/i)) {\n    // Validate range\n    if (decimal >= 0 && decimal < 360) {\n      return decimal;\n    }\n    // Could be hours if in [0, 24)\n    if (decimal >= 0 && decimal < 24) {\n      return decimal * 15; // Convert hours to degrees\n    }\n    return null;\n  }\n\n  // Try HMS format\n  const hmsMatch = trimmed.match(\n    /^(\\d{1,2})(?:h|:|\\s)\\s*(\\d{1,2})(?:m|:|\\s)\\s*(\\d{1,2}(?:\\.\\d+)?)\\s*s?$/i\n  );\n\n  if (hmsMatch) {\n    const hours = parseInt(hmsMatch[1], 10);\n    const minutes = parseInt(hmsMatch[2], 10);\n    const seconds = parseFloat(hmsMatch[3]);\n\n    if (hours >= 0 && hours < 24 && minutes >= 0 && minutes < 60 && seconds >= 0 && seconds < 60) {\n      const totalHours = hours + minutes / 60 + seconds / 3600;\n      return totalHours * 15; // Convert hours to degrees\n    }\n  }\n\n  // Try short HMS (no seconds): 12:30 or 12h30m\n  const hmsShortMatch = trimmed.match(/^(\\d{1,2})(?:h|:|\\s)\\s*(\\d{1,2})(?:m)?$/i);\n\n  if (hmsShortMatch) {\n    const hours = parseInt(hmsShortMatch[1], 10);\n    const minutes = parseInt(hmsShortMatch[2], 10);\n\n    if (hours >= 0 && hours < 24 && minutes >= 0 && minutes < 60) {\n      const totalHours = hours + minutes / 60;\n      return totalHours * 15;\n    }\n  }\n\n  return null;\n}\n\n/**\n * Parse Dec from various formats to decimal degrees.\n * Accepts:\n * - Decimal degrees: +45.5 or -45.5\n * - DMS with colons: +45:30:00 or -45:30:00\n * - DMS with symbols: +45°30'00\" or 45d30m00s\n * - DMS with spaces: +45 30 00\n *\n * @returns Dec in decimal degrees [-90, 90] or null if invalid\n */\nexport function parseDec(input: string): number | null {\n  if (!input || typeof input !== \"string\") return null;\n\n  const trimmed = input.trim();\n  if (!trimmed) return null;\n\n  // Determine sign\n  let sign = 1;\n  let working = trimmed;\n\n  if (working.startsWith(\"-\")) {\n    sign = -1;\n    working = working.slice(1).trim();\n  } else if (working.startsWith(\"+\")) {\n    working = working.slice(1).trim();\n  }\n\n  // Try decimal degrees first\n  const decimal = parseFloat(working);\n  if (!isNaN(decimal) && !working.includes(\":\") && !working.match(/[dms°'\"]/i)) {\n    const result = sign * decimal;\n    if (result >= -90 && result <= 90) {\n      return result;\n    }\n    return null;\n  }\n\n  // Try DMS format\n  const dmsMatch = working.match(\n    /^(\\d{1,2})(?:d|°|:|\\s)\\s*(\\d{1,2})(?:m|'|:|\\s)\\s*(\\d{1,2}(?:\\.\\d+)?)\\s*(?:s|\")?$/i\n  );\n\n  if (dmsMatch) {\n    const degrees = parseInt(dmsMatch[1], 10);\n    const minutes = parseInt(dmsMatch[2], 10);\n    const seconds = parseFloat(dmsMatch[3]);\n\n    if (\n      degrees >= 0 &&\n      degrees <= 90 &&\n      minutes >= 0 &&\n      minutes < 60 &&\n      seconds >= 0 &&\n      seconds < 60\n    ) {\n      const totalDegrees = degrees + minutes / 60 + seconds / 3600;\n      const result = sign * totalDegrees;\n      if (result >= -90 && result <= 90) {\n        return result;\n      }\n    }\n  }\n\n  // Try short DMS (no seconds): +45:30 or 45d30m\n  const dmsShortMatch = working.match(/^(\\d{1,2})(?:d|°|:|\\s)\\s*(\\d{1,2})(?:m|')?$/i);\n\n  if (dmsShortMatch) {\n    const degrees = parseInt(dmsShortMatch[1], 10);\n    const minutes = parseInt(dmsShortMatch[2], 10);\n\n    if (degrees >= 0 && degrees <= 90 && minutes >= 0 && minutes < 60) {\n      const totalDegrees = degrees + minutes / 60;\n      const result = sign * totalDegrees;\n      if (result >= -90 && result <= 90) {\n        return result;\n      }\n    }\n  }\n\n  return null;\n}\n\n/**\n * Format RA in decimal degrees to HMS string.\n */\nexport function formatRAtoHMS(ra: number): string {\n  const totalHours = ra / 15;\n  const hours = Math.floor(totalHours);\n  const remainingMinutes = (totalHours - hours) * 60;\n  const minutes = Math.floor(remainingMinutes);\n  const seconds = (remainingMinutes - minutes) * 60;\n\n  return `${hours.toString().padStart(2, \"0\")}:${minutes.toString().padStart(2, \"0\")}:${seconds\n    .toFixed(2)\n    .padStart(5, \"0\")}`;\n}\n\n/** Alias for formatRAtoHMS */\nexport const formatRA = formatRAtoHMS;\n\n/**\n * Format Dec in decimal degrees to DMS string.\n */\nexport function formatDectoDMS(dec: number): string {\n  const sign = dec >= 0 ? \"+\" : \"-\";\n  const absDec = Math.abs(dec);\n  const degrees = Math.floor(absDec);\n  const remainingMinutes = (absDec - degrees) * 60;\n  const minutes = Math.floor(remainingMinutes);\n  const seconds = (remainingMinutes - minutes) * 60;\n\n  return `${sign}${degrees.toString().padStart(2, \"0\")}:${minutes\n    .toString()\n    .padStart(2, \"0\")}:${seconds.toFixed(1).padStart(4, \"0\")}`;\n}\n\n/** Alias for formatDectoDMS */\nexport const formatDec = formatDectoDMS;\n\n/**\n * Parse a coordinate pair string (RA and Dec together).\n * Accepts formats like:\n * - \"180.0, 45.5\"\n * - \"12:00:00, +45:30:00\"\n * - \"12:00:00 +45:30:00\"\n */\nexport function parseCoordinatePair(input: string): { ra: number; dec: number } | null {\n  if (!input || typeof input !== \"string\") return null;\n\n  const trimmed = input.trim();\n  if (!trimmed) return null;\n\n  // Try comma-separated\n  if (trimmed.includes(\",\")) {\n    const parts = trimmed.split(\",\").map((s) => s.trim());\n    if (parts.length === 2) {\n      const ra = parseRA(parts[0]);\n      const dec = parseDec(parts[1]);\n      if (ra !== null && dec !== null) {\n        return { ra, dec };\n      }\n    }\n  }\n\n  // Try space-separated (look for sign in second part)\n  const signMatch = trimmed.match(/^(.+?)\\s+([+-]?\\d.*)$/);\n  if (signMatch) {\n    const ra = parseRA(signMatch[1].trim());\n    const dec = parseDec(signMatch[2].trim());\n    if (ra !== null && dec !== null) {\n      return { ra, dec };\n    }\n  }\n\n  return null;\n}\n\n/**\n * Validate coordinates are in valid range.\n */\nexport function validateCoordinates(\n  ra: number | null,\n  dec: number | null\n): {\n  valid: boolean;\n  raError?: string;\n  decError?: string;\n} {\n  const result: { valid: boolean; raError?: string; decError?: string } = { valid: true };\n\n  if (ra !== null) {\n    if (ra < 0 || ra >= 360) {\n      result.valid = false;\n      result.raError = \"RA must be between 0 and 360 degrees\";\n    }\n  }\n\n  if (dec !== null) {\n    if (dec < -90 || dec > 90) {\n      result.valid = false;\n      result.decError = \"Dec must be between -90 and 90 degrees\";\n    }\n  }\n\n  return result;\n}\n","import React, { useState, useCallback, useMemo, useEffect } from \"react\";\nimport SesameResolver from \"./SesameResolver\";\nimport FluxFilters from \"./FluxFilters\";\nimport VariabilityFilters from \"./VariabilityFilters\";\nimport TagFilter from \"./TagFilter\";\nimport { parseRA, parseDec } from \"../../utils/coordinateParser\";\n\nexport interface SourceQueryParams {\n  // Cone search\n  ra?: number;\n  dec?: number;\n  radius?: number;\n  radiusUnit: \"arcsec\" | \"arcmin\" | \"deg\";\n  coordFrame: \"icrs\" | \"galactic\";\n\n  // Flux filters\n  minFlux?: { min?: number; max?: number; type: \"peak\" | \"int\" };\n  maxFlux?: { min?: number; max?: number; type: \"peak\" | \"int\" };\n  avgFlux?: { min?: number; max?: number; type: \"peak\" | \"int\" };\n\n  // Variability\n  eta?: { min?: number; max?: number; type: \"peak\" | \"int\" };\n  v?: { min?: number; max?: number; type: \"peak\" | \"int\" };\n  vs?: { min?: number; max?: number; type: \"peak\" | \"int\" };\n  m?: { min?: number; max?: number; type: \"peak\" | \"int\" };\n\n  // SNR\n  snrMin?: { min?: number; max?: number };\n  snrMax?: { min?: number; max?: number };\n\n  // Counts\n  datapoints?: { min?: number; max?: number };\n  selavy?: { min?: number; max?: number };\n  forced?: { min?: number; max?: number };\n\n  // Flags\n  newSource?: boolean;\n  noSiblings?: boolean;\n\n  // Tags\n  includeTags: string[];\n  excludeTags: string[];\n\n  // Pipeline run\n  runName?: string;\n}\n\nexport interface AdvancedQueryPanelProps {\n  /** Available pipeline runs */\n  runs?: { id: string; name: string }[];\n  /** Available tags for filtering */\n  availableTags?: string[];\n  /** Callback when query is submitted */\n  onSubmit: (params: SourceQueryParams) => void;\n  /** Callback when query is reset */\n  onReset?: () => void;\n  /** Initial query params (e.g., from URL) */\n  initialParams?: Partial<SourceQueryParams>;\n  /** Custom class name */\n  className?: string;\n}\n\nconst DEFAULT_PARAMS: SourceQueryParams = {\n  radiusUnit: \"arcmin\",\n  coordFrame: \"icrs\",\n  includeTags: [],\n  excludeTags: [],\n};\n\n/**\n * Advanced source query panel with collapsible sections.\n * Inspired by VAST pipeline sources_query.html.\n */\nconst AdvancedQueryPanel: React.FC<AdvancedQueryPanelProps> = ({\n  runs = [],\n  availableTags = [],\n  onSubmit,\n  onReset,\n  initialParams,\n  className = \"\",\n}) => {\n  const [params, setParams] = useState<SourceQueryParams>({\n    ...DEFAULT_PARAMS,\n    ...initialParams,\n  });\n  const [expandedSections, setExpandedSections] = useState<Set<string>>(\n    new Set([\"cone\", \"filters\"])\n  );\n  const [validationErrors, setValidationErrors] = useState<Record<string, string>>({});\n  const [raInput, setRaInput] = useState<string>(initialParams?.ra?.toString() ?? \"\");\n  const [decInput, setDecInput] = useState<string>(initialParams?.dec?.toString() ?? \"\");\n  const debounceTimeoutRef = React.useRef<ReturnType<typeof setTimeout> | null>(null);\n\n  // Parse URL hash into params\n  const parseUrlHash = useCallback((): Partial<SourceQueryParams> => {\n    const hash = window.location.hash.slice(1);\n    if (!hash) return {};\n\n    const urlParams: Partial<SourceQueryParams> = {};\n    hash.split(\"&\").forEach((param) => {\n      const [key, value] = param.split(\"=\");\n      if (!key || !value) return;\n\n      const decoded = decodeURIComponent(value);\n      switch (key) {\n        case \"ra\":\n          urlParams.ra = parseFloat(decoded);\n          break;\n        case \"dec\":\n          urlParams.dec = parseFloat(decoded);\n          break;\n        case \"radius\":\n          urlParams.radius = parseFloat(decoded);\n          break;\n        case \"radius_unit\":\n          if ([\"arcsec\", \"arcmin\", \"deg\"].includes(decoded)) {\n            urlParams.radiusUnit = decoded as \"arcsec\" | \"arcmin\" | \"deg\";\n          }\n          break;\n        case \"coord_frame\":\n          if ([\"icrs\", \"galactic\"].includes(decoded)) {\n            urlParams.coordFrame = decoded as \"icrs\" | \"galactic\";\n          }\n          break;\n        case \"new_source\":\n          urlParams.newSource = decoded === \"true\";\n          break;\n        case \"no_siblings\":\n          urlParams.noSiblings = decoded === \"true\";\n          break;\n        case \"run_name\":\n          urlParams.runName = decoded;\n          break;\n        case \"include_tags\":\n          urlParams.includeTags = decoded.split(\",\").filter(Boolean);\n          break;\n        case \"exclude_tags\":\n          urlParams.excludeTags = decoded.split(\",\").filter(Boolean);\n          break;\n        // Flux filters\n        case \"min_flux_min\":\n          urlParams.minFlux = { ...urlParams.minFlux, min: parseFloat(decoded), type: \"peak\" };\n          break;\n        case \"min_flux_max\":\n          urlParams.minFlux = { ...urlParams.minFlux, max: parseFloat(decoded), type: \"peak\" };\n          break;\n        case \"max_flux_min\":\n          urlParams.maxFlux = { ...urlParams.maxFlux, min: parseFloat(decoded), type: \"peak\" };\n          break;\n        case \"max_flux_max\":\n          urlParams.maxFlux = { ...urlParams.maxFlux, max: parseFloat(decoded), type: \"peak\" };\n          break;\n        // Variability filters\n        case \"eta_min\":\n          urlParams.eta = { ...urlParams.eta, min: parseFloat(decoded), type: \"peak\" };\n          break;\n        case \"eta_max\":\n          urlParams.eta = { ...urlParams.eta, max: parseFloat(decoded), type: \"peak\" };\n          break;\n        case \"v_min\":\n          urlParams.v = { ...urlParams.v, min: parseFloat(decoded), type: \"peak\" };\n          break;\n        case \"v_max\":\n          urlParams.v = { ...urlParams.v, max: parseFloat(decoded), type: \"peak\" };\n          break;\n      }\n    });\n    return urlParams;\n  }, []);\n\n  // Write params to URL hash\n  const writeUrlHash = useCallback((params: SourceQueryParams) => {\n    const parts: string[] = [];\n\n    if (params.ra != null) parts.push(`ra=${params.ra.toFixed(6)}`);\n    if (params.dec != null) parts.push(`dec=${params.dec.toFixed(6)}`);\n    if (params.radius != null) parts.push(`radius=${params.radius}`);\n    if (params.radiusUnit !== DEFAULT_PARAMS.radiusUnit) {\n      parts.push(`radius_unit=${params.radiusUnit}`);\n    }\n    if (params.coordFrame !== DEFAULT_PARAMS.coordFrame) {\n      parts.push(`coord_frame=${params.coordFrame}`);\n    }\n    if (params.newSource) parts.push(\"new_source=true\");\n    if (params.noSiblings) parts.push(\"no_siblings=true\");\n    if (params.runName) parts.push(`run_name=${encodeURIComponent(params.runName)}`);\n    if (params.includeTags.length > 0) {\n      parts.push(`include_tags=${params.includeTags.map(encodeURIComponent).join(\",\")}`);\n    }\n    if (params.excludeTags.length > 0) {\n      parts.push(`exclude_tags=${params.excludeTags.map(encodeURIComponent).join(\",\")}`);\n    }\n    // Flux filters\n    if (params.minFlux?.min != null) parts.push(`min_flux_min=${params.minFlux.min}`);\n    if (params.minFlux?.max != null) parts.push(`min_flux_max=${params.minFlux.max}`);\n    if (params.maxFlux?.min != null) parts.push(`max_flux_min=${params.maxFlux.min}`);\n    if (params.maxFlux?.max != null) parts.push(`max_flux_max=${params.maxFlux.max}`);\n    // Variability filters\n    if (params.eta?.min != null) parts.push(`eta_min=${params.eta.min}`);\n    if (params.eta?.max != null) parts.push(`eta_max=${params.eta.max}`);\n    if (params.v?.min != null) parts.push(`v_min=${params.v.min}`);\n    if (params.v?.max != null) parts.push(`v_max=${params.v.max}`);\n\n    const newHash = parts.length > 0 ? `#${parts.join(\"&\")}` : \"\";\n    if (window.location.hash !== newHash) {\n      window.history.replaceState(null, \"\", newHash || window.location.pathname);\n    }\n  }, []);\n\n  // Validate params\n  const validateParams = useCallback((params: SourceQueryParams): Record<string, string> => {\n    const errors: Record<string, string> = {};\n\n    // Coordinate validation\n    if (params.ra != null && (params.ra < 0 || params.ra > 360)) {\n      errors.ra = \"RA must be between 0 and 360 degrees\";\n    }\n    if (params.dec != null && (params.dec < -90 || params.dec > 90)) {\n      errors.dec = \"Dec must be between -90 and 90 degrees\";\n    }\n    if (params.radius != null && params.radius < 0) {\n      errors.radius = \"Radius must be non-negative\";\n    }\n\n    // Cone search completeness\n    if (\n      (params.ra != null || params.dec != null || params.radius != null) &&\n      (params.ra == null || params.dec == null || params.radius == null)\n    ) {\n      if (params.ra == null) errors.ra = \"RA required for cone search\";\n      if (params.dec == null) errors.dec = \"Dec required for cone search\";\n      if (params.radius == null) errors.radius = \"Radius required for cone search\";\n    }\n\n    return errors;\n  }, []);\n\n  // Load from URL hash on mount\n  useEffect(() => {\n    const urlParams = parseUrlHash();\n    if (Object.keys(urlParams).length > 0) {\n      setParams((prev) => ({ ...prev, ...urlParams }));\n    }\n  }, [parseUrlHash]);\n\n  // Debounced URL sync when params change\n  useEffect(() => {\n    if (debounceTimeoutRef.current) {\n      window.clearTimeout(debounceTimeoutRef.current);\n    }\n    debounceTimeoutRef.current = window.setTimeout(() => {\n      writeUrlHash(params);\n      setValidationErrors(validateParams(params));\n    }, 500);\n\n    return () => {\n      if (debounceTimeoutRef.current) {\n        window.clearTimeout(debounceTimeoutRef.current);\n      }\n    };\n  }, [params, writeUrlHash, validateParams]);\n\n  const toggleSection = useCallback((section: string) => {\n    setExpandedSections((prev) => {\n      const next = new Set(prev);\n      if (next.has(section)) {\n        next.delete(section);\n      } else {\n        next.add(section);\n      }\n      return next;\n    });\n  }, []);\n\n  const handleConeSearchResolved = useCallback((ra: number, dec: number) => {\n    setParams((prev) => ({ ...prev, ra, dec }));\n    setRaInput(ra.toFixed(6));\n    setDecInput(dec.toFixed(6));\n  }, []);\n\n  const handleReset = useCallback(() => {\n    setParams({ ...DEFAULT_PARAMS });\n    setValidationErrors({});\n    setRaInput(\"\");\n    setDecInput(\"\");\n    window.history.replaceState(null, \"\", window.location.pathname);\n    onReset?.();\n  }, [onReset]);\n\n  const handleSubmit = useCallback(() => {\n    const errors = validateParams(params);\n    setValidationErrors(errors);\n    if (Object.keys(errors).length === 0) {\n      onSubmit(params);\n    }\n  }, [params, onSubmit, validateParams]);\n\n  // Count active filters for badge\n  const activeFilterCount = useMemo(() => {\n    let count = 0;\n    if (params.ra != null && params.dec != null) count++;\n    if (params.minFlux?.min != null || params.minFlux?.max != null) count++;\n    if (params.maxFlux?.min != null || params.maxFlux?.max != null) count++;\n    if (params.avgFlux?.min != null || params.avgFlux?.max != null) count++;\n    if (params.eta?.min != null || params.eta?.max != null) count++;\n    if (params.v?.min != null || params.v?.max != null) count++;\n    if (params.snrMin?.min != null || params.snrMin?.max != null) count++;\n    if (params.snrMax?.min != null || params.snrMax?.max != null) count++;\n    if (params.datapoints?.min != null || params.datapoints?.max != null) count++;\n    if (params.newSource) count++;\n    if (params.noSiblings) count++;\n    if (params.includeTags.length > 0) count++;\n    if (params.excludeTags.length > 0) count++;\n    if (params.runName) count++;\n    return count;\n  }, [params]);\n\n  const hasValidationErrors = Object.keys(validationErrors).length > 0;\n\n  const renderSection = (id: string, title: string, children: React.ReactNode) => {\n    const isExpanded = expandedSections.has(id);\n    return (\n      <div className=\"border-b border-gray-200\">\n        <button\n          onClick={() => toggleSection(id)}\n          className=\"w-full flex items-center justify-between px-4 py-3 bg-gray-50 hover:bg-gray-100 transition-colors\"\n        >\n          <span className=\"font-semibold text-gray-700\">{title}</span>\n          <svg\n            className={`w-5 h-5 text-gray-500 transition-transform ${\n              isExpanded ? \"rotate-180\" : \"\"\n            }`}\n            fill=\"none\"\n            stroke=\"currentColor\"\n            viewBox=\"0 0 24 24\"\n          >\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 9l-7 7-7-7\" />\n          </svg>\n        </button>\n        {isExpanded && <div className=\"p-4 space-y-4\">{children}</div>}\n      </div>\n    );\n  };\n\n  return (\n    <div className={`card ${className}`}>\n      <div className=\"card-header flex items-center justify-between\">\n        <h4 className=\"text-lg font-semibold flex items-center gap-2\">\n          Source Query\n          {activeFilterCount > 0 && (\n            <span className=\"badge badge-primary\">{activeFilterCount} filters</span>\n          )}\n        </h4>\n        <button onClick={handleReset} className=\"text-sm text-gray-500 hover:text-red-500\">\n          Reset all\n        </button>\n      </div>\n\n      <div className=\"divide-y divide-gray-200\">\n        {/* Data Source */}\n        {renderSection(\n          \"source\",\n          \"Data Source\",\n          <div className=\"form-group\">\n            <label className=\"form-label\">Pipeline Run</label>\n            <select\n              value={params.runName || \"\"}\n              onChange={(e) =>\n                setParams((prev) => ({ ...prev, runName: e.target.value || undefined }))\n              }\n              className=\"form-select w-full\"\n            >\n              <option value=\"\">All Runs</option>\n              {runs.map((run) => (\n                <option key={run.id} value={run.name}>\n                  {run.name}\n                </option>\n              ))}\n            </select>\n          </div>\n        )}\n\n        {/* Cone Search */}\n        {renderSection(\n          \"cone\",\n          \"Cone Search\",\n          <>\n            <SesameResolver onResolved={handleConeSearchResolved} />\n\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div className=\"form-group\">\n                <label className=\"form-label\">RA (deg or HMS)</label>\n                <input\n                  type=\"text\"\n                  value={raInput}\n                  onChange={(e) => {\n                    const value = e.target.value;\n                    setRaInput(value);\n                    // Try to parse and update params\n                    const parsed = parseRA(value);\n                    setParams((prev) => ({\n                      ...prev,\n                      ra: parsed ?? undefined,\n                    }));\n                  }}\n                  onBlur={() => {\n                    // On blur, normalize to decimal if valid\n                    if (params.ra != null) {\n                      setRaInput(params.ra.toFixed(6));\n                    }\n                  }}\n                  placeholder=\"180.0 or 12:00:00\"\n                  className={`form-control ${validationErrors.ra ? \"border-red-500\" : \"\"}`}\n                />\n                {validationErrors.ra && (\n                  <p className=\"text-xs text-red-500 mt-1\">{validationErrors.ra}</p>\n                )}\n              </div>\n              <div className=\"form-group\">\n                <label className=\"form-label\">Dec (deg or DMS)</label>\n                <input\n                  type=\"text\"\n                  value={decInput}\n                  onChange={(e) => {\n                    const value = e.target.value;\n                    setDecInput(value);\n                    // Try to parse and update params\n                    const parsed = parseDec(value);\n                    setParams((prev) => ({\n                      ...prev,\n                      dec: parsed ?? undefined,\n                    }));\n                  }}\n                  onBlur={() => {\n                    // On blur, normalize to decimal if valid\n                    if (params.dec != null) {\n                      setDecInput(params.dec.toFixed(6));\n                    }\n                  }}\n                  placeholder=\"+45.0 or +45:00:00\"\n                  className={`form-control ${validationErrors.dec ? \"border-red-500\" : \"\"}`}\n                />\n                {validationErrors.dec && (\n                  <p className=\"text-xs text-red-500 mt-1\">{validationErrors.dec}</p>\n                )}\n              </div>\n            </div>\n\n            <div className=\"grid grid-cols-3 gap-4\">\n              <div className=\"form-group\">\n                <label className=\"form-label\">Radius</label>\n                <input\n                  type=\"number\"\n                  value={params.radius ?? \"\"}\n                  onChange={(e) =>\n                    setParams((prev) => ({\n                      ...prev,\n                      radius: e.target.value ? parseFloat(e.target.value) : undefined,\n                    }))\n                  }\n                  placeholder=\"2\"\n                  min={0}\n                  step={0.1}\n                  className={`form-control ${validationErrors.radius ? \"border-red-500\" : \"\"}`}\n                />\n                {validationErrors.radius && (\n                  <p className=\"text-xs text-red-500 mt-1\">{validationErrors.radius}</p>\n                )}\n              </div>\n              <div className=\"form-group\">\n                <label className=\"form-label\">Unit</label>\n                <select\n                  value={params.radiusUnit}\n                  onChange={(e) =>\n                    setParams((prev) => ({\n                      ...prev,\n                      radiusUnit: e.target.value as \"arcsec\" | \"arcmin\" | \"deg\",\n                    }))\n                  }\n                  className=\"form-select\"\n                >\n                  <option value=\"arcsec\">arcsec</option>\n                  <option value=\"arcmin\">arcmin</option>\n                  <option value=\"deg\">deg</option>\n                </select>\n              </div>\n              <div className=\"form-group\">\n                <label className=\"form-label\">Frame</label>\n                <select\n                  value={params.coordFrame}\n                  onChange={(e) =>\n                    setParams((prev) => ({\n                      ...prev,\n                      coordFrame: e.target.value as \"icrs\" | \"galactic\",\n                    }))\n                  }\n                  className=\"form-select\"\n                >\n                  <option value=\"icrs\">ICRS</option>\n                  <option value=\"galactic\">Galactic</option>\n                </select>\n              </div>\n            </div>\n          </>\n        )}\n\n        {/* Flux Filters */}\n        {renderSection(\n          \"flux\",\n          \"Flux Filters\",\n          <FluxFilters\n            values={{\n              minFlux: params.minFlux,\n              maxFlux: params.maxFlux,\n              avgFlux: params.avgFlux,\n            }}\n            onChange={(fluxValues) => setParams((prev) => ({ ...prev, ...fluxValues }))}\n          />\n        )}\n\n        {/* Variability Filters */}\n        {renderSection(\n          \"variability\",\n          \"Variability Metrics\",\n          <VariabilityFilters\n            values={{\n              eta: params.eta,\n              v: params.v,\n              vs: params.vs,\n              m: params.m,\n            }}\n            onChange={(varValues) => setParams((prev) => ({ ...prev, ...varValues }))}\n          />\n        )}\n\n        {/* SNR & Counts */}\n        {renderSection(\n          \"snr\",\n          \"SNR & Data Counts\",\n          <div className=\"space-y-4\">\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div className=\"form-group\">\n                <label className=\"form-label\">Min SNR</label>\n                <div className=\"grid grid-cols-2 gap-2\">\n                  <input\n                    type=\"number\"\n                    value={params.snrMin?.min ?? \"\"}\n                    onChange={(e) =>\n                      setParams((prev) => ({\n                        ...prev,\n                        snrMin: {\n                          ...prev.snrMin,\n                          min: e.target.value ? Number(e.target.value) : undefined,\n                        },\n                      }))\n                    }\n                    placeholder=\"Min\"\n                    className=\"form-control\"\n                  />\n                  <input\n                    type=\"number\"\n                    value={params.snrMin?.max ?? \"\"}\n                    onChange={(e) =>\n                      setParams((prev) => ({\n                        ...prev,\n                        snrMin: {\n                          ...prev.snrMin,\n                          max: e.target.value ? Number(e.target.value) : undefined,\n                        },\n                      }))\n                    }\n                    placeholder=\"Max\"\n                    className=\"form-control\"\n                  />\n                </div>\n              </div>\n              <div className=\"form-group\">\n                <label className=\"form-label\">Max SNR</label>\n                <div className=\"grid grid-cols-2 gap-2\">\n                  <input\n                    type=\"number\"\n                    value={params.snrMax?.min ?? \"\"}\n                    onChange={(e) =>\n                      setParams((prev) => ({\n                        ...prev,\n                        snrMax: {\n                          ...prev.snrMax,\n                          min: e.target.value ? Number(e.target.value) : undefined,\n                        },\n                      }))\n                    }\n                    placeholder=\"Min\"\n                    className=\"form-control\"\n                  />\n                  <input\n                    type=\"number\"\n                    value={params.snrMax?.max ?? \"\"}\n                    onChange={(e) =>\n                      setParams((prev) => ({\n                        ...prev,\n                        snrMax: {\n                          ...prev.snrMax,\n                          max: e.target.value ? Number(e.target.value) : undefined,\n                        },\n                      }))\n                    }\n                    placeholder=\"Max\"\n                    className=\"form-control\"\n                  />\n                </div>\n              </div>\n            </div>\n\n            <div className=\"form-group\">\n              <label className=\"form-label\">Datapoints</label>\n              <div className=\"grid grid-cols-2 gap-2\">\n                <input\n                  type=\"number\"\n                  value={params.datapoints?.min ?? \"\"}\n                  onChange={(e) =>\n                    setParams((prev) => ({\n                      ...prev,\n                      datapoints: {\n                        ...prev.datapoints,\n                        min: e.target.value ? Number(e.target.value) : undefined,\n                      },\n                    }))\n                  }\n                  placeholder=\"Min\"\n                  min={1}\n                  className=\"form-control\"\n                />\n                <input\n                  type=\"number\"\n                  value={params.datapoints?.max ?? \"\"}\n                  onChange={(e) =>\n                    setParams((prev) => ({\n                      ...prev,\n                      datapoints: {\n                        ...prev.datapoints,\n                        max: e.target.value ? Number(e.target.value) : undefined,\n                      },\n                    }))\n                  }\n                  placeholder=\"Max\"\n                  min={1}\n                  className=\"form-control\"\n                />\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* Source Type Flags */}\n        {renderSection(\n          \"flags\",\n          \"Source Type\",\n          <div className=\"space-y-3\">\n            <label className=\"flex items-center gap-2 cursor-pointer\">\n              <input\n                type=\"checkbox\"\n                checked={params.newSource || false}\n                onChange={(e) => setParams((prev) => ({ ...prev, newSource: e.target.checked }))}\n                className=\"w-4 h-4 text-vast-green rounded\"\n              />\n              <span>New source</span>\n              <span className=\"text-gray-400 text-sm\">(appeared after first observation)</span>\n            </label>\n            <label className=\"flex items-center gap-2 cursor-pointer\">\n              <input\n                type=\"checkbox\"\n                checked={params.noSiblings || false}\n                onChange={(e) => setParams((prev) => ({ ...prev, noSiblings: e.target.checked }))}\n                className=\"w-4 h-4 text-vast-green rounded\"\n              />\n              <span>No siblings</span>\n              <span className=\"text-gray-400 text-sm\">(no multi-component islands)</span>\n            </label>\n          </div>\n        )}\n\n        {/* Tags */}\n        {renderSection(\n          \"tags\",\n          \"Tags\",\n          <TagFilter\n            availableTags={availableTags}\n            includeTags={params.includeTags}\n            excludeTags={params.excludeTags}\n            onIncludeChange={(tags) => setParams((prev) => ({ ...prev, includeTags: tags }))}\n            onExcludeChange={(tags) => setParams((prev) => ({ ...prev, excludeTags: tags }))}\n          />\n        )}\n      </div>\n\n      {/* Validation Errors */}\n      {hasValidationErrors && (\n        <div className=\"px-4 py-2 bg-red-50 border-t border-red-200\">\n          <ul className=\"text-sm text-red-600 list-disc list-inside\">\n            {Object.entries(validationErrors).map(([field, error]) => (\n              <li key={field}>{error}</li>\n            ))}\n          </ul>\n        </div>\n      )}\n\n      {/* Action Buttons */}\n      <div className=\"p-4 bg-gray-50 border-t border-gray-200 flex justify-end gap-2\">\n        <button onClick={handleReset} className=\"btn btn-secondary\">\n          Reset\n        </button>\n        <button\n          onClick={handleSubmit}\n          className={`btn btn-primary ${hasValidationErrors ? \"opacity-75\" : \"\"}`}\n          disabled={hasValidationErrors}\n        >\n          Search\n        </button>\n      </div>\n    </div>\n  );\n};\n\nexport default AdvancedQueryPanel;\n","import React from \"react\";\n\nexport interface VariabilityControlsProps {\n  /** Current η threshold */\n  etaThreshold: number;\n  /** Current V threshold */\n  vThreshold: number;\n  /** η sigma multiplier for dynamic threshold */\n  etaSigma: number;\n  /** V sigma multiplier for dynamic threshold */\n  vSigma: number;\n  /** Whether to use sigma-based thresholds */\n  useSigmaThreshold: boolean;\n  /** Min number of data points filter */\n  minDataPoints: number;\n  /** Color by field */\n  colorBy: \"variability\" | \"flux\" | \"measurements\" | \"none\";\n  /** Change handler */\n  onChange: (values: Partial<VariabilityControlsValues>) => void;\n}\n\nexport interface VariabilityControlsValues {\n  etaThreshold: number;\n  vThreshold: number;\n  etaSigma: number;\n  vSigma: number;\n  useSigmaThreshold: boolean;\n  minDataPoints: number;\n  colorBy: \"variability\" | \"flux\" | \"measurements\" | \"none\";\n}\n\n/**\n * Controls panel for η-V plot customization.\n */\nconst VariabilityControls: React.FC<VariabilityControlsProps> = ({\n  etaThreshold,\n  vThreshold,\n  etaSigma,\n  vSigma,\n  useSigmaThreshold,\n  minDataPoints,\n  colorBy,\n  onChange,\n}) => {\n  return (\n    <div className=\"bg-white border border-gray-200 rounded-lg p-4 space-y-4\">\n      {/* Threshold mode toggle */}\n      <div>\n        <label className=\"flex items-center gap-2 cursor-pointer\">\n          <input\n            type=\"checkbox\"\n            checked={useSigmaThreshold}\n            onChange={(e) => onChange({ useSigmaThreshold: e.target.checked })}\n            className=\"w-4 h-4 rounded\"\n          />\n          <span className=\"text-sm\">Use σ-based thresholds</span>\n        </label>\n        <p className=\"text-xs text-gray-500 mt-1\">\n          Calculate thresholds dynamically based on standard deviation\n        </p>\n      </div>\n\n      {/* Sigma sliders (when sigma mode enabled) */}\n      {useSigmaThreshold && (\n        <div className=\"space-y-3 pl-2 border-l-2 border-primary\">\n          <div>\n            <label className=\"flex items-center justify-between text-sm mb-1\">\n              <span>η threshold: {etaSigma}σ</span>\n              <span className=\"text-gray-500 text-xs\">above mean</span>\n            </label>\n            <input\n              type=\"range\"\n              min={1}\n              max={5}\n              step={0.5}\n              value={etaSigma}\n              onChange={(e) => onChange({ etaSigma: parseFloat(e.target.value) })}\n              className=\"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-primary\"\n            />\n          </div>\n          <div>\n            <label className=\"flex items-center justify-between text-sm mb-1\">\n              <span>V threshold: {vSigma}σ</span>\n              <span className=\"text-gray-500 text-xs\">above mean</span>\n            </label>\n            <input\n              type=\"range\"\n              min={1}\n              max={5}\n              step={0.5}\n              value={vSigma}\n              onChange={(e) => onChange({ vSigma: parseFloat(e.target.value) })}\n              className=\"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-primary\"\n            />\n          </div>\n        </div>\n      )}\n\n      {/* Fixed threshold inputs (when sigma mode disabled) */}\n      {!useSigmaThreshold && (\n        <div className=\"grid grid-cols-2 gap-3\">\n          <div>\n            <label className=\"block text-sm mb-1\">η threshold</label>\n            <input\n              type=\"number\"\n              value={etaThreshold}\n              onChange={(e) => onChange({ etaThreshold: parseFloat(e.target.value) || 0 })}\n              step={0.1}\n              className=\"w-full px-2 py-1 border border-gray-300 rounded text-sm\"\n            />\n          </div>\n          <div>\n            <label className=\"block text-sm mb-1\">V threshold</label>\n            <input\n              type=\"number\"\n              value={vThreshold}\n              onChange={(e) => onChange({ vThreshold: parseFloat(e.target.value) || 0 })}\n              step={0.01}\n              className=\"w-full px-2 py-1 border border-gray-300 rounded text-sm\"\n            />\n          </div>\n        </div>\n      )}\n\n      {/* Min data points filter */}\n      <div>\n        <label className=\"block text-sm mb-1\">Min data points: {minDataPoints}</label>\n        <input\n          type=\"range\"\n          min={2}\n          max={20}\n          value={minDataPoints}\n          onChange={(e) => onChange({ minDataPoints: parseInt(e.target.value, 10) })}\n          className=\"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-primary\"\n        />\n        <div className=\"flex justify-between text-xs text-gray-400\">\n          <span>2</span>\n          <span>20</span>\n        </div>\n      </div>\n\n      {/* Color by selector */}\n      <div>\n        <label className=\"block text-sm mb-1\">Color by</label>\n        <select\n          value={colorBy}\n          onChange={(e) =>\n            onChange({\n              colorBy: e.target.value as VariabilityControlsValues[\"colorBy\"],\n            })\n          }\n          className=\"w-full px-2 py-1 border border-gray-300 rounded text-sm\"\n        >\n          <option value=\"variability\">Variability (η × V)</option>\n          <option value=\"flux\">Peak Flux</option>\n          <option value=\"measurements\">N Measurements</option>\n          <option value=\"none\">No color gradient</option>\n        </select>\n      </div>\n    </div>\n  );\n};\n\nexport default VariabilityControls;\n","import React from \"react\";\n\nexport interface SourcePreviewProps {\n  /** Source identifier */\n  sourceId: string;\n  /** Source name */\n  name: string;\n  /** RA coordinate (degrees) */\n  ra: number;\n  /** Dec coordinate (degrees) */\n  dec: number;\n  /** η value */\n  eta: number;\n  /** V value */\n  v: number;\n  /** Peak flux in mJy */\n  peakFlux?: number;\n  /** Number of measurements */\n  nMeasurements?: number;\n  /** Position for tooltip (screen coordinates) */\n  position?: { x: number; y: number };\n  /** Whether this is a hover preview or selected */\n  isHover?: boolean;\n  /** Click handler */\n  onNavigate?: (sourceId: string) => void;\n  /** Close handler */\n  onClose?: () => void;\n}\n\n/**\n * Quick preview tooltip/card for source on η-V plot.\n */\nconst SourcePreview: React.FC<SourcePreviewProps> = ({\n  sourceId,\n  name,\n  ra,\n  dec,\n  eta,\n  v,\n  peakFlux,\n  nMeasurements,\n  position,\n  isHover = true,\n  onNavigate,\n  onClose,\n}) => {\n  const formatCoord = (value: number, isRa: boolean) => {\n    if (isRa) {\n      const hours = value / 15;\n      const h = Math.floor(hours);\n      const m = Math.floor((hours - h) * 60);\n      const s = ((hours - h - m / 60) * 3600).toFixed(2);\n      return `${h}h ${m}m ${s}s`;\n    } else {\n      const sign = value >= 0 ? \"+\" : \"\";\n      const d = Math.floor(Math.abs(value));\n      const m = Math.floor((Math.abs(value) - d) * 60);\n      const s = ((Math.abs(value) - d - m / 60) * 3600).toFixed(1);\n      return `${sign}${d}° ${m}' ${s}\"`;\n    }\n  };\n\n  const style: React.CSSProperties = position\n    ? {\n        position: \"absolute\",\n        left: position.x + 10,\n        top: position.y + 10,\n        zIndex: 1000,\n      }\n    : {};\n\n  return (\n    <div\n      className={`bg-white border border-gray-200 rounded-lg shadow-lg p-3 ${\n        isHover ? \"min-w-48\" : \"min-w-64\"\n      }`}\n      style={style}\n    >\n      {/* Header */}\n      <div className=\"flex items-center justify-between mb-2\">\n        <span className=\"font-semibold text-sm text-gray-800 truncate\">{name || sourceId}</span>\n        {!isHover && onClose && (\n          <button\n            onClick={onClose}\n            className=\"text-gray-400 hover:text-gray-600 text-lg leading-none\"\n          >\n            ×\n          </button>\n        )}\n      </div>\n\n      {/* Coordinates */}\n      <div className=\"text-xs text-gray-500 mb-2\">\n        <div>RA: {formatCoord(ra, true)}</div>\n        <div>Dec: {formatCoord(dec, false)}</div>\n      </div>\n\n      {/* Variability metrics */}\n      <div className=\"flex gap-4 mb-2\">\n        <div className=\"text-center\">\n          <div className=\"text-lg font-semibold text-primary\">{eta.toFixed(2)}</div>\n          <div className=\"text-xs text-gray-500\">η</div>\n        </div>\n        <div className=\"text-center\">\n          <div className=\"text-lg font-semibold text-primary\">{v.toFixed(3)}</div>\n          <div className=\"text-xs text-gray-500\">V</div>\n        </div>\n        {peakFlux !== undefined && (\n          <div className=\"text-center\">\n            <div className=\"text-lg font-semibold text-gray-700\">{peakFlux.toFixed(2)}</div>\n            <div className=\"text-xs text-gray-500\">mJy</div>\n          </div>\n        )}\n        {nMeasurements !== undefined && (\n          <div className=\"text-center\">\n            <div className=\"text-lg font-semibold text-gray-700\">{nMeasurements}</div>\n            <div className=\"text-xs text-gray-500\">pts</div>\n          </div>\n        )}\n      </div>\n\n      {/* Action button */}\n      {!isHover && onNavigate && (\n        <button\n          onClick={() => onNavigate(sourceId)}\n          className=\"w-full text-sm bg-primary text-white py-1.5 rounded hover:bg-primary-dark transition-colors\"\n        >\n          View Source Details\n        </button>\n      )}\n    </div>\n  );\n};\n\nexport default SourcePreview;\n","import React, { useEffect, useRef, useState, useCallback, useMemo } from \"react\";\nimport * as echarts from \"echarts\";\nimport VariabilityControls, { VariabilityControlsValues } from \"./VariabilityControls\";\nimport SourcePreview from \"./SourcePreview\";\n\nexport interface SourcePoint {\n  id: string;\n  name: string;\n  ra: number;\n  dec: number;\n  eta: number;\n  v: number;\n  peakFlux?: number;\n  nMeasurements?: number;\n}\n\nexport interface EtaVPlotProps {\n  /** Source data to plot */\n  sources: SourcePoint[];\n  /** Whether data is loading */\n  isLoading?: boolean;\n  /** Callback when source is selected */\n  onSourceSelect?: (sourceId: string) => void;\n  /** Height of the chart */\n  height?: number;\n  /** Custom class name */\n  className?: string;\n}\n\n/**\n * η-V variability scatter plot using ECharts.\n * Highlights potential transient candidates above thresholds.\n */\nconst EtaVPlot: React.FC<EtaVPlotProps> = ({\n  sources,\n  isLoading = false,\n  onSourceSelect,\n  height = 500,\n  className = \"\",\n}) => {\n  const chartRef = useRef<HTMLDivElement>(null);\n  const chartInstance = useRef<echarts.ECharts | null>(null);\n\n  // Control state\n  const [controls, setControls] = useState<VariabilityControlsValues>({\n    etaThreshold: 1.5,\n    vThreshold: 0.1,\n    etaSigma: 2,\n    vSigma: 2,\n    useSigmaThreshold: true,\n    minDataPoints: 3,\n    colorBy: \"variability\",\n  });\n\n  // Preview state\n  const [hoverSource, setHoverSource] = useState<SourcePoint | null>(null);\n  const [hoverPosition, setHoverPosition] = useState({ x: 0, y: 0 });\n  const [selectedSource, setSelectedSource] = useState<SourcePoint | null>(null);\n\n  // Escape key handler for modal\n  useEffect(() => {\n    const handleKeyDown = (e: KeyboardEvent) => {\n      if (e.key === \"Escape\" && selectedSource) {\n        setSelectedSource(null);\n      }\n    };\n    if (selectedSource) {\n      window.addEventListener(\"keydown\", handleKeyDown);\n      return () => window.removeEventListener(\"keydown\", handleKeyDown);\n    }\n  }, [selectedSource]);\n\n  // Calculate dynamic thresholds\n  const calculateThresholds = useCallback(() => {\n    if (!controls.useSigmaThreshold || sources.length === 0) {\n      return { etaLine: controls.etaThreshold, vLine: controls.vThreshold };\n    }\n\n    const etaValues = sources.map((s) => s.eta);\n    const vValues = sources.map((s) => s.v);\n\n    const mean = (arr: number[]) => arr.reduce((a, b) => a + b, 0) / arr.length;\n    const std = (arr: number[]) => {\n      const m = mean(arr);\n      return Math.sqrt(arr.reduce((sum, x) => sum + (x - m) ** 2, 0) / arr.length);\n    };\n\n    const etaMean = mean(etaValues);\n    const etaStd = std(etaValues);\n    const vMean = mean(vValues);\n    const vStd = std(vValues);\n\n    return {\n      etaLine: etaMean + controls.etaSigma * etaStd,\n      vLine: vMean + controls.vSigma * vStd,\n    };\n  }, [sources, controls]);\n\n  // Filter sources by min data points and ensure positive values for log scale\n  const filteredSources = useMemo(\n    () =>\n      sources.filter(\n        (s) => (s.nMeasurements ?? 10) >= controls.minDataPoints && s.eta > 0 && s.v > 0 // Filter out non-positive values for log scale\n      ),\n    [sources, controls.minDataPoints]\n  );\n\n  // Count filtered out sources\n  const filteredOutCount = sources.length - filteredSources.length;\n\n  // Identify candidates (above both thresholds)\n  const { etaLine, vLine } = calculateThresholds();\n  const candidates = useMemo(\n    () => filteredSources.filter((s) => s.eta > etaLine && s.v > vLine),\n    [filteredSources, etaLine, vLine]\n  );\n\n  // Pre-compute max values once to avoid O(n²) in color mapping\n  const colorMaxValues = useMemo(() => {\n    if (filteredSources.length === 0) return { variability: 1, flux: 1, measurements: 1 };\n    return {\n      variability: Math.max(...filteredSources.map((s) => s.eta * s.v), 1),\n      flux: Math.max(...filteredSources.map((s) => s.peakFlux ?? 0), 1),\n      measurements: Math.max(...filteredSources.map((s) => s.nMeasurements ?? 0), 1),\n    };\n  }, [filteredSources]);\n\n  // Color mapping function - now O(1) per point\n  const getPointColor = useCallback(\n    (source: SourcePoint, isCandidate: boolean) => {\n      if (isCandidate) return \"#ff0000\";\n      if (controls.colorBy === \"none\") return \"rgba(79, 195, 161, 0.6)\";\n\n      let value = 0;\n      let max = 1;\n\n      switch (controls.colorBy) {\n        case \"variability\":\n          value = source.eta * source.v;\n          max = colorMaxValues.variability;\n          break;\n        case \"flux\":\n          value = source.peakFlux ?? 0;\n          max = colorMaxValues.flux;\n          break;\n        case \"measurements\":\n          value = source.nMeasurements ?? 0;\n          max = colorMaxValues.measurements;\n          break;\n      }\n\n      const ratio = Math.min(value / max, 1);\n      // Gradient from green (#4fc3a1) to yellow (#f0c674)\n      const r = Math.round(79 + ratio * (240 - 79));\n      const g = Math.round(195 + ratio * (198 - 195));\n      const b = Math.round(161 - ratio * (161 - 116));\n      return `rgba(${r}, ${g}, ${b}, 0.7)`;\n    },\n    [controls.colorBy, colorMaxValues]\n  );\n\n  // Initialize chart\n  useEffect(() => {\n    if (!chartRef.current) return;\n\n    chartInstance.current = echarts.init(chartRef.current);\n\n    const handleResize = () => {\n      chartInstance.current?.resize();\n    };\n    window.addEventListener(\"resize\", handleResize);\n\n    return () => {\n      window.removeEventListener(\"resize\", handleResize);\n      chartInstance.current?.dispose();\n    };\n  }, []);\n\n  // Update chart\n  useEffect(() => {\n    if (!chartInstance.current || isLoading) return;\n\n    const candidateIds = new Set(candidates.map((c) => c.id));\n\n    // Prepare scatter data\n    const scatterData = filteredSources.map((source) => ({\n      value: [source.eta, source.v],\n      itemStyle: {\n        color: getPointColor(source, candidateIds.has(source.id)),\n      },\n      symbolSize: candidateIds.has(source.id) ? 10 : 6,\n      source,\n    }));\n\n    // Compute data bounds for threshold lines (log scale doesn't support \"min\"/\"max\")\n    const etaValues = filteredSources.map((s) => s.eta);\n    const vValues = filteredSources.map((s) => s.v);\n    const etaMin = Math.min(...etaValues) * 0.5;\n    const etaMax = Math.max(...etaValues) * 2;\n    const vMin = Math.min(...vValues) * 0.5;\n    const vMax = Math.max(...vValues) * 2;\n\n    // Build subtitle with excluded count info\n    const excludedInfo = filteredOutCount > 0 ? ` (${filteredOutCount} excluded: η≤0 or v≤0)` : \"\";\n    const subtext = `${filteredSources.length} sources, ${candidates.length} candidates${excludedInfo}`;\n\n    const option: echarts.EChartsOption = {\n      title: {\n        text: \"η-V Variability Plot\",\n        subtext,\n        left: \"center\",\n        textStyle: { color: \"#324960\", fontSize: 16 },\n        subtextStyle: { color: \"#666\" },\n      },\n      tooltip: {\n        trigger: \"item\",\n        formatter: () => \"\",\n        show: false,\n      },\n      xAxis: {\n        name: \"η (eta)\",\n        nameLocation: \"middle\",\n        nameGap: 30,\n        type: \"log\",\n        axisLabel: { formatter: \"{value}\" },\n      },\n      yAxis: {\n        name: \"V\",\n        nameLocation: \"middle\",\n        nameGap: 40,\n        type: \"log\",\n      },\n      series: [\n        {\n          type: \"scatter\",\n          data: scatterData,\n          emphasis: {\n            itemStyle: {\n              borderColor: \"#324960\",\n              borderWidth: 2,\n            },\n          },\n        },\n        // η threshold line - use computed bounds for log scale\n        {\n          type: \"line\",\n          markLine: {\n            silent: true,\n            symbol: \"none\",\n            lineStyle: { color: \"#ff6b6b\", type: \"dashed\", width: 2 },\n            data: [\n              [\n                { xAxis: etaLine, yAxis: vMin },\n                { xAxis: etaLine, yAxis: vMax },\n              ],\n            ],\n            label: {\n              formatter: `η = ${etaLine.toFixed(2)}`,\n              position: \"end\",\n            },\n          },\n        },\n        // V threshold line - use computed bounds for log scale\n        {\n          type: \"line\",\n          markLine: {\n            silent: true,\n            symbol: \"none\",\n            lineStyle: { color: \"#ff6b6b\", type: \"dashed\", width: 2 },\n            data: [\n              [\n                { xAxis: etaMin, yAxis: vLine },\n                { xAxis: etaMax, yAxis: vLine },\n              ],\n            ],\n            label: {\n              formatter: `V = ${vLine.toFixed(3)}`,\n              position: \"end\",\n            },\n          },\n        },\n      ],\n      toolbox: {\n        right: 20,\n        feature: {\n          dataZoom: { title: { zoom: \"Zoom\", back: \"Reset\" } },\n          restore: { title: \"Reset\" },\n          saveAsImage: { title: \"Save\" },\n        },\n      },\n      dataZoom: [\n        { type: \"inside\", xAxisIndex: 0 },\n        { type: \"inside\", yAxisIndex: 0 },\n      ],\n    };\n\n    chartInstance.current.setOption(option, { notMerge: false });\n\n    // Clean up previous event handlers before adding new ones\n    const chart = chartInstance.current;\n    chart.off(\"mouseover\");\n    chart.off(\"mouseout\");\n    chart.off(\"click\");\n\n    // Event handlers\n    chart.on(\"mouseover\", (params: any) => {\n      if (params.componentType === \"series\" && params.data?.source) {\n        const event = params.event?.event;\n        setHoverSource(params.data.source);\n        if (event) {\n          setHoverPosition({ x: event.clientX, y: event.clientY });\n        }\n      }\n    });\n\n    chart.on(\"mouseout\", () => {\n      setHoverSource(null);\n    });\n\n    chart.on(\"click\", (params: any) => {\n      if (params.componentType === \"series\" && params.data?.source) {\n        setSelectedSource(params.data.source);\n        setHoverSource(null);\n      }\n    });\n  }, [\n    filteredSources,\n    filteredOutCount,\n    candidates,\n    controls,\n    isLoading,\n    etaLine,\n    vLine,\n    getPointColor,\n  ]);\n\n  const handleControlChange = (values: Partial<VariabilityControlsValues>) => {\n    setControls((prev) => ({ ...prev, ...values }));\n  };\n\n  const handleNavigate = (sourceId: string) => {\n    onSourceSelect?.(sourceId);\n    setSelectedSource(null);\n  };\n\n  return (\n    <div className={`${className}`}>\n      <div className=\"flex gap-4\">\n        {/* Chart area */}\n        <div className=\"flex-1 relative\">\n          {isLoading ? (\n            <div\n              className=\"flex items-center justify-center bg-gray-50 rounded-lg\"\n              style={{ height }}\n            >\n              <div className=\"text-center\">\n                <div className=\"w-8 h-8 border-4 border-primary border-t-transparent rounded-full animate-spin mx-auto mb-2\" />\n                <span className=\"text-gray-500\">Loading sources...</span>\n              </div>\n            </div>\n          ) : (\n            <div ref={chartRef} style={{ height, width: \"100%\" }} />\n          )}\n\n          {/* Hover preview */}\n          {hoverSource && (\n            <SourcePreview\n              {...hoverSource}\n              sourceId={hoverSource.id}\n              position={hoverPosition}\n              isHover={true}\n            />\n          )}\n        </div>\n\n        {/* Controls panel */}\n        <div className=\"w-64 flex-shrink-0\">\n          <VariabilityControls {...controls} onChange={handleControlChange} />\n\n          {/* Candidates list */}\n          {candidates.length > 0 && (\n            <div className=\"mt-4 bg-red-50 border border-red-200 rounded-lg p-3\">\n              <h4 className=\"font-semibold text-red-700 text-sm mb-2\">\n                Candidates ({candidates.length})\n              </h4>\n              <div className=\"max-h-40 overflow-y-auto space-y-1\">\n                {candidates.slice(0, 10).map((c) => (\n                  <button\n                    key={c.id}\n                    onClick={() => setSelectedSource(c)}\n                    className=\"w-full text-left text-xs p-1.5 bg-white rounded hover:bg-red-100 transition-colors\"\n                  >\n                    <span className=\"font-medium\">{c.name || c.id}</span>\n                    <span className=\"text-gray-500 ml-2\">\n                      η={c.eta.toFixed(2)}, V={c.v.toFixed(3)}\n                    </span>\n                  </button>\n                ))}\n                {candidates.length > 10 && (\n                  <p className=\"text-xs text-red-500\">+{candidates.length - 10} more</p>\n                )}\n              </div>\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* Selected source detail */}\n      {selectedSource && (\n        <div className=\"fixed inset-0 bg-black/30 flex items-center justify-center z-50\">\n          <SourcePreview\n            {...selectedSource}\n            sourceId={selectedSource.id}\n            isHover={false}\n            onNavigate={handleNavigate}\n            onClose={() => setSelectedSource(null)}\n          />\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default EtaVPlot;\n","import React, { useState, useMemo, useCallback } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport { useSources } from \"../hooks/useQueries\";\nimport { LoadingSpinner, SortableTableHeader, useTableSort } from \"../components/common\";\nimport { AdvancedQueryPanel, SourceQueryParams } from \"../components/query\";\nimport { EtaVPlot, SourcePoint } from \"../components/variability\";\nimport { useSelectionStore } from \"../stores/appStore\";\n\ninterface Source {\n  id: string;\n  name?: string;\n  ra_deg?: number;\n  dec_deg?: number;\n  num_images?: number;\n  eta?: number;\n  v?: number;\n  peak_flux_jy?: number;\n}\n\n/**\n * List page showing all detected sources with advanced query and variability plot.\n */\nconst SourcesListPage: React.FC = () => {\n  const { data: sources, isLoading, error } = useSources();\n  const [activeTab, setActiveTab] = useState<\"list\" | \"variability\">(\"list\");\n  const [queryParams, setQueryParams] = useState<SourceQueryParams>({});\n\n  // Multi-select state\n  const selectedSources = useSelectionStore((s) => s.selectedSources);\n  const toggleSourceSelection = useSelectionStore((s) => s.toggleSourceSelection);\n  const selectAllSources = useSelectionStore((s) => s.selectAllSources);\n  const clearSourceSelection = useSelectionStore((s) => s.clearSourceSelection);\n\n  const selectedIds = useMemo(() => Array.from(selectedSources), [selectedSources]);\n\n  const handleExportSelected = useCallback(() => {\n    if (selectedIds.length === 0) return;\n    const baseUrl = import.meta.env.VITE_API_URL || \"/api\";\n    window.open(`${baseUrl}/sources/export?ids=${selectedIds.join(\",\")}`, \"_blank\");\n  }, [selectedIds]);\n\n  // Filter sources based on query params\n  const filteredSources = useMemo(() => {\n    if (!sources) return [];\n    let result = sources as Source[];\n\n    // Apply cone search filter\n    if (queryParams.ra !== undefined && queryParams.dec !== undefined && queryParams.radius) {\n      const { ra, dec, radius } = queryParams;\n      result = result.filter((s) => {\n        if (s.ra_deg === undefined || s.dec_deg === undefined) return false;\n        // Simple angular distance approximation\n        const dRa = (s.ra_deg - ra) * Math.cos((dec * Math.PI) / 180);\n        const dDec = s.dec_deg - dec;\n        const dist = Math.sqrt(dRa * dRa + dDec * dDec) * 60; // arcmin\n        return dist <= radius;\n      });\n    }\n\n    // Apply flux filter\n    if (queryParams.minFlux !== undefined) {\n      result = result.filter((s) => (s.peak_flux_jy ?? 0) >= (queryParams.minFlux ?? 0));\n    }\n    if (queryParams.maxFlux !== undefined) {\n      result = result.filter(\n        (s) => (s.peak_flux_jy ?? Infinity) <= (queryParams.maxFlux ?? Infinity)\n      );\n    }\n\n    return result;\n  }, [sources, queryParams]);\n\n  const { sortColumn, sortDirection, handleSort, sortedData } =\n    useTableSort<Source>(filteredSources);\n\n  // Build EtaVPlot data from sources\n  const variabilityData: SourcePoint[] = useMemo(() => {\n    if (!sources) return [];\n    return (sources as Source[])\n      .filter(\n        (s) =>\n          s.eta !== undefined &&\n          s.v !== undefined &&\n          s.ra_deg !== undefined &&\n          s.dec_deg !== undefined\n      )\n      .map((s) => ({\n        id: s.id,\n        name: s.name || s.id,\n        ra: s.ra_deg!,\n        dec: s.dec_deg!,\n        eta: s.eta!,\n        v: s.v!,\n        peakFlux: s.peak_flux_jy,\n        nMeasurements: s.num_images,\n      }));\n  }, [sources]);\n\n  if (isLoading) {\n    return <LoadingSpinner label=\"Loading sources...\" />;\n  }\n\n  if (error) {\n    return (\n      <div className=\"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg\">\n        Failed to load sources: {error.message}\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"max-w-6xl mx-auto\">\n      <div className=\"flex items-center justify-between mb-6\">\n        <div className=\"flex items-center gap-4\">\n          <h1 className=\"text-2xl font-bold text-gray-900\">Sources</h1>\n          {selectedIds.length > 0 && (\n            <span className=\"text-sm text-gray-500\">{selectedIds.length} selected</span>\n          )}\n        </div>\n        <div className=\"flex gap-2\">\n          {selectedIds.length > 0 && (\n            <button\n              onClick={handleExportSelected}\n              className=\"px-4 py-2 rounded-lg text-sm font-medium bg-green-600 text-white hover:bg-green-700 transition-colors\"\n            >\n              Export Selected\n            </button>\n          )}\n          <button\n            className={`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${\n              activeTab === \"list\"\n                ? \"bg-blue-600 text-white\"\n                : \"bg-gray-100 text-gray-700 hover:bg-gray-200\"\n            }`}\n            onClick={() => setActiveTab(\"list\")}\n          >\n            List View\n          </button>\n          <button\n            className={`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${\n              activeTab === \"variability\"\n                ? \"bg-blue-600 text-white\"\n                : \"bg-gray-100 text-gray-700 hover:bg-gray-200\"\n            }`}\n            onClick={() => setActiveTab(\"variability\")}\n          >\n            Variability Plot\n          </button>\n        </div>\n      </div>\n\n      {/* Advanced Query Panel */}\n      <div className=\"mb-6\">\n        <AdvancedQueryPanel onQueryChange={setQueryParams} />\n      </div>\n\n      {activeTab === \"variability\" ? (\n        /* Variability Plot Tab */\n        <div className=\"card p-4\">\n          {variabilityData.length > 0 ? (\n            <EtaVPlot\n              sources={variabilityData}\n              onSourceSelect={(sourceId) => (window.location.href = `/sources/${sourceId}`)}\n              height={500}\n            />\n          ) : (\n            <p className=\"text-gray-500 text-center py-8\">\n              No variability data available. Sources need η and V values to display the variability\n              plot.\n            </p>\n          )}\n        </div>\n      ) : (\n        /* List View Tab */\n        <>\n          <p className=\"text-sm text-gray-500 mb-4\">\n            Showing {filteredSources.length} of {(sources as Source[])?.length ?? 0} sources\n          </p>\n\n          {sortedData && sortedData.length > 0 ? (\n            <div className=\"card overflow-hidden\">\n              <table className=\"table\">\n                <thead>\n                  <tr>\n                    <th className=\"w-10 px-3 py-3\">\n                      <input\n                        type=\"checkbox\"\n                        checked={selectedIds.length === sortedData.length && sortedData.length > 0}\n                        ref={(el) => {\n                          if (el)\n                            el.indeterminate =\n                              selectedIds.length > 0 && selectedIds.length < sortedData.length;\n                        }}\n                        onChange={() => {\n                          if (selectedIds.length === sortedData.length) {\n                            clearSourceSelection();\n                          } else {\n                            selectAllSources(sortedData.map((s) => s.id));\n                          }\n                        }}\n                        className=\"h-4 w-4 text-blue-600 rounded\"\n                      />\n                    </th>\n                    <SortableTableHeader\n                      columnKey=\"id\"\n                      sortColumn={sortColumn}\n                      sortDirection={sortDirection}\n                      onSort={handleSort}\n                    >\n                      ID\n                    </SortableTableHeader>\n                    <SortableTableHeader\n                      columnKey=\"name\"\n                      sortColumn={sortColumn}\n                      sortDirection={sortDirection}\n                      onSort={handleSort}\n                    >\n                      Name\n                    </SortableTableHeader>\n                    <SortableTableHeader\n                      columnKey=\"ra_deg\"\n                      sortColumn={sortColumn}\n                      sortDirection={sortDirection}\n                      onSort={handleSort}\n                      className=\"text-right\"\n                    >\n                      RA (deg)\n                    </SortableTableHeader>\n                    <SortableTableHeader\n                      columnKey=\"dec_deg\"\n                      sortColumn={sortColumn}\n                      sortDirection={sortDirection}\n                      onSort={handleSort}\n                      className=\"text-right\"\n                    >\n                      Dec (deg)\n                    </SortableTableHeader>\n                    <SortableTableHeader\n                      columnKey=\"num_images\"\n                      sortColumn={sortColumn}\n                      sortDirection={sortDirection}\n                      onSort={handleSort}\n                      className=\"text-center\"\n                    >\n                      Images\n                    </SortableTableHeader>\n                  </tr>\n                </thead>\n                <tbody className=\"divide-y divide-gray-200\">\n                  {sortedData.map((source) => (\n                    <tr\n                      key={source.id}\n                      className={selectedSources.has(source.id) ? \"bg-blue-50\" : \"\"}\n                    >\n                      <td className=\"px-3\">\n                        <input\n                          type=\"checkbox\"\n                          checked={selectedSources.has(source.id)}\n                          onChange={() => toggleSourceSelection(source.id)}\n                          className=\"h-4 w-4 text-blue-600 rounded\"\n                        />\n                      </td>\n                      <td>\n                        <Link\n                          to={`/sources/${source.id}`}\n                          className=\"text-blue-600 hover:text-blue-800 font-medium\"\n                        >\n                          {source.id}\n                        </Link>\n                      </td>\n                      <td>{source.name || \"—\"}</td>\n                      <td className=\"text-right font-mono\">{source.ra_deg?.toFixed(4)}</td>\n                      <td className=\"text-right font-mono\">{source.dec_deg?.toFixed(4)}</td>\n                      <td className=\"text-center\">{source.num_images ?? \"—\"}</td>\n                    </tr>\n                  ))}\n                </tbody>\n              </table>\n            </div>\n          ) : (\n            <p className=\"text-gray-500\">No sources found.</p>\n          )}\n        </>\n      )}\n    </div>\n  );\n};\n\nexport default SourcesListPage;\n"],"names":["resolveCache","SesameResolver","onResolved","className","objectName","setObjectName","useState","service","setService","isLoading","setIsLoading","error","setError","result","setResult","abortControllerRef","useRef","resolveObject","useCallback","trimmedName","cacheKey","cached","url","response","jLine","line","match","ra","dec","resolved","err","message","handleKeyDown","e","jsxs","jsx","svc","FluxFilters","values","onChange","handleChange","field","subfield","value","current","renderFluxRow","label","tooltip","VariabilityFilters","renderMetricRow","showType","TagFilter","availableTags","includeTags","excludeTags","onIncludeChange","onExcludeChange","includeInput","setIncludeInput","excludeInput","setExcludeInput","showIncludeSuggestions","setShowIncludeSuggestions","showExcludeSuggestions","setShowExcludeSuggestions","getFilteredSuggestions","input","currentTags","lower","tag","addTag","setInput","removeTag","t","renderTagInput","tags","showSuggestions","setShowSuggestions","suggestions","suggestion","parseRA","trimmed","decimal","hmsMatch","hours","minutes","seconds","hmsShortMatch","parseDec","sign","working","dmsMatch","degrees","totalDegrees","dmsShortMatch","DEFAULT_PARAMS","AdvancedQueryPanel","runs","onSubmit","onReset","initialParams","params","setParams","expandedSections","setExpandedSections","validationErrors","setValidationErrors","raInput","setRaInput","_a","decInput","setDecInput","_b","debounceTimeoutRef","React","parseUrlHash","hash","urlParams","param","key","decoded","writeUrlHash","parts","newHash","validateParams","errors","useEffect","prev","toggleSection","section","next","handleConeSearchResolved","handleReset","handleSubmit","activeFilterCount","useMemo","count","_c","_d","_e","_f","_g","_h","_i","_j","_k","_l","_m","_n","_o","_p","hasValidationErrors","renderSection","id","title","children","isExpanded","run","Fragment","parsed","fluxValues","varValues","VariabilityControls","etaThreshold","vThreshold","etaSigma","vSigma","useSigmaThreshold","minDataPoints","colorBy","SourcePreview","sourceId","name","eta","v","peakFlux","nMeasurements","position","isHover","onNavigate","onClose","formatCoord","isRa","h","m","s","d","style","EtaVPlot","sources","onSourceSelect","height","chartRef","chartInstance","controls","setControls","hoverSource","setHoverSource","hoverPosition","setHoverPosition","selectedSource","setSelectedSource","calculateThresholds","etaValues","vValues","mean","arr","a","b","std","sum","x","etaMean","etaStd","vMean","vStd","filteredSources","filteredOutCount","etaLine","vLine","candidates","colorMaxValues","getPointColor","source","isCandidate","max","ratio","r","g","echarts.init","handleResize","candidateIds","c","scatterData","etaMin","etaMax","vMin","vMax","excludedInfo","option","chart","event","handleControlChange","handleNavigate","SourcesListPage","useSources","activeTab","setActiveTab","queryParams","setQueryParams","selectedSources","useSelectionStore","toggleSourceSelection","selectAllSources","clearSourceSelection","selectedIds","handleExportSelected","radius","dRa","dDec","sortColumn","sortDirection","handleSort","sortedData","useTableSort","variabilityData","LoadingSpinner","el","SortableTableHeader","Link"],"mappings":"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"}