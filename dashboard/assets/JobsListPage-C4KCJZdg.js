import{r as u,j as e,L as N}from"./index-DVX6Veo3.js";import{b as y}from"./useQueries-LzJhzr89.js";import{r as S}from"./relativeTime-Dp84ug83.js";import{a,L as v}from"./appStore-C_UcZAt-.js";import{u as w,S as i}from"./SortableTableHeader-dSztKu9P.js";const $=()=>{const{data:m,isLoading:g,error:x}=y(),r=a(t=>t.selectedJobs),b=a(t=>t.toggleJobSelection),p=a(t=>t.selectAllJobs),j=a(t=>t.clearJobSelection),s=u.useMemo(()=>Array.from(r),[r]),l=u.useCallback(async t=>{if(s.length===0)return;const h="https://ronnie-unsectarian-antone.ngrok-free.dev/api";t==="export"?window.open(`${h}/jobs/export?ids=${s.join(",")}`,"_blank"):await fetch(`${h}/jobs/bulk-${t}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({runIds:s})})},[s]),{sortColumn:o,sortDirection:d,handleSort:c,sortedData:n}=w(m,"started_at","desc");if(g)return e.jsx(v,{label:"Loading jobs..."});if(x)return e.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:["Failed to load jobs: ",x.message]});const f=t=>{switch(t){case"completed":return"badge-success";case"running":return"badge-info";case"failed":return"badge-error";case"pending":return"badge-warning";default:return"bg-gray-100 text-gray-800"}};return e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Pipeline Jobs"}),s.length>0&&e.jsxs("span",{className:"text-sm text-gray-500",children:[s.length," selected"]})]}),s.length>0&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>l("rerun"),className:"px-3 py-1.5 rounded text-sm font-medium bg-blue-600 text-white hover:bg-blue-700",children:"Rerun Selected"}),e.jsx("button",{onClick:()=>l("cancel"),className:"px-3 py-1.5 rounded text-sm font-medium bg-orange-600 text-white hover:bg-orange-700",children:"Cancel Selected"}),e.jsx("button",{onClick:()=>l("export"),className:"px-3 py-1.5 rounded text-sm font-medium bg-green-600 text-white hover:bg-green-700",children:"Export Logs"})]})]}),n&&n.length>0?e.jsx("div",{className:"card overflow-hidden",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"w-10 px-3 py-3",children:e.jsx("input",{type:"checkbox",checked:s.length===n.length&&n.length>0,ref:t=>{t&&(t.indeterminate=s.length>0&&s.length<n.length)},onChange:()=>{s.length===n.length?j():p(n.map(t=>t.run_id))},className:"h-4 w-4 text-blue-600 rounded"})}),e.jsx(i,{columnKey:"run_id",sortColumn:o,sortDirection:d,onSort:c,children:"Run ID"}),e.jsx(i,{columnKey:"status",sortColumn:o,sortDirection:d,onSort:c,className:"text-center",children:"Status"}),e.jsx(i,{columnKey:"started_at",sortColumn:o,sortDirection:d,onSort:c,className:"text-right",children:"Started"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:n.map(t=>e.jsxs("tr",{className:r.has(t.run_id)?"bg-blue-50":"",children:[e.jsx("td",{className:"px-3",children:e.jsx("input",{type:"checkbox",checked:r.has(t.run_id),onChange:()=>b(t.run_id),className:"h-4 w-4 text-blue-600 rounded"})}),e.jsx("td",{children:e.jsx(N,{to:`/jobs/${t.run_id}`,className:"text-blue-600 hover:text-blue-800 font-medium",children:t.run_id})}),e.jsx("td",{className:"text-center",children:e.jsx("span",{className:`badge ${f(t.status)}`,children:t.status})}),e.jsx("td",{className:"text-right text-gray-500",children:t.started_at?S(t.started_at):"â€”"})]},t.run_id))})]})}):e.jsx("p",{className:"text-gray-500",children:"No jobs found."})]})};export{$ as default};
//# sourceMappingURL=JobsListPage-C4KCJZdg.js.map
