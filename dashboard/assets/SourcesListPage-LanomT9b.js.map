{"version":3,"file":"SourcesListPage-LanomT9b.js","sources":["../../src/components/filters/AdvancedFilterPanel.tsx","../../src/components/query/SesameResolver.tsx","../../src/components/query/FluxFilters.tsx","../../src/components/query/VariabilityFilters.tsx","../../src/components/query/TagFilter.tsx","../../src/utils/coordinateParser.ts","../../src/components/query/AdvancedQueryPanel.tsx","../../src/components/variability/VariabilityControls.tsx","../../src/components/variability/SourcePreview.tsx","../../src/components/variability/EtaVPlot.tsx","../../src/pages/SourcesListPage.tsx"],"sourcesContent":["import React, { useState, useCallback, useMemo } from \"react\";\nimport { RangeSlider } from \"../widgets\";\n\nexport type FilterType = \"range\" | \"select\" | \"checkbox\" | \"text\" | \"cone-search\";\n\nexport interface FilterOption {\n  value: string;\n  label: string;\n  count?: number;\n}\n\nexport interface FilterDefinition {\n  id: string;\n  label: string;\n  type: FilterType;\n  /** Group name for accordion sections */\n  group?: string;\n  /** For range filters */\n  min?: number;\n  max?: number;\n  step?: number;\n  unit?: string;\n  histogram?: number[];\n  /** For select/checkbox filters */\n  options?: FilterOption[];\n  /** For text filters */\n  placeholder?: string;\n}\n\nexport interface FilterValues {\n  [filterId: string]: unknown;\n}\n\nexport interface AdvancedFilterPanelProps {\n  /** Filter definitions organized by group */\n  filters: FilterDefinition[];\n  /** Current filter values */\n  values: FilterValues;\n  /** Callback when filter values change */\n  onChange: (values: FilterValues) => void;\n  /** Callback to apply filters */\n  onApply: () => void;\n  /** Callback to reset all filters */\n  onReset: () => void;\n  /** Custom class name */\n  className?: string;\n}\n\ninterface ConeSearchValue {\n  ra: string;\n  dec: string;\n  radius: string;\n}\n\n/**\n * Advanced filtering panel with accordion-style collapsible groups.\n * Supports range sliders, select dropdowns, checkboxes, text search, and cone search.\n */\nconst AdvancedFilterPanel: React.FC<AdvancedFilterPanelProps> = ({\n  filters,\n  values,\n  onChange,\n  onApply,\n  onReset,\n  className = \"\",\n}) => {\n  const [expandedGroups, setExpandedGroups] = useState<Set<string>>(new Set([\"all\"]));\n\n  // Group filters by their group property\n  const groupedFilters = useMemo(() => {\n    const groups: Record<string, FilterDefinition[]> = {};\n    filters.forEach((filter) => {\n      const group = filter.group || \"General\";\n      if (!groups[group]) groups[group] = [];\n      groups[group].push(filter);\n    });\n    return groups;\n  }, [filters]);\n\n  const toggleGroup = useCallback((group: string) => {\n    setExpandedGroups((prev) => {\n      const next = new Set(prev);\n      if (next.has(group)) {\n        next.delete(group);\n      } else {\n        next.add(group);\n      }\n      return next;\n    });\n  }, []);\n\n  const handleFilterChange = useCallback(\n    (filterId: string, value: unknown) => {\n      onChange({\n        ...values,\n        [filterId]: value,\n      });\n    },\n    [values, onChange]\n  );\n\n  // Count active filters\n  const activeCount = useMemo(() => {\n    let count = 0;\n    Object.entries(values).forEach(([key, value]) => {\n      const filter = filters.find((f) => f.id === key);\n      if (!filter) return;\n\n      if (filter.type === \"range\") {\n        const rangeVal = value as { min: number; max: number };\n        if (rangeVal && (rangeVal.min !== filter.min || rangeVal.max !== filter.max)) {\n          count++;\n        }\n      } else if (filter.type === \"checkbox\") {\n        if (Array.isArray(value) && value.length > 0) count++;\n      } else if (filter.type === \"cone-search\") {\n        const coneVal = value as ConeSearchValue;\n        if (coneVal?.ra || coneVal?.dec || coneVal?.radius) count++;\n      } else if (value) {\n        count++;\n      }\n    });\n    return count;\n  }, [values, filters]);\n\n  const renderFilter = (filter: FilterDefinition) => {\n    switch (filter.type) {\n      case \"range\": {\n        const rangeValue = values[filter.id] as { min: number; max: number } | undefined;\n        return (\n          <RangeSlider\n            min={filter.min ?? 0}\n            max={filter.max ?? 100}\n            step={filter.step}\n            unit={filter.unit}\n            minValue={rangeValue?.min}\n            maxValue={rangeValue?.max}\n            onChange={(minVal, maxVal) =>\n              handleFilterChange(filter.id, { min: minVal, max: maxVal })\n            }\n            histogram={filter.histogram}\n          />\n        );\n      }\n\n      case \"select\":\n        return (\n          <select\n            value={(values[filter.id] as string) || \"\"}\n            onChange={(e) => handleFilterChange(filter.id, e.target.value)}\n            className=\"form-select w-full\"\n          >\n            <option value=\"\">All</option>\n            {filter.options?.map((opt) => (\n              <option key={opt.value} value={opt.value}>\n                {opt.label}\n                {opt.count !== undefined && ` (${opt.count})`}\n              </option>\n            ))}\n          </select>\n        );\n\n      case \"checkbox\":\n        return (\n          <div className=\"space-y-1 max-h-48 overflow-y-auto\">\n            {filter.options?.map((opt) => (\n              <label key={opt.value} className=\"flex items-center gap-2 text-sm\">\n                <input\n                  type=\"checkbox\"\n                  checked={((values[filter.id] as string[]) || []).includes(opt.value)}\n                  onChange={(e) => {\n                    const current = (values[filter.id] as string[]) || [];\n                    const next = e.target.checked\n                      ? [...current, opt.value]\n                      : current.filter((v) => v !== opt.value);\n                    handleFilterChange(filter.id, next);\n                  }}\n                  className=\"w-4 h-4 text-vast-green rounded border-gray-300 focus:ring-vast-green\"\n                />\n                <span>{opt.label}</span>\n                {opt.count !== undefined && <span className=\"text-gray-400\">({opt.count})</span>}\n              </label>\n            ))}\n          </div>\n        );\n\n      case \"text\":\n        return (\n          <input\n            type=\"text\"\n            value={(values[filter.id] as string) || \"\"}\n            onChange={(e) => handleFilterChange(filter.id, e.target.value)}\n            placeholder={filter.placeholder || `Search ${filter.label.toLowerCase()}...`}\n            className=\"form-control w-full\"\n          />\n        );\n\n      case \"cone-search\":\n        const coneValue = (values[filter.id] as ConeSearchValue) || {\n          ra: \"\",\n          dec: \"\",\n          radius: \"2\",\n        };\n        return (\n          <div className=\"space-y-3\">\n            <div className=\"grid grid-cols-2 gap-2\">\n              <div>\n                <label className=\"text-xs text-gray-500\">RA (deg or HMS)</label>\n                <input\n                  type=\"text\"\n                  value={coneValue.ra}\n                  onChange={(e) =>\n                    handleFilterChange(filter.id, {\n                      ...coneValue,\n                      ra: e.target.value,\n                    })\n                  }\n                  placeholder=\"180.0 or 12:00:00\"\n                  className=\"form-control w-full\"\n                />\n              </div>\n              <div>\n                <label className=\"text-xs text-gray-500\">Dec (deg or DMS)</label>\n                <input\n                  type=\"text\"\n                  value={coneValue.dec}\n                  onChange={(e) =>\n                    handleFilterChange(filter.id, {\n                      ...coneValue,\n                      dec: e.target.value,\n                    })\n                  }\n                  placeholder=\"+45.0 or +45:00:00\"\n                  className=\"form-control w-full\"\n                />\n              </div>\n            </div>\n            <div>\n              <label className=\"text-xs text-gray-500\">Radius (arcmin)</label>\n              <input\n                type=\"number\"\n                value={coneValue.radius}\n                onChange={(e) =>\n                  handleFilterChange(filter.id, {\n                    ...coneValue,\n                    radius: e.target.value,\n                  })\n                }\n                min={0.1}\n                max={60}\n                step={0.5}\n                className=\"form-control w-full\"\n              />\n            </div>\n          </div>\n        );\n\n      default:\n        return null;\n    }\n  };\n\n  return (\n    <div className={`card ${className}`}>\n      <div className=\"card-header flex items-center justify-between\">\n        <h4 className=\"text-lg font-semibold flex items-center gap-2\">\n          Filters\n          {activeCount > 0 && <span className=\"badge badge-primary\">{activeCount} active</span>}\n        </h4>\n        <button onClick={onReset} className=\"text-sm text-gray-500 hover:text-red-500\">\n          Reset all\n        </button>\n      </div>\n\n      <div className=\"divide-y divide-gray-200\">\n        {Object.entries(groupedFilters).map(([group, groupFilters]) => (\n          <div key={group} className=\"accordion-group\">\n            {/* Accordion Header */}\n            <button\n              onClick={() => toggleGroup(group)}\n              className=\"w-full flex items-center justify-between px-4 py-3 bg-gray-50 hover:bg-gray-100 transition-colors\"\n            >\n              <span className=\"font-medium text-gray-700\">{group}</span>\n              <svg\n                className={`w-5 h-5 text-gray-500 transition-transform ${\n                  expandedGroups.has(group) ? \"rotate-180\" : \"\"\n                }`}\n                fill=\"none\"\n                stroke=\"currentColor\"\n                viewBox=\"0 0 24 24\"\n              >\n                <path\n                  strokeLinecap=\"round\"\n                  strokeLinejoin=\"round\"\n                  strokeWidth={2}\n                  d=\"M19 9l-7 7-7-7\"\n                />\n              </svg>\n            </button>\n\n            {/* Accordion Content */}\n            {expandedGroups.has(group) && (\n              <div className=\"p-4 space-y-4\">\n                {groupFilters.map((filter) => (\n                  <div key={filter.id} className=\"filter-item\">\n                    <label className=\"form-label\">{filter.label}</label>\n                    {renderFilter(filter)}\n                  </div>\n                ))}\n              </div>\n            )}\n          </div>\n        ))}\n      </div>\n\n      {/* Apply Button */}\n      <div className=\"p-4 border-t border-gray-200 bg-gray-50\">\n        <button onClick={onApply} className=\"btn btn-primary w-full\">\n          Apply Filters\n        </button>\n      </div>\n    </div>\n  );\n};\n\nexport default AdvancedFilterPanel;\n","import React, { useState, useCallback, useRef } from \"react\";\n\nexport interface SesameResolverProps {\n  /** Callback when coordinates are resolved */\n  onResolved: (ra: number, dec: number, objectName: string) => void;\n  /** Custom class name */\n  className?: string;\n}\n\ntype SesameService = \"all\" | \"simbad\" | \"ned\" | \"vizier\";\n\ninterface ResolveResult {\n  ra: number;\n  dec: number;\n  objectName: string;\n  service: string;\n}\n\n// Simple in-memory cache for resolved objects\nconst resolveCache = new Map<string, ResolveResult>();\n\n/**\n * Sesame name resolver component.\n * Resolves astronomical object names to coordinates using CDS Sesame service.\n */\nconst SesameResolver: React.FC<SesameResolverProps> = ({ onResolved, className = \"\" }) => {\n  const [objectName, setObjectName] = useState(\"\");\n  const [service, setService] = useState<SesameService>(\"all\");\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [result, setResult] = useState<ResolveResult | null>(null);\n\n  // AbortController for request cancellation\n  const abortControllerRef = useRef<AbortController | null>(null);\n\n  const resolveObject = useCallback(async () => {\n    const trimmedName = objectName.trim();\n    if (!trimmedName) {\n      setError(\"Please enter an object name\");\n      return;\n    }\n\n    // Check cache first\n    const cacheKey = `${service}:${trimmedName.toLowerCase()}`;\n    const cached = resolveCache.get(cacheKey);\n    if (cached) {\n      setResult(cached);\n      setError(null);\n      onResolved(cached.ra, cached.dec, cached.objectName);\n      return;\n    }\n\n    // Cancel any pending request\n    if (abortControllerRef.current) {\n      abortControllerRef.current.abort();\n    }\n    abortControllerRef.current = new AbortController();\n\n    setIsLoading(true);\n    setError(null);\n    setResult(null);\n\n    try {\n      // Use CDS Sesame service via their API\n      // Format: https://cdsweb.u-strasbg.fr/cgi-bin/nph-sesame/-oI/A?object_name\n      const serviceCode = service === \"all\" ? \"A\" : service.charAt(0).toUpperCase();\n      const url = `https://cdsweb.u-strasbg.fr/cgi-bin/nph-sesame/-oI/${serviceCode}?${encodeURIComponent(\n        trimmedName\n      )}`;\n\n      const response = await fetch(url, {\n        signal: abortControllerRef.current.signal,\n      });\n\n      if (!response.ok) {\n        throw new Error(`HTTP error: ${response.status}`);\n      }\n\n      const text = await response.text();\n\n      // Parse the Sesame response\n      // Format includes lines like:\n      // %J 83.63308 +22.01450 = 05 34 31.94 +22 00 52.2\n      const jLine = text.split(\"\\n\").find((line) => line.startsWith(\"%J\"));\n\n      if (!jLine) {\n        throw new Error(\"Could not resolve object. Please check the name and try again.\");\n      }\n\n      const match = jLine.match(/%J\\s+([\\d.+-]+)\\s+([\\d.+-]+)/);\n      if (!match) {\n        throw new Error(\"Failed to parse coordinates from response.\");\n      }\n\n      const ra = parseFloat(match[1]);\n      const dec = parseFloat(match[2]);\n\n      const resolved: ResolveResult = {\n        ra,\n        dec,\n        objectName: trimmedName,\n        service,\n      };\n\n      // Cache the result\n      resolveCache.set(cacheKey, resolved);\n\n      setResult(resolved);\n      onResolved(ra, dec, trimmedName);\n    } catch (err) {\n      // Don't show error for aborted requests\n      if (err instanceof Error && err.name === \"AbortError\") {\n        return;\n      }\n      const message = err instanceof Error ? err.message : \"Resolution failed\";\n      // Distinguish network errors\n      if (message.includes(\"fetch\") || message.includes(\"network\")) {\n        setError(\"Network error. CORS may be blocking the request. Try using a backend proxy.\");\n      } else {\n        setError(message);\n      }\n    } finally {\n      setIsLoading(false);\n    }\n  }, [objectName, service, onResolved]);\n\n  const handleKeyDown = (e: React.KeyboardEvent) => {\n    if (e.key === \"Enter\") {\n      resolveObject();\n    }\n  };\n\n  return (\n    <div className={`space-y-3 ${className}`}>\n      <div className=\"flex gap-2\">\n        <input\n          type=\"text\"\n          value={objectName}\n          onChange={(e) => setObjectName(e.target.value)}\n          onKeyDown={handleKeyDown}\n          placeholder=\"Object name (e.g., M31, Crab Nebula, PSR J0534+2200)\"\n          className=\"form-control flex-1\"\n        />\n        <button\n          onClick={resolveObject}\n          disabled={isLoading || !objectName.trim()}\n          className=\"btn btn-primary\"\n        >\n          {isLoading ? (\n            <span className=\"flex items-center gap-1\">\n              <span className=\"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin\" />\n              Resolving...\n            </span>\n          ) : (\n            \"Resolve\"\n          )}\n        </button>\n      </div>\n\n      {/* Service selection */}\n      <div className=\"flex items-center gap-4 text-sm\">\n        <span className=\"text-gray-600\">Service:</span>\n        {([\"all\", \"simbad\", \"ned\", \"vizier\"] as SesameService[]).map((svc) => (\n          <label key={svc} className=\"flex items-center gap-1 cursor-pointer\">\n            <input\n              type=\"radio\"\n              name=\"sesame-service\"\n              value={svc}\n              checked={service === svc}\n              onChange={() => setService(svc)}\n              className=\"w-4 h-4 text-vast-green\"\n            />\n            <span className=\"capitalize\">{svc === \"all\" ? \"All\" : svc.toUpperCase()}</span>\n          </label>\n        ))}\n      </div>\n\n      {/* Error display */}\n      {error && (\n        <div className=\"text-red-600 text-sm flex items-center gap-1\">\n          <svg className=\"w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n            <path\n              fillRule=\"evenodd\"\n              d=\"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z\"\n              clipRule=\"evenodd\"\n            />\n          </svg>\n          {error}\n        </div>\n      )}\n\n      {/* Success display */}\n      {result && (\n        <div className=\"text-green-600 text-sm flex items-center gap-1\">\n          <svg className=\"w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n            <path\n              fillRule=\"evenodd\"\n              d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z\"\n              clipRule=\"evenodd\"\n            />\n          </svg>\n          <span>\n            Resolved: RA={result.ra.toFixed(6)}°, Dec={result.dec.toFixed(6)}°\n          </span>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default SesameResolver;\n","import React from \"react\";\n\nexport interface FluxFiltersProps {\n  /** Current filter values */\n  values: {\n    minFlux?: { min?: number; max?: number; type: \"peak\" | \"int\" };\n    maxFlux?: { min?: number; max?: number; type: \"peak\" | \"int\" };\n    avgFlux?: { min?: number; max?: number; type: \"peak\" | \"int\" };\n  };\n  /** Callback when values change */\n  onChange: (values: FluxFiltersProps[\"values\"]) => void;\n  /** Custom class name */\n  className?: string;\n}\n\n/**\n * Flux range filter inputs for min, max, and average flux.\n */\nconst FluxFilters: React.FC<FluxFiltersProps> = ({ values, onChange, className = \"\" }) => {\n  const handleChange = (\n    field: \"minFlux\" | \"maxFlux\" | \"avgFlux\",\n    subfield: \"min\" | \"max\" | \"type\",\n    value: string | number\n  ) => {\n    const current = values[field] || { type: \"peak\" as const };\n    onChange({\n      ...values,\n      [field]: {\n        ...current,\n        [subfield]: subfield === \"type\" ? value : value === \"\" ? undefined : Number(value),\n      },\n    });\n  };\n\n  const renderFluxRow = (\n    label: string,\n    field: \"minFlux\" | \"maxFlux\" | \"avgFlux\",\n    tooltip: string\n  ) => {\n    const current = values[field] || { type: \"peak\" as const };\n    return (\n      <div className=\"form-group\">\n        <div className=\"flex items-center gap-2 mb-1\">\n          <label className=\"form-label mb-0 font-semibold\">{label}</label>\n          <span className=\"text-gray-400 cursor-help\" title={tooltip}>\n            <svg className=\"w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n              <path\n                fillRule=\"evenodd\"\n                d=\"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z\"\n                clipRule=\"evenodd\"\n              />\n            </svg>\n          </span>\n        </div>\n        <div className=\"grid grid-cols-3 gap-2\">\n          <input\n            type=\"number\"\n            value={current.min ?? \"\"}\n            onChange={(e) => handleChange(field, \"min\", e.target.value)}\n            placeholder=\"Min (mJy)\"\n            step=\"0.01\"\n            className=\"form-control\"\n          />\n          <input\n            type=\"number\"\n            value={current.max ?? \"\"}\n            onChange={(e) => handleChange(field, \"max\", e.target.value)}\n            placeholder=\"Max (mJy)\"\n            step=\"0.01\"\n            className=\"form-control\"\n          />\n          <select\n            value={current.type || \"peak\"}\n            onChange={(e) => handleChange(field, \"type\", e.target.value)}\n            className=\"form-select\"\n          >\n            <option value=\"peak\">Peak Flux</option>\n            <option value=\"int\">Int Flux</option>\n          </select>\n        </div>\n      </div>\n    );\n  };\n\n  return (\n    <div className={`space-y-4 ${className}`}>\n      {renderFluxRow(\n        \"Min. Flux\",\n        \"minFlux\",\n        \"The minimum flux of a source. Peak or integrated flux can be selected.\"\n      )}\n      {renderFluxRow(\n        \"Max. Flux\",\n        \"maxFlux\",\n        \"The maximum flux of a source. Peak or integrated flux can be selected.\"\n      )}\n      {renderFluxRow(\n        \"Avg. Flux\",\n        \"avgFlux\",\n        \"The average flux of a source. Peak or integrated flux can be selected.\"\n      )}\n    </div>\n  );\n};\n\nexport default FluxFilters;\n","import React from \"react\";\n\nexport interface VariabilityFiltersProps {\n  /** Current filter values */\n  values: {\n    eta?: { min?: number; max?: number; type: \"peak\" | \"int\" };\n    v?: { min?: number; max?: number; type: \"peak\" | \"int\" };\n    vs?: { min?: number; max?: number; type: \"peak\" | \"int\" };\n    m?: { min?: number; max?: number; type: \"peak\" | \"int\" };\n  };\n  /** Callback when values change */\n  onChange: (values: VariabilityFiltersProps[\"values\"]) => void;\n  /** Custom class name */\n  className?: string;\n}\n\n/**\n * Variability metric filter inputs (η, V, Vs, m).\n */\nconst VariabilityFilters: React.FC<VariabilityFiltersProps> = ({\n  values,\n  onChange,\n  className = \"\",\n}) => {\n  const handleChange = (\n    field: \"eta\" | \"v\" | \"vs\" | \"m\",\n    subfield: \"min\" | \"max\" | \"type\",\n    value: string | number\n  ) => {\n    const current = values[field] || { type: \"peak\" as const };\n    onChange({\n      ...values,\n      [field]: {\n        ...current,\n        [subfield]: subfield === \"type\" ? value : value === \"\" ? undefined : Number(value),\n      },\n    });\n  };\n\n  const renderMetricRow = (\n    label: string,\n    field: \"eta\" | \"v\" | \"vs\" | \"m\",\n    tooltip: string,\n    showType: boolean = true\n  ) => {\n    const current = values[field] || { type: \"peak\" as const };\n    return (\n      <div className=\"form-group\">\n        <div className=\"flex items-center gap-2 mb-1\">\n          <label className=\"form-label mb-0 font-semibold\">{label}</label>\n          <span className=\"text-gray-400 cursor-help\" title={tooltip}>\n            <svg className=\"w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n              <path\n                fillRule=\"evenodd\"\n                d=\"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z\"\n                clipRule=\"evenodd\"\n              />\n            </svg>\n          </span>\n        </div>\n        <div className={`grid ${showType ? \"grid-cols-3\" : \"grid-cols-2\"} gap-2`}>\n          <input\n            type=\"number\"\n            value={current.min ?? \"\"}\n            onChange={(e) => handleChange(field, \"min\", e.target.value)}\n            placeholder=\"Min\"\n            step=\"0.01\"\n            className=\"form-control\"\n          />\n          <input\n            type=\"number\"\n            value={current.max ?? \"\"}\n            onChange={(e) => handleChange(field, \"max\", e.target.value)}\n            placeholder=\"Max\"\n            step=\"0.01\"\n            className=\"form-control\"\n          />\n          {showType && (\n            <select\n              value={current.type || \"peak\"}\n              onChange={(e) => handleChange(field, \"type\", e.target.value)}\n              className=\"form-select\"\n            >\n              <option value=\"peak\">Peak Flux</option>\n              <option value=\"int\">Int Flux</option>\n            </select>\n          )}\n        </div>\n      </div>\n    );\n  };\n\n  return (\n    <div className={`space-y-4 ${className}`}>\n      {renderMetricRow(\n        \"η (Eta) Metric\",\n        \"eta\",\n        \"The weighted reduced chi-squared variability metric. Higher values indicate more variability.\"\n      )}\n      {renderMetricRow(\n        \"V Metric\",\n        \"v\",\n        \"The variability index, equivalent to fractional variability. V = σ/μ.\"\n      )}\n      {renderMetricRow(\n        \"Max |Vs| Metric\",\n        \"vs\",\n        \"The maximum two-epoch variability t-statistic value derived from the source.\"\n      )}\n      {renderMetricRow(\n        \"Max |m| Metric\",\n        \"m\",\n        \"The maximum two-epoch modulation index derived from the source (measure of variability).\"\n      )}\n    </div>\n  );\n};\n\nexport default VariabilityFilters;\n","import React, { useState } from \"react\";\n\nexport interface TagFilterProps {\n  /** Available tags */\n  availableTags: string[];\n  /** Currently included tags */\n  includeTags: string[];\n  /** Currently excluded tags */\n  excludeTags: string[];\n  /** Callback when include tags change */\n  onIncludeChange: (tags: string[]) => void;\n  /** Callback when exclude tags change */\n  onExcludeChange: (tags: string[]) => void;\n  /** Custom class name */\n  className?: string;\n}\n\n/**\n * Tag include/exclude filter with autocomplete.\n */\nconst TagFilter: React.FC<TagFilterProps> = ({\n  availableTags,\n  includeTags,\n  excludeTags,\n  onIncludeChange,\n  onExcludeChange,\n  className = \"\",\n}) => {\n  const [includeInput, setIncludeInput] = useState(\"\");\n  const [excludeInput, setExcludeInput] = useState(\"\");\n  const [showIncludeSuggestions, setShowIncludeSuggestions] = useState(false);\n  const [showExcludeSuggestions, setShowExcludeSuggestions] = useState(false);\n\n  const getFilteredSuggestions = (input: string, currentTags: string[]) => {\n    if (!input.trim()) return [];\n    const lower = input.toLowerCase();\n    return availableTags\n      .filter((tag) => tag.toLowerCase().includes(lower) && !currentTags.includes(tag))\n      .slice(0, 10);\n  };\n\n  const addTag = (\n    tag: string,\n    currentTags: string[],\n    onChange: (tags: string[]) => void,\n    setInput: (val: string) => void\n  ) => {\n    if (!currentTags.includes(tag)) {\n      onChange([...currentTags, tag]);\n    }\n    setInput(\"\");\n  };\n\n  const removeTag = (tag: string, currentTags: string[], onChange: (tags: string[]) => void) => {\n    onChange(currentTags.filter((t) => t !== tag));\n  };\n\n  const renderTagInput = (\n    label: string,\n    input: string,\n    setInput: (val: string) => void,\n    tags: string[],\n    onChange: (tags: string[]) => void,\n    showSuggestions: boolean,\n    setShowSuggestions: (show: boolean) => void,\n    tooltip: string\n  ) => {\n    const suggestions = getFilteredSuggestions(input, tags);\n\n    return (\n      <div className=\"form-group\">\n        <div className=\"flex items-center gap-2 mb-1\">\n          <label className=\"form-label mb-0 font-semibold\">{label}</label>\n          <span className=\"text-gray-400 cursor-help\" title={tooltip}>\n            <svg className=\"w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n              <path\n                fillRule=\"evenodd\"\n                d=\"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z\"\n                clipRule=\"evenodd\"\n              />\n            </svg>\n          </span>\n        </div>\n\n        {/* Selected tags */}\n        {tags.length > 0 && (\n          <div className=\"flex flex-wrap gap-1 mb-2\">\n            {tags.map((tag) => (\n              <span key={tag} className=\"badge badge-secondary flex items-center gap-1\">\n                {tag}\n                <button\n                  onClick={() => removeTag(tag, tags, onChange)}\n                  className=\"hover:text-red-500\"\n                >\n                  ×\n                </button>\n              </span>\n            ))}\n          </div>\n        )}\n\n        {/* Input with suggestions */}\n        <div className=\"relative\">\n          <input\n            type=\"text\"\n            value={input}\n            onChange={(e) => {\n              setInput(e.target.value);\n              setShowSuggestions(true);\n            }}\n            onFocus={() => setShowSuggestions(true)}\n            onBlur={() => setTimeout(() => setShowSuggestions(false), 200)}\n            onKeyDown={(e) => {\n              if (e.key === \"Enter\" && input.trim()) {\n                e.preventDefault();\n                if (suggestions.length > 0) {\n                  addTag(suggestions[0], tags, onChange, setInput);\n                } else if (availableTags.includes(input.trim())) {\n                  addTag(input.trim(), tags, onChange, setInput);\n                }\n              }\n            }}\n            placeholder=\"Type to search tags...\"\n            className=\"form-control w-full\"\n          />\n\n          {/* Suggestions dropdown */}\n          {showSuggestions && suggestions.length > 0 && (\n            <div className=\"absolute z-10 w-full mt-1 bg-white border border-gray-200 rounded-md shadow-lg max-h-48 overflow-auto\">\n              {suggestions.map((suggestion) => (\n                <button\n                  key={suggestion}\n                  onClick={() => addTag(suggestion, tags, onChange, setInput)}\n                  className=\"w-full text-left px-3 py-2 hover:bg-gray-100 text-sm\"\n                >\n                  {suggestion}\n                </button>\n              ))}\n            </div>\n          )}\n        </div>\n      </div>\n    );\n  };\n\n  return (\n    <div className={`space-y-4 ${className}`}>\n      {renderTagInput(\n        \"Include Tags\",\n        includeInput,\n        setIncludeInput,\n        includeTags,\n        onIncludeChange,\n        showIncludeSuggestions,\n        setShowIncludeSuggestions,\n        \"Only return sources that have the given tags.\"\n      )}\n      {renderTagInput(\n        \"Exclude Tags\",\n        excludeInput,\n        setExcludeInput,\n        excludeTags,\n        onExcludeChange,\n        showExcludeSuggestions,\n        setShowExcludeSuggestions,\n        \"Only return sources that do NOT have the given tags.\"\n      )}\n    </div>\n  );\n};\n\nexport default TagFilter;\n","/**\n * Parse astronomical coordinates from various formats.\n * Supports decimal degrees, HMS (hours:minutes:seconds) for RA,\n * and DMS (degrees:minutes:seconds) for Dec.\n */\n\n/**\n * Parse RA from various formats to decimal degrees.\n * Accepts:\n * - Decimal degrees: 180.5\n * - HMS with colons: 12:30:00 or 12:30:00.0\n * - HMS with letters: 12h30m00s\n * - HMS with spaces: 12 30 00\n *\n * @returns RA in decimal degrees [0, 360) or null if invalid\n */\nexport function parseRA(input: string): number | null {\n  if (!input || typeof input !== \"string\") return null;\n\n  const trimmed = input.trim();\n  if (!trimmed) return null;\n\n  // Try decimal degrees first\n  const decimal = parseFloat(trimmed);\n  if (!isNaN(decimal) && !trimmed.includes(\":\") && !trimmed.match(/[hms°'\"]/i)) {\n    // Validate range\n    if (decimal >= 0 && decimal < 360) {\n      return decimal;\n    }\n    // Could be hours if in [0, 24)\n    if (decimal >= 0 && decimal < 24) {\n      return decimal * 15; // Convert hours to degrees\n    }\n    return null;\n  }\n\n  // Try HMS format\n  const hmsMatch = trimmed.match(\n    /^(\\d{1,2})(?:h|:|\\s)\\s*(\\d{1,2})(?:m|:|\\s)\\s*(\\d{1,2}(?:\\.\\d+)?)\\s*s?$/i\n  );\n\n  if (hmsMatch) {\n    const hours = parseInt(hmsMatch[1], 10);\n    const minutes = parseInt(hmsMatch[2], 10);\n    const seconds = parseFloat(hmsMatch[3]);\n\n    if (hours >= 0 && hours < 24 && minutes >= 0 && minutes < 60 && seconds >= 0 && seconds < 60) {\n      const totalHours = hours + minutes / 60 + seconds / 3600;\n      return totalHours * 15; // Convert hours to degrees\n    }\n  }\n\n  // Try short HMS (no seconds): 12:30 or 12h30m\n  const hmsShortMatch = trimmed.match(/^(\\d{1,2})(?:h|:|\\s)\\s*(\\d{1,2})(?:m)?$/i);\n\n  if (hmsShortMatch) {\n    const hours = parseInt(hmsShortMatch[1], 10);\n    const minutes = parseInt(hmsShortMatch[2], 10);\n\n    if (hours >= 0 && hours < 24 && minutes >= 0 && minutes < 60) {\n      const totalHours = hours + minutes / 60;\n      return totalHours * 15;\n    }\n  }\n\n  return null;\n}\n\n/**\n * Parse Dec from various formats to decimal degrees.\n * Accepts:\n * - Decimal degrees: +45.5 or -45.5\n * - DMS with colons: +45:30:00 or -45:30:00\n * - DMS with symbols: +45°30'00\" or 45d30m00s\n * - DMS with spaces: +45 30 00\n *\n * @returns Dec in decimal degrees [-90, 90] or null if invalid\n */\nexport function parseDec(input: string): number | null {\n  if (!input || typeof input !== \"string\") return null;\n\n  const trimmed = input.trim();\n  if (!trimmed) return null;\n\n  // Determine sign\n  let sign = 1;\n  let working = trimmed;\n\n  if (working.startsWith(\"-\")) {\n    sign = -1;\n    working = working.slice(1).trim();\n  } else if (working.startsWith(\"+\")) {\n    working = working.slice(1).trim();\n  }\n\n  // Try decimal degrees first\n  const decimal = parseFloat(working);\n  if (!isNaN(decimal) && !working.includes(\":\") && !working.match(/[dms°'\"]/i)) {\n    const result = sign * decimal;\n    if (result >= -90 && result <= 90) {\n      return result;\n    }\n    return null;\n  }\n\n  // Try DMS format\n  const dmsMatch = working.match(\n    /^(\\d{1,2})(?:d|°|:|\\s)\\s*(\\d{1,2})(?:m|'|:|\\s)\\s*(\\d{1,2}(?:\\.\\d+)?)\\s*(?:s|\")?$/i\n  );\n\n  if (dmsMatch) {\n    const degrees = parseInt(dmsMatch[1], 10);\n    const minutes = parseInt(dmsMatch[2], 10);\n    const seconds = parseFloat(dmsMatch[3]);\n\n    if (\n      degrees >= 0 &&\n      degrees <= 90 &&\n      minutes >= 0 &&\n      minutes < 60 &&\n      seconds >= 0 &&\n      seconds < 60\n    ) {\n      const totalDegrees = degrees + minutes / 60 + seconds / 3600;\n      const result = sign * totalDegrees;\n      if (result >= -90 && result <= 90) {\n        return result;\n      }\n    }\n  }\n\n  // Try short DMS (no seconds): +45:30 or 45d30m\n  const dmsShortMatch = working.match(/^(\\d{1,2})(?:d|°|:|\\s)\\s*(\\d{1,2})(?:m|')?$/i);\n\n  if (dmsShortMatch) {\n    const degrees = parseInt(dmsShortMatch[1], 10);\n    const minutes = parseInt(dmsShortMatch[2], 10);\n\n    if (degrees >= 0 && degrees <= 90 && minutes >= 0 && minutes < 60) {\n      const totalDegrees = degrees + minutes / 60;\n      const result = sign * totalDegrees;\n      if (result >= -90 && result <= 90) {\n        return result;\n      }\n    }\n  }\n\n  return null;\n}\n\n/**\n * Format RA in decimal degrees to HMS string.\n */\nexport function formatRAtoHMS(ra: number): string {\n  const totalHours = ra / 15;\n  const hours = Math.floor(totalHours);\n  const remainingMinutes = (totalHours - hours) * 60;\n  const minutes = Math.floor(remainingMinutes);\n  const seconds = (remainingMinutes - minutes) * 60;\n\n  return `${hours.toString().padStart(2, \"0\")}:${minutes.toString().padStart(2, \"0\")}:${seconds\n    .toFixed(2)\n    .padStart(5, \"0\")}`;\n}\n\n/** Alias for formatRAtoHMS */\nexport const formatRA = formatRAtoHMS;\n\n/**\n * Format Dec in decimal degrees to DMS string.\n */\nexport function formatDectoDMS(dec: number): string {\n  const sign = dec >= 0 ? \"+\" : \"-\";\n  const absDec = Math.abs(dec);\n  const degrees = Math.floor(absDec);\n  const remainingMinutes = (absDec - degrees) * 60;\n  const minutes = Math.floor(remainingMinutes);\n  const seconds = (remainingMinutes - minutes) * 60;\n\n  return `${sign}${degrees.toString().padStart(2, \"0\")}:${minutes\n    .toString()\n    .padStart(2, \"0\")}:${seconds.toFixed(1).padStart(4, \"0\")}`;\n}\n\n/** Alias for formatDectoDMS */\nexport const formatDec = formatDectoDMS;\n\n/**\n * Parse a coordinate pair string (RA and Dec together).\n * Accepts formats like:\n * - \"180.0, 45.5\"\n * - \"12:00:00, +45:30:00\"\n * - \"12:00:00 +45:30:00\"\n */\nexport function parseCoordinatePair(input: string): { ra: number; dec: number } | null {\n  if (!input || typeof input !== \"string\") return null;\n\n  const trimmed = input.trim();\n  if (!trimmed) return null;\n\n  // Try comma-separated\n  if (trimmed.includes(\",\")) {\n    const parts = trimmed.split(\",\").map((s) => s.trim());\n    if (parts.length === 2) {\n      const ra = parseRA(parts[0]);\n      const dec = parseDec(parts[1]);\n      if (ra !== null && dec !== null) {\n        return { ra, dec };\n      }\n    }\n  }\n\n  // Try space-separated (look for sign in second part)\n  const signMatch = trimmed.match(/^(.+?)\\s+([+-]?\\d.*)$/);\n  if (signMatch) {\n    const ra = parseRA(signMatch[1].trim());\n    const dec = parseDec(signMatch[2].trim());\n    if (ra !== null && dec !== null) {\n      return { ra, dec };\n    }\n  }\n\n  return null;\n}\n\n/**\n * Validate coordinates are in valid range.\n */\nexport function validateCoordinates(\n  ra: number | null,\n  dec: number | null\n): {\n  valid: boolean;\n  raError?: string;\n  decError?: string;\n} {\n  const result: { valid: boolean; raError?: string; decError?: string } = { valid: true };\n\n  if (ra !== null) {\n    if (ra < 0 || ra >= 360) {\n      result.valid = false;\n      result.raError = \"RA must be between 0 and 360 degrees\";\n    }\n  }\n\n  if (dec !== null) {\n    if (dec < -90 || dec > 90) {\n      result.valid = false;\n      result.decError = \"Dec must be between -90 and 90 degrees\";\n    }\n  }\n\n  return result;\n}\n","import React, { useState, useCallback, useMemo, useEffect } from \"react\";\nimport SesameResolver from \"./SesameResolver\";\nimport FluxFilters from \"./FluxFilters\";\nimport VariabilityFilters from \"./VariabilityFilters\";\nimport TagFilter from \"./TagFilter\";\nimport { parseRA, parseDec } from \"../../utils/coordinateParser\";\n\nexport interface SourceQueryParams {\n  // Cone search\n  ra?: number;\n  dec?: number;\n  radius?: number;\n  radiusUnit: \"arcsec\" | \"arcmin\" | \"deg\";\n  coordFrame: \"icrs\" | \"galactic\";\n\n  // Flux filters\n  minFlux?: { min?: number; max?: number; type: \"peak\" | \"int\" };\n  maxFlux?: { min?: number; max?: number; type: \"peak\" | \"int\" };\n  avgFlux?: { min?: number; max?: number; type: \"peak\" | \"int\" };\n\n  // Variability\n  eta?: { min?: number; max?: number; type: \"peak\" | \"int\" };\n  v?: { min?: number; max?: number; type: \"peak\" | \"int\" };\n  vs?: { min?: number; max?: number; type: \"peak\" | \"int\" };\n  m?: { min?: number; max?: number; type: \"peak\" | \"int\" };\n\n  // SNR\n  snrMin?: { min?: number; max?: number };\n  snrMax?: { min?: number; max?: number };\n\n  // Counts\n  datapoints?: { min?: number; max?: number };\n  selavy?: { min?: number; max?: number };\n  forced?: { min?: number; max?: number };\n\n  // Flags\n  newSource?: boolean;\n  noSiblings?: boolean;\n\n  // Tags\n  includeTags: string[];\n  excludeTags: string[];\n\n  // Pipeline run\n  runName?: string;\n}\n\nexport interface AdvancedQueryPanelProps {\n  /** Available pipeline runs */\n  runs?: { id: string; name: string }[];\n  /** Available tags for filtering */\n  availableTags?: string[];\n  /** Callback when query is submitted */\n  onSubmit: (params: SourceQueryParams) => void;\n  /** Callback when query is reset */\n  onReset?: () => void;\n  /** Initial query params (e.g., from URL) */\n  initialParams?: Partial<SourceQueryParams>;\n  /** Custom class name */\n  className?: string;\n}\n\nconst DEFAULT_PARAMS: SourceQueryParams = {\n  radiusUnit: \"arcmin\",\n  coordFrame: \"icrs\",\n  includeTags: [],\n  excludeTags: [],\n};\n\n/**\n * Advanced source query panel with collapsible sections.\n * Inspired by VAST pipeline sources_query.html.\n */\nconst AdvancedQueryPanel: React.FC<AdvancedQueryPanelProps> = ({\n  runs = [],\n  availableTags = [],\n  onSubmit,\n  onReset,\n  initialParams,\n  className = \"\",\n}) => {\n  const [params, setParams] = useState<SourceQueryParams>({\n    ...DEFAULT_PARAMS,\n    ...initialParams,\n  });\n  const [expandedSections, setExpandedSections] = useState<Set<string>>(\n    new Set([\"cone\", \"filters\"])\n  );\n  const [validationErrors, setValidationErrors] = useState<Record<string, string>>({});\n  const [raInput, setRaInput] = useState<string>(initialParams?.ra?.toString() ?? \"\");\n  const [decInput, setDecInput] = useState<string>(initialParams?.dec?.toString() ?? \"\");\n  const debounceTimeoutRef = React.useRef<ReturnType<typeof setTimeout> | null>(null);\n\n  // Parse URL hash into params\n  const parseUrlHash = useCallback((): Partial<SourceQueryParams> => {\n    const hash = window.location.hash.slice(1);\n    if (!hash) return {};\n\n    const urlParams: Partial<SourceQueryParams> = {};\n    hash.split(\"&\").forEach((param) => {\n      const [key, value] = param.split(\"=\");\n      if (!key || !value) return;\n\n      const decoded = decodeURIComponent(value);\n      switch (key) {\n        case \"ra\":\n          urlParams.ra = parseFloat(decoded);\n          break;\n        case \"dec\":\n          urlParams.dec = parseFloat(decoded);\n          break;\n        case \"radius\":\n          urlParams.radius = parseFloat(decoded);\n          break;\n        case \"radius_unit\":\n          if ([\"arcsec\", \"arcmin\", \"deg\"].includes(decoded)) {\n            urlParams.radiusUnit = decoded as \"arcsec\" | \"arcmin\" | \"deg\";\n          }\n          break;\n        case \"coord_frame\":\n          if ([\"icrs\", \"galactic\"].includes(decoded)) {\n            urlParams.coordFrame = decoded as \"icrs\" | \"galactic\";\n          }\n          break;\n        case \"new_source\":\n          urlParams.newSource = decoded === \"true\";\n          break;\n        case \"no_siblings\":\n          urlParams.noSiblings = decoded === \"true\";\n          break;\n        case \"run_name\":\n          urlParams.runName = decoded;\n          break;\n        case \"include_tags\":\n          urlParams.includeTags = decoded.split(\",\").filter(Boolean);\n          break;\n        case \"exclude_tags\":\n          urlParams.excludeTags = decoded.split(\",\").filter(Boolean);\n          break;\n        // Flux filters\n        case \"min_flux_min\":\n          urlParams.minFlux = { ...urlParams.minFlux, min: parseFloat(decoded), type: \"peak\" };\n          break;\n        case \"min_flux_max\":\n          urlParams.minFlux = { ...urlParams.minFlux, max: parseFloat(decoded), type: \"peak\" };\n          break;\n        case \"max_flux_min\":\n          urlParams.maxFlux = { ...urlParams.maxFlux, min: parseFloat(decoded), type: \"peak\" };\n          break;\n        case \"max_flux_max\":\n          urlParams.maxFlux = { ...urlParams.maxFlux, max: parseFloat(decoded), type: \"peak\" };\n          break;\n        // Variability filters\n        case \"eta_min\":\n          urlParams.eta = { ...urlParams.eta, min: parseFloat(decoded), type: \"peak\" };\n          break;\n        case \"eta_max\":\n          urlParams.eta = { ...urlParams.eta, max: parseFloat(decoded), type: \"peak\" };\n          break;\n        case \"v_min\":\n          urlParams.v = { ...urlParams.v, min: parseFloat(decoded), type: \"peak\" };\n          break;\n        case \"v_max\":\n          urlParams.v = { ...urlParams.v, max: parseFloat(decoded), type: \"peak\" };\n          break;\n      }\n    });\n    return urlParams;\n  }, []);\n\n  // Write params to URL hash\n  const writeUrlHash = useCallback((params: SourceQueryParams) => {\n    const parts: string[] = [];\n\n    if (params.ra != null) parts.push(`ra=${params.ra.toFixed(6)}`);\n    if (params.dec != null) parts.push(`dec=${params.dec.toFixed(6)}`);\n    if (params.radius != null) parts.push(`radius=${params.radius}`);\n    if (params.radiusUnit !== DEFAULT_PARAMS.radiusUnit) {\n      parts.push(`radius_unit=${params.radiusUnit}`);\n    }\n    if (params.coordFrame !== DEFAULT_PARAMS.coordFrame) {\n      parts.push(`coord_frame=${params.coordFrame}`);\n    }\n    if (params.newSource) parts.push(\"new_source=true\");\n    if (params.noSiblings) parts.push(\"no_siblings=true\");\n    if (params.runName) parts.push(`run_name=${encodeURIComponent(params.runName)}`);\n    if (params.includeTags.length > 0) {\n      parts.push(`include_tags=${params.includeTags.map(encodeURIComponent).join(\",\")}`);\n    }\n    if (params.excludeTags.length > 0) {\n      parts.push(`exclude_tags=${params.excludeTags.map(encodeURIComponent).join(\",\")}`);\n    }\n    // Flux filters\n    if (params.minFlux?.min != null) parts.push(`min_flux_min=${params.minFlux.min}`);\n    if (params.minFlux?.max != null) parts.push(`min_flux_max=${params.minFlux.max}`);\n    if (params.maxFlux?.min != null) parts.push(`max_flux_min=${params.maxFlux.min}`);\n    if (params.maxFlux?.max != null) parts.push(`max_flux_max=${params.maxFlux.max}`);\n    // Variability filters\n    if (params.eta?.min != null) parts.push(`eta_min=${params.eta.min}`);\n    if (params.eta?.max != null) parts.push(`eta_max=${params.eta.max}`);\n    if (params.v?.min != null) parts.push(`v_min=${params.v.min}`);\n    if (params.v?.max != null) parts.push(`v_max=${params.v.max}`);\n\n    const newHash = parts.length > 0 ? `#${parts.join(\"&\")}` : \"\";\n    if (window.location.hash !== newHash) {\n      window.history.replaceState(null, \"\", newHash || window.location.pathname);\n    }\n  }, []);\n\n  // Validate params\n  const validateParams = useCallback((params: SourceQueryParams): Record<string, string> => {\n    const errors: Record<string, string> = {};\n\n    // Coordinate validation\n    if (params.ra != null && (params.ra < 0 || params.ra > 360)) {\n      errors.ra = \"RA must be between 0 and 360 degrees\";\n    }\n    if (params.dec != null && (params.dec < -90 || params.dec > 90)) {\n      errors.dec = \"Dec must be between -90 and 90 degrees\";\n    }\n    if (params.radius != null && params.radius < 0) {\n      errors.radius = \"Radius must be non-negative\";\n    }\n\n    // Cone search completeness\n    if (\n      (params.ra != null || params.dec != null || params.radius != null) &&\n      (params.ra == null || params.dec == null || params.radius == null)\n    ) {\n      if (params.ra == null) errors.ra = \"RA required for cone search\";\n      if (params.dec == null) errors.dec = \"Dec required for cone search\";\n      if (params.radius == null) errors.radius = \"Radius required for cone search\";\n    }\n\n    return errors;\n  }, []);\n\n  // Load from URL hash on mount\n  useEffect(() => {\n    const urlParams = parseUrlHash();\n    if (Object.keys(urlParams).length > 0) {\n      setParams((prev) => ({ ...prev, ...urlParams }));\n    }\n  }, [parseUrlHash]);\n\n  // Debounced URL sync when params change\n  useEffect(() => {\n    if (debounceTimeoutRef.current) {\n      window.clearTimeout(debounceTimeoutRef.current);\n    }\n    debounceTimeoutRef.current = window.setTimeout(() => {\n      writeUrlHash(params);\n      setValidationErrors(validateParams(params));\n    }, 500);\n\n    return () => {\n      if (debounceTimeoutRef.current) {\n        window.clearTimeout(debounceTimeoutRef.current);\n      }\n    };\n  }, [params, writeUrlHash, validateParams]);\n\n  const toggleSection = useCallback((section: string) => {\n    setExpandedSections((prev) => {\n      const next = new Set(prev);\n      if (next.has(section)) {\n        next.delete(section);\n      } else {\n        next.add(section);\n      }\n      return next;\n    });\n  }, []);\n\n  const handleConeSearchResolved = useCallback((ra: number, dec: number) => {\n    setParams((prev) => ({ ...prev, ra, dec }));\n    setRaInput(ra.toFixed(6));\n    setDecInput(dec.toFixed(6));\n  }, []);\n\n  const handleReset = useCallback(() => {\n    setParams({ ...DEFAULT_PARAMS });\n    setValidationErrors({});\n    setRaInput(\"\");\n    setDecInput(\"\");\n    window.history.replaceState(null, \"\", window.location.pathname);\n    onReset?.();\n  }, [onReset]);\n\n  const handleSubmit = useCallback(() => {\n    const errors = validateParams(params);\n    setValidationErrors(errors);\n    if (Object.keys(errors).length === 0) {\n      onSubmit(params);\n    }\n  }, [params, onSubmit, validateParams]);\n\n  // Count active filters for badge\n  const activeFilterCount = useMemo(() => {\n    let count = 0;\n    if (params.ra != null && params.dec != null) count++;\n    if (params.minFlux?.min != null || params.minFlux?.max != null) count++;\n    if (params.maxFlux?.min != null || params.maxFlux?.max != null) count++;\n    if (params.avgFlux?.min != null || params.avgFlux?.max != null) count++;\n    if (params.eta?.min != null || params.eta?.max != null) count++;\n    if (params.v?.min != null || params.v?.max != null) count++;\n    if (params.snrMin?.min != null || params.snrMin?.max != null) count++;\n    if (params.snrMax?.min != null || params.snrMax?.max != null) count++;\n    if (params.datapoints?.min != null || params.datapoints?.max != null) count++;\n    if (params.newSource) count++;\n    if (params.noSiblings) count++;\n    if (params.includeTags.length > 0) count++;\n    if (params.excludeTags.length > 0) count++;\n    if (params.runName) count++;\n    return count;\n  }, [params]);\n\n  const hasValidationErrors = Object.keys(validationErrors).length > 0;\n\n  const renderSection = (id: string, title: string, children: React.ReactNode) => {\n    const isExpanded = expandedSections.has(id);\n    return (\n      <div className=\"border-b border-gray-200\">\n        <button\n          onClick={() => toggleSection(id)}\n          className=\"w-full flex items-center justify-between px-4 py-3 bg-gray-50 hover:bg-gray-100 transition-colors\"\n        >\n          <span className=\"font-semibold text-gray-700\">{title}</span>\n          <svg\n            className={`w-5 h-5 text-gray-500 transition-transform ${\n              isExpanded ? \"rotate-180\" : \"\"\n            }`}\n            fill=\"none\"\n            stroke=\"currentColor\"\n            viewBox=\"0 0 24 24\"\n          >\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 9l-7 7-7-7\" />\n          </svg>\n        </button>\n        {isExpanded && <div className=\"p-4 space-y-4\">{children}</div>}\n      </div>\n    );\n  };\n\n  return (\n    <div className={`card ${className}`}>\n      <div className=\"card-header flex items-center justify-between\">\n        <h4 className=\"text-lg font-semibold flex items-center gap-2\">\n          Source Query\n          {activeFilterCount > 0 && (\n            <span className=\"badge badge-primary\">{activeFilterCount} filters</span>\n          )}\n        </h4>\n        <button onClick={handleReset} className=\"text-sm text-gray-500 hover:text-red-500\">\n          Reset all\n        </button>\n      </div>\n\n      <div className=\"divide-y divide-gray-200\">\n        {/* Data Source */}\n        {renderSection(\n          \"source\",\n          \"Data Source\",\n          <div className=\"form-group\">\n            <label className=\"form-label\">Pipeline Run</label>\n            <select\n              value={params.runName || \"\"}\n              onChange={(e) =>\n                setParams((prev) => ({ ...prev, runName: e.target.value || undefined }))\n              }\n              className=\"form-select w-full\"\n            >\n              <option value=\"\">All Runs</option>\n              {runs.map((run) => (\n                <option key={run.id} value={run.name}>\n                  {run.name}\n                </option>\n              ))}\n            </select>\n          </div>\n        )}\n\n        {/* Cone Search */}\n        {renderSection(\n          \"cone\",\n          \"Cone Search\",\n          <>\n            <SesameResolver onResolved={handleConeSearchResolved} />\n\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div className=\"form-group\">\n                <label className=\"form-label\">RA (deg or HMS)</label>\n                <input\n                  type=\"text\"\n                  value={raInput}\n                  onChange={(e) => {\n                    const value = e.target.value;\n                    setRaInput(value);\n                    // Try to parse and update params\n                    const parsed = parseRA(value);\n                    setParams((prev) => ({\n                      ...prev,\n                      ra: parsed ?? undefined,\n                    }));\n                  }}\n                  onBlur={() => {\n                    // On blur, normalize to decimal if valid\n                    if (params.ra != null) {\n                      setRaInput(params.ra.toFixed(6));\n                    }\n                  }}\n                  placeholder=\"180.0 or 12:00:00\"\n                  className={`form-control ${validationErrors.ra ? \"border-red-500\" : \"\"}`}\n                />\n                {validationErrors.ra && (\n                  <p className=\"text-xs text-red-500 mt-1\">{validationErrors.ra}</p>\n                )}\n              </div>\n              <div className=\"form-group\">\n                <label className=\"form-label\">Dec (deg or DMS)</label>\n                <input\n                  type=\"text\"\n                  value={decInput}\n                  onChange={(e) => {\n                    const value = e.target.value;\n                    setDecInput(value);\n                    // Try to parse and update params\n                    const parsed = parseDec(value);\n                    setParams((prev) => ({\n                      ...prev,\n                      dec: parsed ?? undefined,\n                    }));\n                  }}\n                  onBlur={() => {\n                    // On blur, normalize to decimal if valid\n                    if (params.dec != null) {\n                      setDecInput(params.dec.toFixed(6));\n                    }\n                  }}\n                  placeholder=\"+45.0 or +45:00:00\"\n                  className={`form-control ${validationErrors.dec ? \"border-red-500\" : \"\"}`}\n                />\n                {validationErrors.dec && (\n                  <p className=\"text-xs text-red-500 mt-1\">{validationErrors.dec}</p>\n                )}\n              </div>\n            </div>\n\n            <div className=\"grid grid-cols-3 gap-4\">\n              <div className=\"form-group\">\n                <label className=\"form-label\">Radius</label>\n                <input\n                  type=\"number\"\n                  value={params.radius ?? \"\"}\n                  onChange={(e) =>\n                    setParams((prev) => ({\n                      ...prev,\n                      radius: e.target.value ? parseFloat(e.target.value) : undefined,\n                    }))\n                  }\n                  placeholder=\"2\"\n                  min={0}\n                  step={0.1}\n                  className={`form-control ${validationErrors.radius ? \"border-red-500\" : \"\"}`}\n                />\n                {validationErrors.radius && (\n                  <p className=\"text-xs text-red-500 mt-1\">{validationErrors.radius}</p>\n                )}\n              </div>\n              <div className=\"form-group\">\n                <label className=\"form-label\">Unit</label>\n                <select\n                  value={params.radiusUnit}\n                  onChange={(e) =>\n                    setParams((prev) => ({\n                      ...prev,\n                      radiusUnit: e.target.value as \"arcsec\" | \"arcmin\" | \"deg\",\n                    }))\n                  }\n                  className=\"form-select\"\n                >\n                  <option value=\"arcsec\">arcsec</option>\n                  <option value=\"arcmin\">arcmin</option>\n                  <option value=\"deg\">deg</option>\n                </select>\n              </div>\n              <div className=\"form-group\">\n                <label className=\"form-label\">Frame</label>\n                <select\n                  value={params.coordFrame}\n                  onChange={(e) =>\n                    setParams((prev) => ({\n                      ...prev,\n                      coordFrame: e.target.value as \"icrs\" | \"galactic\",\n                    }))\n                  }\n                  className=\"form-select\"\n                >\n                  <option value=\"icrs\">ICRS</option>\n                  <option value=\"galactic\">Galactic</option>\n                </select>\n              </div>\n            </div>\n          </>\n        )}\n\n        {/* Flux Filters */}\n        {renderSection(\n          \"flux\",\n          \"Flux Filters\",\n          <FluxFilters\n            values={{\n              minFlux: params.minFlux,\n              maxFlux: params.maxFlux,\n              avgFlux: params.avgFlux,\n            }}\n            onChange={(fluxValues) => setParams((prev) => ({ ...prev, ...fluxValues }))}\n          />\n        )}\n\n        {/* Variability Filters */}\n        {renderSection(\n          \"variability\",\n          \"Variability Metrics\",\n          <VariabilityFilters\n            values={{\n              eta: params.eta,\n              v: params.v,\n              vs: params.vs,\n              m: params.m,\n            }}\n            onChange={(varValues) => setParams((prev) => ({ ...prev, ...varValues }))}\n          />\n        )}\n\n        {/* SNR & Counts */}\n        {renderSection(\n          \"snr\",\n          \"SNR & Data Counts\",\n          <div className=\"space-y-4\">\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div className=\"form-group\">\n                <label className=\"form-label\">Min SNR</label>\n                <div className=\"grid grid-cols-2 gap-2\">\n                  <input\n                    type=\"number\"\n                    value={params.snrMin?.min ?? \"\"}\n                    onChange={(e) =>\n                      setParams((prev) => ({\n                        ...prev,\n                        snrMin: {\n                          ...prev.snrMin,\n                          min: e.target.value ? Number(e.target.value) : undefined,\n                        },\n                      }))\n                    }\n                    placeholder=\"Min\"\n                    className=\"form-control\"\n                  />\n                  <input\n                    type=\"number\"\n                    value={params.snrMin?.max ?? \"\"}\n                    onChange={(e) =>\n                      setParams((prev) => ({\n                        ...prev,\n                        snrMin: {\n                          ...prev.snrMin,\n                          max: e.target.value ? Number(e.target.value) : undefined,\n                        },\n                      }))\n                    }\n                    placeholder=\"Max\"\n                    className=\"form-control\"\n                  />\n                </div>\n              </div>\n              <div className=\"form-group\">\n                <label className=\"form-label\">Max SNR</label>\n                <div className=\"grid grid-cols-2 gap-2\">\n                  <input\n                    type=\"number\"\n                    value={params.snrMax?.min ?? \"\"}\n                    onChange={(e) =>\n                      setParams((prev) => ({\n                        ...prev,\n                        snrMax: {\n                          ...prev.snrMax,\n                          min: e.target.value ? Number(e.target.value) : undefined,\n                        },\n                      }))\n                    }\n                    placeholder=\"Min\"\n                    className=\"form-control\"\n                  />\n                  <input\n                    type=\"number\"\n                    value={params.snrMax?.max ?? \"\"}\n                    onChange={(e) =>\n                      setParams((prev) => ({\n                        ...prev,\n                        snrMax: {\n                          ...prev.snrMax,\n                          max: e.target.value ? Number(e.target.value) : undefined,\n                        },\n                      }))\n                    }\n                    placeholder=\"Max\"\n                    className=\"form-control\"\n                  />\n                </div>\n              </div>\n            </div>\n\n            <div className=\"form-group\">\n              <label className=\"form-label\">Datapoints</label>\n              <div className=\"grid grid-cols-2 gap-2\">\n                <input\n                  type=\"number\"\n                  value={params.datapoints?.min ?? \"\"}\n                  onChange={(e) =>\n                    setParams((prev) => ({\n                      ...prev,\n                      datapoints: {\n                        ...prev.datapoints,\n                        min: e.target.value ? Number(e.target.value) : undefined,\n                      },\n                    }))\n                  }\n                  placeholder=\"Min\"\n                  min={1}\n                  className=\"form-control\"\n                />\n                <input\n                  type=\"number\"\n                  value={params.datapoints?.max ?? \"\"}\n                  onChange={(e) =>\n                    setParams((prev) => ({\n                      ...prev,\n                      datapoints: {\n                        ...prev.datapoints,\n                        max: e.target.value ? Number(e.target.value) : undefined,\n                      },\n                    }))\n                  }\n                  placeholder=\"Max\"\n                  min={1}\n                  className=\"form-control\"\n                />\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* Source Type Flags */}\n        {renderSection(\n          \"flags\",\n          \"Source Type\",\n          <div className=\"space-y-3\">\n            <label className=\"flex items-center gap-2 cursor-pointer\">\n              <input\n                type=\"checkbox\"\n                checked={params.newSource || false}\n                onChange={(e) => setParams((prev) => ({ ...prev, newSource: e.target.checked }))}\n                className=\"w-4 h-4 text-vast-green rounded\"\n              />\n              <span>New source</span>\n              <span className=\"text-gray-400 text-sm\">(appeared after first observation)</span>\n            </label>\n            <label className=\"flex items-center gap-2 cursor-pointer\">\n              <input\n                type=\"checkbox\"\n                checked={params.noSiblings || false}\n                onChange={(e) => setParams((prev) => ({ ...prev, noSiblings: e.target.checked }))}\n                className=\"w-4 h-4 text-vast-green rounded\"\n              />\n              <span>No siblings</span>\n              <span className=\"text-gray-400 text-sm\">(no multi-component islands)</span>\n            </label>\n          </div>\n        )}\n\n        {/* Tags */}\n        {renderSection(\n          \"tags\",\n          \"Tags\",\n          <TagFilter\n            availableTags={availableTags}\n            includeTags={params.includeTags}\n            excludeTags={params.excludeTags}\n            onIncludeChange={(tags) => setParams((prev) => ({ ...prev, includeTags: tags }))}\n            onExcludeChange={(tags) => setParams((prev) => ({ ...prev, excludeTags: tags }))}\n          />\n        )}\n      </div>\n\n      {/* Validation Errors */}\n      {hasValidationErrors && (\n        <div className=\"px-4 py-2 bg-red-50 border-t border-red-200\">\n          <ul className=\"text-sm text-red-600 list-disc list-inside\">\n            {Object.entries(validationErrors).map(([field, error]) => (\n              <li key={field}>{error}</li>\n            ))}\n          </ul>\n        </div>\n      )}\n\n      {/* Action Buttons */}\n      <div className=\"p-4 bg-gray-50 border-t border-gray-200 flex justify-end gap-2\">\n        <button onClick={handleReset} className=\"btn btn-secondary\">\n          Reset\n        </button>\n        <button\n          onClick={handleSubmit}\n          className={`btn btn-primary ${hasValidationErrors ? \"opacity-75\" : \"\"}`}\n          disabled={hasValidationErrors}\n        >\n          Search\n        </button>\n      </div>\n    </div>\n  );\n};\n\nexport default AdvancedQueryPanel;\n","import React from \"react\";\n\nexport interface VariabilityControlsProps {\n  /** Current η threshold */\n  etaThreshold: number;\n  /** Current V threshold */\n  vThreshold: number;\n  /** η sigma multiplier for dynamic threshold */\n  etaSigma: number;\n  /** V sigma multiplier for dynamic threshold */\n  vSigma: number;\n  /** Whether to use sigma-based thresholds */\n  useSigmaThreshold: boolean;\n  /** Min number of data points filter */\n  minDataPoints: number;\n  /** Color by field */\n  colorBy: \"variability\" | \"flux\" | \"measurements\" | \"none\";\n  /** Change handler */\n  onChange: (values: Partial<VariabilityControlsValues>) => void;\n}\n\nexport interface VariabilityControlsValues {\n  etaThreshold: number;\n  vThreshold: number;\n  etaSigma: number;\n  vSigma: number;\n  useSigmaThreshold: boolean;\n  minDataPoints: number;\n  colorBy: \"variability\" | \"flux\" | \"measurements\" | \"none\";\n}\n\n/**\n * Controls panel for η-V plot customization.\n */\nconst VariabilityControls: React.FC<VariabilityControlsProps> = ({\n  etaThreshold,\n  vThreshold,\n  etaSigma,\n  vSigma,\n  useSigmaThreshold,\n  minDataPoints,\n  colorBy,\n  onChange,\n}) => {\n  return (\n    <div className=\"bg-white border border-gray-200 rounded-lg p-4 space-y-4\">\n      {/* Threshold mode toggle */}\n      <div>\n        <label className=\"flex items-center gap-2 cursor-pointer\">\n          <input\n            type=\"checkbox\"\n            checked={useSigmaThreshold}\n            onChange={(e) => onChange({ useSigmaThreshold: e.target.checked })}\n            className=\"w-4 h-4 rounded\"\n          />\n          <span className=\"text-sm\">Use σ-based thresholds</span>\n        </label>\n        <p className=\"text-xs text-gray-500 mt-1\">\n          Calculate thresholds dynamically based on standard deviation\n        </p>\n      </div>\n\n      {/* Sigma sliders (when sigma mode enabled) */}\n      {useSigmaThreshold && (\n        <div className=\"space-y-3 pl-2 border-l-2 border-primary\">\n          <div>\n            <label className=\"flex items-center justify-between text-sm mb-1\">\n              <span>η threshold: {etaSigma}σ</span>\n              <span className=\"text-gray-500 text-xs\">above mean</span>\n            </label>\n            <input\n              type=\"range\"\n              min={1}\n              max={5}\n              step={0.5}\n              value={etaSigma}\n              onChange={(e) => onChange({ etaSigma: parseFloat(e.target.value) })}\n              className=\"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-primary\"\n            />\n          </div>\n          <div>\n            <label className=\"flex items-center justify-between text-sm mb-1\">\n              <span>V threshold: {vSigma}σ</span>\n              <span className=\"text-gray-500 text-xs\">above mean</span>\n            </label>\n            <input\n              type=\"range\"\n              min={1}\n              max={5}\n              step={0.5}\n              value={vSigma}\n              onChange={(e) => onChange({ vSigma: parseFloat(e.target.value) })}\n              className=\"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-primary\"\n            />\n          </div>\n        </div>\n      )}\n\n      {/* Fixed threshold inputs (when sigma mode disabled) */}\n      {!useSigmaThreshold && (\n        <div className=\"grid grid-cols-2 gap-3\">\n          <div>\n            <label className=\"block text-sm mb-1\">η threshold</label>\n            <input\n              type=\"number\"\n              value={etaThreshold}\n              onChange={(e) => onChange({ etaThreshold: parseFloat(e.target.value) || 0 })}\n              step={0.1}\n              className=\"w-full px-2 py-1 border border-gray-300 rounded text-sm\"\n            />\n          </div>\n          <div>\n            <label className=\"block text-sm mb-1\">V threshold</label>\n            <input\n              type=\"number\"\n              value={vThreshold}\n              onChange={(e) => onChange({ vThreshold: parseFloat(e.target.value) || 0 })}\n              step={0.01}\n              className=\"w-full px-2 py-1 border border-gray-300 rounded text-sm\"\n            />\n          </div>\n        </div>\n      )}\n\n      {/* Min data points filter */}\n      <div>\n        <label className=\"block text-sm mb-1\">Min data points: {minDataPoints}</label>\n        <input\n          type=\"range\"\n          min={2}\n          max={20}\n          value={minDataPoints}\n          onChange={(e) => onChange({ minDataPoints: parseInt(e.target.value, 10) })}\n          className=\"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-primary\"\n        />\n        <div className=\"flex justify-between text-xs text-gray-400\">\n          <span>2</span>\n          <span>20</span>\n        </div>\n      </div>\n\n      {/* Color by selector */}\n      <div>\n        <label className=\"block text-sm mb-1\">Color by</label>\n        <select\n          value={colorBy}\n          onChange={(e) =>\n            onChange({\n              colorBy: e.target.value as VariabilityControlsValues[\"colorBy\"],\n            })\n          }\n          className=\"w-full px-2 py-1 border border-gray-300 rounded text-sm\"\n        >\n          <option value=\"variability\">Variability (η × V)</option>\n          <option value=\"flux\">Peak Flux</option>\n          <option value=\"measurements\">N Measurements</option>\n          <option value=\"none\">No color gradient</option>\n        </select>\n      </div>\n    </div>\n  );\n};\n\nexport default VariabilityControls;\n","import React from \"react\";\n\nexport interface SourcePreviewProps {\n  /** Source identifier */\n  sourceId: string;\n  /** Source name */\n  name: string;\n  /** RA coordinate (degrees) */\n  ra: number;\n  /** Dec coordinate (degrees) */\n  dec: number;\n  /** η value */\n  eta: number;\n  /** V value */\n  v: number;\n  /** Peak flux in mJy */\n  peakFlux?: number;\n  /** Number of measurements */\n  nMeasurements?: number;\n  /** Position for tooltip (screen coordinates) */\n  position?: { x: number; y: number };\n  /** Whether this is a hover preview or selected */\n  isHover?: boolean;\n  /** Click handler */\n  onNavigate?: (sourceId: string) => void;\n  /** Close handler */\n  onClose?: () => void;\n}\n\n/**\n * Quick preview tooltip/card for source on η-V plot.\n */\nconst SourcePreview: React.FC<SourcePreviewProps> = ({\n  sourceId,\n  name,\n  ra,\n  dec,\n  eta,\n  v,\n  peakFlux,\n  nMeasurements,\n  position,\n  isHover = true,\n  onNavigate,\n  onClose,\n}) => {\n  const formatCoord = (value: number, isRa: boolean) => {\n    if (isRa) {\n      const hours = value / 15;\n      const h = Math.floor(hours);\n      const m = Math.floor((hours - h) * 60);\n      const s = ((hours - h - m / 60) * 3600).toFixed(2);\n      return `${h}h ${m}m ${s}s`;\n    } else {\n      const sign = value >= 0 ? \"+\" : \"\";\n      const d = Math.floor(Math.abs(value));\n      const m = Math.floor((Math.abs(value) - d) * 60);\n      const s = ((Math.abs(value) - d - m / 60) * 3600).toFixed(1);\n      return `${sign}${d}° ${m}' ${s}\"`;\n    }\n  };\n\n  const style: React.CSSProperties = position\n    ? {\n        position: \"absolute\",\n        left: position.x + 10,\n        top: position.y + 10,\n        zIndex: 1000,\n      }\n    : {};\n\n  return (\n    <div\n      className={`bg-white border border-gray-200 rounded-lg shadow-lg p-3 ${\n        isHover ? \"min-w-48\" : \"min-w-64\"\n      }`}\n      style={style}\n    >\n      {/* Header */}\n      <div className=\"flex items-center justify-between mb-2\">\n        <span className=\"font-semibold text-sm text-gray-800 truncate\">{name || sourceId}</span>\n        {!isHover && onClose && (\n          <button\n            onClick={onClose}\n            className=\"text-gray-400 hover:text-gray-600 text-lg leading-none\"\n          >\n            ×\n          </button>\n        )}\n      </div>\n\n      {/* Coordinates */}\n      <div className=\"text-xs text-gray-500 mb-2\">\n        <div>RA: {formatCoord(ra, true)}</div>\n        <div>Dec: {formatCoord(dec, false)}</div>\n      </div>\n\n      {/* Variability metrics */}\n      <div className=\"flex gap-4 mb-2\">\n        <div className=\"text-center\">\n          <div className=\"text-lg font-semibold text-primary\">{eta.toFixed(2)}</div>\n          <div className=\"text-xs text-gray-500\">η</div>\n        </div>\n        <div className=\"text-center\">\n          <div className=\"text-lg font-semibold text-primary\">{v.toFixed(3)}</div>\n          <div className=\"text-xs text-gray-500\">V</div>\n        </div>\n        {peakFlux !== undefined && (\n          <div className=\"text-center\">\n            <div className=\"text-lg font-semibold text-gray-700\">{peakFlux.toFixed(2)}</div>\n            <div className=\"text-xs text-gray-500\">mJy</div>\n          </div>\n        )}\n        {nMeasurements !== undefined && (\n          <div className=\"text-center\">\n            <div className=\"text-lg font-semibold text-gray-700\">{nMeasurements}</div>\n            <div className=\"text-xs text-gray-500\">pts</div>\n          </div>\n        )}\n      </div>\n\n      {/* Action button */}\n      {!isHover && onNavigate && (\n        <button\n          onClick={() => onNavigate(sourceId)}\n          className=\"w-full text-sm bg-primary text-white py-1.5 rounded hover:bg-primary-dark transition-colors\"\n        >\n          View Source Details\n        </button>\n      )}\n    </div>\n  );\n};\n\nexport default SourcePreview;\n","import React, { useEffect, useRef, useState, useCallback, useMemo } from \"react\";\nimport * as echarts from \"echarts\";\nimport VariabilityControls, { VariabilityControlsValues } from \"./VariabilityControls\";\nimport SourcePreview from \"./SourcePreview\";\n\nexport interface SourcePoint {\n  id: string;\n  name: string;\n  ra: number;\n  dec: number;\n  eta: number;\n  v: number;\n  peakFlux?: number;\n  nMeasurements?: number;\n}\n\nexport interface EtaVPlotProps {\n  /** Source data to plot */\n  sources: SourcePoint[];\n  /** Whether data is loading */\n  isLoading?: boolean;\n  /** Callback when source is selected */\n  onSourceSelect?: (sourceId: string) => void;\n  /** Height of the chart */\n  height?: number;\n  /** Custom class name */\n  className?: string;\n}\n\n/**\n * η-V variability scatter plot using ECharts.\n * Highlights potential transient candidates above thresholds.\n */\nconst EtaVPlot: React.FC<EtaVPlotProps> = ({\n  sources,\n  isLoading = false,\n  onSourceSelect,\n  height = 500,\n  className = \"\",\n}) => {\n  const chartRef = useRef<HTMLDivElement>(null);\n  const chartInstance = useRef<echarts.ECharts | null>(null);\n\n  // Control state\n  const [controls, setControls] = useState<VariabilityControlsValues>({\n    etaThreshold: 1.5,\n    vThreshold: 0.1,\n    etaSigma: 2,\n    vSigma: 2,\n    useSigmaThreshold: true,\n    minDataPoints: 3,\n    colorBy: \"variability\",\n  });\n\n  // Preview state\n  const [hoverSource, setHoverSource] = useState<SourcePoint | null>(null);\n  const [hoverPosition, setHoverPosition] = useState({ x: 0, y: 0 });\n  const [selectedSource, setSelectedSource] = useState<SourcePoint | null>(null);\n\n  // Escape key handler for modal\n  useEffect(() => {\n    const handleKeyDown = (e: KeyboardEvent) => {\n      if (e.key === \"Escape\" && selectedSource) {\n        setSelectedSource(null);\n      }\n    };\n    if (selectedSource) {\n      window.addEventListener(\"keydown\", handleKeyDown);\n      return () => window.removeEventListener(\"keydown\", handleKeyDown);\n    }\n  }, [selectedSource]);\n\n  // Calculate dynamic thresholds\n  const calculateThresholds = useCallback(() => {\n    if (!controls.useSigmaThreshold || sources.length === 0) {\n      return { etaLine: controls.etaThreshold, vLine: controls.vThreshold };\n    }\n\n    const etaValues = sources.map((s) => s.eta);\n    const vValues = sources.map((s) => s.v);\n\n    const mean = (arr: number[]) => arr.reduce((a, b) => a + b, 0) / arr.length;\n    const std = (arr: number[]) => {\n      const m = mean(arr);\n      return Math.sqrt(arr.reduce((sum, x) => sum + (x - m) ** 2, 0) / arr.length);\n    };\n\n    const etaMean = mean(etaValues);\n    const etaStd = std(etaValues);\n    const vMean = mean(vValues);\n    const vStd = std(vValues);\n\n    return {\n      etaLine: etaMean + controls.etaSigma * etaStd,\n      vLine: vMean + controls.vSigma * vStd,\n    };\n  }, [sources, controls]);\n\n  // Filter sources by min data points and ensure positive values for log scale\n  const filteredSources = useMemo(\n    () =>\n      sources.filter(\n        (s) => (s.nMeasurements ?? 10) >= controls.minDataPoints && s.eta > 0 && s.v > 0 // Filter out non-positive values for log scale\n      ),\n    [sources, controls.minDataPoints]\n  );\n\n  // Count filtered out sources\n  const filteredOutCount = sources.length - filteredSources.length;\n\n  // Identify candidates (above both thresholds)\n  const { etaLine, vLine } = calculateThresholds();\n  const candidates = useMemo(\n    () => filteredSources.filter((s) => s.eta > etaLine && s.v > vLine),\n    [filteredSources, etaLine, vLine]\n  );\n\n  // Pre-compute max values once to avoid O(n²) in color mapping\n  const colorMaxValues = useMemo(() => {\n    if (filteredSources.length === 0) return { variability: 1, flux: 1, measurements: 1 };\n    return {\n      variability: Math.max(...filteredSources.map((s) => s.eta * s.v), 1),\n      flux: Math.max(...filteredSources.map((s) => s.peakFlux ?? 0), 1),\n      measurements: Math.max(...filteredSources.map((s) => s.nMeasurements ?? 0), 1),\n    };\n  }, [filteredSources]);\n\n  // Color mapping function - now O(1) per point\n  const getPointColor = useCallback(\n    (source: SourcePoint, isCandidate: boolean) => {\n      if (isCandidate) return \"#ff0000\";\n      if (controls.colorBy === \"none\") return \"rgba(79, 195, 161, 0.6)\";\n\n      let value = 0;\n      let max = 1;\n\n      switch (controls.colorBy) {\n        case \"variability\":\n          value = source.eta * source.v;\n          max = colorMaxValues.variability;\n          break;\n        case \"flux\":\n          value = source.peakFlux ?? 0;\n          max = colorMaxValues.flux;\n          break;\n        case \"measurements\":\n          value = source.nMeasurements ?? 0;\n          max = colorMaxValues.measurements;\n          break;\n      }\n\n      const ratio = Math.min(value / max, 1);\n      // Gradient from green (#4fc3a1) to yellow (#f0c674)\n      const r = Math.round(79 + ratio * (240 - 79));\n      const g = Math.round(195 + ratio * (198 - 195));\n      const b = Math.round(161 - ratio * (161 - 116));\n      return `rgba(${r}, ${g}, ${b}, 0.7)`;\n    },\n    [controls.colorBy, colorMaxValues]\n  );\n\n  // Initialize chart\n  useEffect(() => {\n    if (!chartRef.current) return;\n\n    chartInstance.current = echarts.init(chartRef.current);\n\n    const handleResize = () => {\n      chartInstance.current?.resize();\n    };\n    window.addEventListener(\"resize\", handleResize);\n\n    return () => {\n      window.removeEventListener(\"resize\", handleResize);\n      chartInstance.current?.dispose();\n    };\n  }, []);\n\n  // Update chart\n  useEffect(() => {\n    if (!chartInstance.current || isLoading) return;\n\n    const candidateIds = new Set(candidates.map((c) => c.id));\n\n    // Prepare scatter data\n    const scatterData = filteredSources.map((source) => ({\n      value: [source.eta, source.v],\n      itemStyle: {\n        color: getPointColor(source, candidateIds.has(source.id)),\n      },\n      symbolSize: candidateIds.has(source.id) ? 10 : 6,\n      source,\n    }));\n\n    // Compute data bounds for threshold lines (log scale doesn't support \"min\"/\"max\")\n    const etaValues = filteredSources.map((s) => s.eta);\n    const vValues = filteredSources.map((s) => s.v);\n    const etaMin = Math.min(...etaValues) * 0.5;\n    const etaMax = Math.max(...etaValues) * 2;\n    const vMin = Math.min(...vValues) * 0.5;\n    const vMax = Math.max(...vValues) * 2;\n\n    // Build subtitle with excluded count info\n    const excludedInfo = filteredOutCount > 0 ? ` (${filteredOutCount} excluded: η≤0 or v≤0)` : \"\";\n    const subtext = `${filteredSources.length} sources, ${candidates.length} candidates${excludedInfo}`;\n\n    const option: echarts.EChartsOption = {\n      title: {\n        text: \"η-V Variability Plot\",\n        subtext,\n        left: \"center\",\n        textStyle: { color: \"#324960\", fontSize: 16 },\n        subtextStyle: { color: \"#666\" },\n      },\n      tooltip: {\n        trigger: \"item\",\n        formatter: () => \"\",\n        show: false,\n      },\n      xAxis: {\n        name: \"η (eta)\",\n        nameLocation: \"middle\",\n        nameGap: 30,\n        type: \"log\",\n        axisLabel: { formatter: \"{value}\" },\n      },\n      yAxis: {\n        name: \"V\",\n        nameLocation: \"middle\",\n        nameGap: 40,\n        type: \"log\",\n      },\n      series: [\n        {\n          type: \"scatter\",\n          data: scatterData,\n          emphasis: {\n            itemStyle: {\n              borderColor: \"#324960\",\n              borderWidth: 2,\n            },\n          },\n        },\n        // η threshold line - use computed bounds for log scale\n        {\n          type: \"line\",\n          markLine: {\n            silent: true,\n            symbol: \"none\",\n            lineStyle: { color: \"#ff6b6b\", type: \"dashed\", width: 2 },\n            data: [\n              [\n                { xAxis: etaLine, yAxis: vMin },\n                { xAxis: etaLine, yAxis: vMax },\n              ],\n            ],\n            label: {\n              formatter: `η = ${etaLine.toFixed(2)}`,\n              position: \"end\",\n            },\n          },\n        },\n        // V threshold line - use computed bounds for log scale\n        {\n          type: \"line\",\n          markLine: {\n            silent: true,\n            symbol: \"none\",\n            lineStyle: { color: \"#ff6b6b\", type: \"dashed\", width: 2 },\n            data: [\n              [\n                { xAxis: etaMin, yAxis: vLine },\n                { xAxis: etaMax, yAxis: vLine },\n              ],\n            ],\n            label: {\n              formatter: `V = ${vLine.toFixed(3)}`,\n              position: \"end\",\n            },\n          },\n        },\n      ],\n      toolbox: {\n        right: 20,\n        feature: {\n          dataZoom: { title: { zoom: \"Zoom\", back: \"Reset\" } },\n          restore: { title: \"Reset\" },\n          saveAsImage: { title: \"Save\" },\n        },\n      },\n      dataZoom: [\n        { type: \"inside\", xAxisIndex: 0 },\n        { type: \"inside\", yAxisIndex: 0 },\n      ],\n    };\n\n    chartInstance.current.setOption(option, { notMerge: false });\n\n    // Clean up previous event handlers before adding new ones\n    const chart = chartInstance.current;\n    chart.off(\"mouseover\");\n    chart.off(\"mouseout\");\n    chart.off(\"click\");\n\n    // Event handlers\n    chart.on(\"mouseover\", (params: any) => {\n      if (params.componentType === \"series\" && params.data?.source) {\n        const event = params.event?.event;\n        setHoverSource(params.data.source);\n        if (event) {\n          setHoverPosition({ x: event.clientX, y: event.clientY });\n        }\n      }\n    });\n\n    chart.on(\"mouseout\", () => {\n      setHoverSource(null);\n    });\n\n    chart.on(\"click\", (params: any) => {\n      if (params.componentType === \"series\" && params.data?.source) {\n        setSelectedSource(params.data.source);\n        setHoverSource(null);\n      }\n    });\n  }, [\n    filteredSources,\n    filteredOutCount,\n    candidates,\n    controls,\n    isLoading,\n    etaLine,\n    vLine,\n    getPointColor,\n  ]);\n\n  const handleControlChange = (values: Partial<VariabilityControlsValues>) => {\n    setControls((prev) => ({ ...prev, ...values }));\n  };\n\n  const handleNavigate = (sourceId: string) => {\n    onSourceSelect?.(sourceId);\n    setSelectedSource(null);\n  };\n\n  return (\n    <div className={`${className}`}>\n      <div className=\"flex gap-4\">\n        {/* Chart area */}\n        <div className=\"flex-1 relative\">\n          {isLoading ? (\n            <div\n              className=\"flex items-center justify-center bg-gray-50 rounded-lg\"\n              style={{ height }}\n            >\n              <div className=\"text-center\">\n                <div className=\"w-8 h-8 border-4 border-primary border-t-transparent rounded-full animate-spin mx-auto mb-2\" />\n                <span className=\"text-gray-500\">Loading sources...</span>\n              </div>\n            </div>\n          ) : (\n            <div ref={chartRef} style={{ height, width: \"100%\" }} />\n          )}\n\n          {/* Hover preview */}\n          {hoverSource && (\n            <SourcePreview\n              {...hoverSource}\n              sourceId={hoverSource.id}\n              position={hoverPosition}\n              isHover={true}\n            />\n          )}\n        </div>\n\n        {/* Controls panel */}\n        <div className=\"w-64 flex-shrink-0\">\n          <VariabilityControls {...controls} onChange={handleControlChange} />\n\n          {/* Candidates list */}\n          {candidates.length > 0 && (\n            <div className=\"mt-4 bg-red-50 border border-red-200 rounded-lg p-3\">\n              <h4 className=\"font-semibold text-red-700 text-sm mb-2\">\n                Candidates ({candidates.length})\n              </h4>\n              <div className=\"max-h-40 overflow-y-auto space-y-1\">\n                {candidates.slice(0, 10).map((c) => (\n                  <button\n                    key={c.id}\n                    onClick={() => setSelectedSource(c)}\n                    className=\"w-full text-left text-xs p-1.5 bg-white rounded hover:bg-red-100 transition-colors\"\n                  >\n                    <span className=\"font-medium\">{c.name || c.id}</span>\n                    <span className=\"text-gray-500 ml-2\">\n                      η={c.eta.toFixed(2)}, V={c.v.toFixed(3)}\n                    </span>\n                  </button>\n                ))}\n                {candidates.length > 10 && (\n                  <p className=\"text-xs text-red-500\">+{candidates.length - 10} more</p>\n                )}\n              </div>\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* Selected source detail */}\n      {selectedSource && (\n        <div className=\"fixed inset-0 bg-black/30 flex items-center justify-center z-50\">\n          <SourcePreview\n            {...selectedSource}\n            sourceId={selectedSource.id}\n            isHover={false}\n            onNavigate={handleNavigate}\n            onClose={() => setSelectedSource(null)}\n          />\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default EtaVPlot;\n","import React, { useState, useMemo, useCallback } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport { useSources } from \"../hooks/useQueries\";\nimport { LoadingSpinner, SortableTableHeader, useTableSort, Modal } from \"../components/common\";\nimport { AdvancedQueryPanel, SourceQueryParams } from \"../components/query\";\nimport { EtaVPlot, SourcePoint } from \"../components/variability\";\nimport {\n  AdvancedFilterPanel,\n  FilterDefinition,\n  FilterValues as AdvFilterValues,\n} from \"../components/filters\";\nimport { useSelectionStore } from \"../stores/appStore\";\n\ninterface Source {\n  id: string;\n  name?: string;\n  ra_deg?: number;\n  dec_deg?: number;\n  num_images?: number;\n  eta?: number;\n  v?: number;\n  peak_flux_jy?: number;\n}\n\n/**\n * List page showing all detected sources with advanced query and variability plot.\n */\nconst SourcesListPage: React.FC = () => {\n  const { data: sources, isLoading, error } = useSources();\n  const [activeTab, setActiveTab] = useState<\"list\" | \"variability\">(\"list\");\n  const [queryParams, setQueryParams] = useState<SourceQueryParams>({});\n  const [showAdvancedFilters, setShowAdvancedFilters] = useState(false);\n  const [advFilterValues, setAdvFilterValues] = useState<AdvFilterValues>({});\n  const [showExportModal, setShowExportModal] = useState(false);\n\n  // Advanced filter definitions\n  const advFilterDefs: FilterDefinition[] = [\n    {\n      id: \"name\",\n      label: \"Name Search\",\n      type: \"text\",\n      group: \"Basic\",\n      placeholder: \"Search by name...\",\n    },\n    {\n      id: \"minFlux\",\n      label: \"Min Flux (Jy)\",\n      type: \"range\",\n      group: \"Flux\",\n      min: 0,\n      max: 1,\n      step: 0.001,\n      unit: \"Jy\",\n    },\n    {\n      id: \"maxFlux\",\n      label: \"Max Flux (Jy)\",\n      type: \"range\",\n      group: \"Flux\",\n      min: 0,\n      max: 1,\n      step: 0.001,\n      unit: \"Jy\",\n    },\n    {\n      id: \"minImages\",\n      label: \"Min Detections\",\n      type: \"range\",\n      group: \"Variability\",\n      min: 1,\n      max: 100,\n      step: 1,\n    },\n    { id: \"variable\", label: \"Variable Only\", type: \"checkbox\", group: \"Variability\" },\n  ];\n\n  // Multi-select state\n  const selectedSources = useSelectionStore((s) => s.selectedSources);\n  const toggleSourceSelection = useSelectionStore((s) => s.toggleSourceSelection);\n  const selectAllSources = useSelectionStore((s) => s.selectAllSources);\n  const clearSourceSelection = useSelectionStore((s) => s.clearSourceSelection);\n\n  const selectedIds = useMemo(() => Array.from(selectedSources), [selectedSources]);\n\n  const handleExportSelected = useCallback(() => {\n    if (selectedIds.length === 0) return;\n    setShowExportModal(true);\n  }, [selectedIds]);\n\n  const confirmExport = useCallback(() => {\n    const baseUrl = import.meta.env.VITE_API_URL || \"/api\";\n    window.open(`${baseUrl}/sources/export?ids=${selectedIds.join(\",\")}`, \"_blank\");\n    setShowExportModal(false);\n  }, [selectedIds]);\n\n  // Filter sources based on query params and advanced filters\n  const filteredSources = useMemo(() => {\n    if (!sources) return [];\n    let result = sources as Source[];\n\n    // Apply cone search filter\n    if (queryParams.ra !== undefined && queryParams.dec !== undefined && queryParams.radius) {\n      const { ra, dec, radius } = queryParams;\n      result = result.filter((s) => {\n        if (s.ra_deg === undefined || s.dec_deg === undefined) return false;\n        // Simple angular distance approximation\n        const dRa = (s.ra_deg - ra) * Math.cos((dec * Math.PI) / 180);\n        const dDec = s.dec_deg - dec;\n        const dist = Math.sqrt(dRa * dRa + dDec * dDec) * 60; // arcmin\n        return dist <= radius;\n      });\n    }\n\n    // Apply flux filter from queryParams\n    if (queryParams.minFlux !== undefined) {\n      result = result.filter((s) => (s.peak_flux_jy ?? 0) >= (queryParams.minFlux ?? 0));\n    }\n    if (queryParams.maxFlux !== undefined) {\n      result = result.filter(\n        (s) => (s.peak_flux_jy ?? Infinity) <= (queryParams.maxFlux ?? Infinity)\n      );\n    }\n\n    // Apply advanced filters\n    if (advFilterValues.name && typeof advFilterValues.name === \"string\") {\n      const term = advFilterValues.name.toLowerCase();\n      result = result.filter(\n        (s) => s.name?.toLowerCase().includes(term) || s.id.toLowerCase().includes(term)\n      );\n    }\n    if (advFilterValues.minImages && typeof advFilterValues.minImages === \"number\") {\n      result = result.filter((s) => (s.num_images ?? 0) >= (advFilterValues.minImages as number));\n    }\n    if (advFilterValues.variable === true) {\n      result = result.filter(\n        (s) => s.eta !== undefined && s.v !== undefined && (s.eta > 2 || s.v > 0.1)\n      );\n    }\n\n    return result;\n  }, [sources, queryParams, advFilterValues]);\n\n  const { sortColumn, sortDirection, handleSort, sortedData } =\n    useTableSort<Source>(filteredSources);\n\n  // Build EtaVPlot data from sources\n  const variabilityData: SourcePoint[] = useMemo(() => {\n    if (!sources) return [];\n    return (sources as Source[])\n      .filter(\n        (s) =>\n          s.eta !== undefined &&\n          s.v !== undefined &&\n          s.ra_deg !== undefined &&\n          s.dec_deg !== undefined\n      )\n      .map((s) => ({\n        id: s.id,\n        name: s.name || s.id,\n        ra: s.ra_deg!,\n        dec: s.dec_deg!,\n        eta: s.eta!,\n        v: s.v!,\n        peakFlux: s.peak_flux_jy,\n        nMeasurements: s.num_images,\n      }));\n  }, [sources]);\n\n  if (isLoading) {\n    return <LoadingSpinner label=\"Loading sources...\" />;\n  }\n\n  if (error) {\n    return (\n      <div className=\"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg\">\n        Failed to load sources: {error.message}\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"max-w-6xl mx-auto\">\n      <div className=\"flex items-center justify-between mb-6\">\n        <div className=\"flex items-center gap-4\">\n          <h1 className=\"text-2xl font-bold text-gray-900\">Sources</h1>\n          {selectedIds.length > 0 && (\n            <span className=\"text-sm text-gray-500\">{selectedIds.length} selected</span>\n          )}\n        </div>\n        <div className=\"flex gap-2\">\n          {selectedIds.length > 0 && (\n            <button\n              onClick={handleExportSelected}\n              className=\"px-4 py-2 rounded-lg text-sm font-medium bg-green-600 text-white hover:bg-green-700 transition-colors\"\n            >\n              Export Selected\n            </button>\n          )}\n          <button\n            className={`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${\n              activeTab === \"list\"\n                ? \"bg-blue-600 text-white\"\n                : \"bg-gray-100 text-gray-700 hover:bg-gray-200\"\n            }`}\n            onClick={() => setActiveTab(\"list\")}\n          >\n            List View\n          </button>\n          <button\n            className={`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${\n              activeTab === \"variability\"\n                ? \"bg-blue-600 text-white\"\n                : \"bg-gray-100 text-gray-700 hover:bg-gray-200\"\n            }`}\n            onClick={() => setActiveTab(\"variability\")}\n          >\n            Variability Plot\n          </button>\n        </div>\n      </div>\n\n      {/* Advanced Query Panel */}\n      <div className=\"mb-6\">\n        <AdvancedQueryPanel onQueryChange={setQueryParams} />\n      </div>\n\n      {/* Advanced Filter Panel (collapsible) */}\n      <div className=\"mb-6\">\n        <button\n          onClick={() => setShowAdvancedFilters(!showAdvancedFilters)}\n          className=\"text-sm text-blue-600 hover:text-blue-800 mb-2\"\n        >\n          {showAdvancedFilters ? \"Hide Advanced Filters\" : \"Show Advanced Filters\"}\n        </button>\n        {showAdvancedFilters && (\n          <AdvancedFilterPanel\n            filters={advFilterDefs}\n            values={advFilterValues}\n            onChange={setAdvFilterValues}\n            onApply={() => {}}\n            onReset={() => setAdvFilterValues({})}\n          />\n        )}\n      </div>\n\n      {/* Export Confirmation Modal */}\n      <Modal\n        isOpen={showExportModal}\n        onClose={() => setShowExportModal(false)}\n        title=\"Export Sources\"\n        size=\"sm\"\n        footer={\n          <div className=\"flex justify-end gap-2\">\n            <button\n              onClick={() => setShowExportModal(false)}\n              className=\"px-4 py-2 text-sm text-gray-700 bg-gray-100 rounded hover:bg-gray-200\"\n            >\n              Cancel\n            </button>\n            <button\n              onClick={confirmExport}\n              className=\"px-4 py-2 text-sm text-white bg-green-600 rounded hover:bg-green-700\"\n            >\n              Export {selectedIds.length} Sources\n            </button>\n          </div>\n        }\n      >\n        <p className=\"text-gray-600\">\n          You are about to export <strong>{selectedIds.length}</strong> selected sources. This will\n          download a CSV file with all source data.\n        </p>\n      </Modal>\n\n      {activeTab === \"variability\" ? (\n        /* Variability Plot Tab */\n        <div className=\"card p-4\">\n          {variabilityData.length > 0 ? (\n            <EtaVPlot\n              sources={variabilityData}\n              onSourceSelect={(sourceId) => (window.location.href = `/sources/${sourceId}`)}\n              height={500}\n            />\n          ) : (\n            <p className=\"text-gray-500 text-center py-8\">\n              No variability data available. Sources need η and V values to display the variability\n              plot.\n            </p>\n          )}\n        </div>\n      ) : (\n        /* List View Tab */\n        <>\n          <p className=\"text-sm text-gray-500 mb-4\">\n            Showing {filteredSources.length} of {(sources as Source[])?.length ?? 0} sources\n          </p>\n\n          {sortedData && sortedData.length > 0 ? (\n            <div className=\"card overflow-hidden\">\n              <table className=\"table\">\n                <thead>\n                  <tr>\n                    <th className=\"w-10 px-3 py-3\">\n                      <input\n                        type=\"checkbox\"\n                        checked={selectedIds.length === sortedData.length && sortedData.length > 0}\n                        ref={(el) => {\n                          if (el)\n                            el.indeterminate =\n                              selectedIds.length > 0 && selectedIds.length < sortedData.length;\n                        }}\n                        onChange={() => {\n                          if (selectedIds.length === sortedData.length) {\n                            clearSourceSelection();\n                          } else {\n                            selectAllSources(sortedData.map((s) => s.id));\n                          }\n                        }}\n                        className=\"h-4 w-4 text-blue-600 rounded\"\n                      />\n                    </th>\n                    <SortableTableHeader\n                      columnKey=\"id\"\n                      sortColumn={sortColumn}\n                      sortDirection={sortDirection}\n                      onSort={handleSort}\n                    >\n                      ID\n                    </SortableTableHeader>\n                    <SortableTableHeader\n                      columnKey=\"name\"\n                      sortColumn={sortColumn}\n                      sortDirection={sortDirection}\n                      onSort={handleSort}\n                    >\n                      Name\n                    </SortableTableHeader>\n                    <SortableTableHeader\n                      columnKey=\"ra_deg\"\n                      sortColumn={sortColumn}\n                      sortDirection={sortDirection}\n                      onSort={handleSort}\n                      className=\"text-right\"\n                    >\n                      RA (deg)\n                    </SortableTableHeader>\n                    <SortableTableHeader\n                      columnKey=\"dec_deg\"\n                      sortColumn={sortColumn}\n                      sortDirection={sortDirection}\n                      onSort={handleSort}\n                      className=\"text-right\"\n                    >\n                      Dec (deg)\n                    </SortableTableHeader>\n                    <SortableTableHeader\n                      columnKey=\"num_images\"\n                      sortColumn={sortColumn}\n                      sortDirection={sortDirection}\n                      onSort={handleSort}\n                      className=\"text-center\"\n                    >\n                      Images\n                    </SortableTableHeader>\n                  </tr>\n                </thead>\n                <tbody className=\"divide-y divide-gray-200\">\n                  {sortedData.map((source) => (\n                    <tr\n                      key={source.id}\n                      className={selectedSources.has(source.id) ? \"bg-blue-50\" : \"\"}\n                    >\n                      <td className=\"px-3\">\n                        <input\n                          type=\"checkbox\"\n                          checked={selectedSources.has(source.id)}\n                          onChange={() => toggleSourceSelection(source.id)}\n                          className=\"h-4 w-4 text-blue-600 rounded\"\n                        />\n                      </td>\n                      <td>\n                        <Link\n                          to={`/sources/${source.id}`}\n                          className=\"text-blue-600 hover:text-blue-800 font-medium\"\n                        >\n                          {source.id}\n                        </Link>\n                      </td>\n                      <td>{source.name || \"—\"}</td>\n                      <td className=\"text-right font-mono\">{source.ra_deg?.toFixed(4)}</td>\n                      <td className=\"text-right font-mono\">{source.dec_deg?.toFixed(4)}</td>\n                      <td className=\"text-center\">{source.num_images ?? \"—\"}</td>\n                    </tr>\n                  ))}\n                </tbody>\n              </table>\n            </div>\n          ) : (\n            <p className=\"text-gray-500\">No sources found.</p>\n          )}\n        </>\n      )}\n    </div>\n  );\n};\n\nexport default SourcesListPage;\n"],"names":["AdvancedFilterPanel","filters","values","onChange","onApply","onReset","className","expandedGroups","setExpandedGroups","useState","groupedFilters","useMemo","groups","filter","group","toggleGroup","useCallback","prev","next","handleFilterChange","filterId","value","activeCount","count","key","f","rangeVal","coneVal","renderFilter","rangeValue","jsx","RangeSlider","minVal","maxVal","jsxs","e","opt","current","v","coneValue","groupFilters","resolveCache","SesameResolver","onResolved","objectName","setObjectName","service","setService","isLoading","setIsLoading","error","setError","result","setResult","abortControllerRef","useRef","resolveObject","trimmedName","cacheKey","cached","url","response","jLine","line","match","ra","dec","resolved","err","message","handleKeyDown","svc","FluxFilters","handleChange","field","subfield","renderFluxRow","label","tooltip","VariabilityFilters","renderMetricRow","showType","TagFilter","availableTags","includeTags","excludeTags","onIncludeChange","onExcludeChange","includeInput","setIncludeInput","excludeInput","setExcludeInput","showIncludeSuggestions","setShowIncludeSuggestions","showExcludeSuggestions","setShowExcludeSuggestions","getFilteredSuggestions","input","currentTags","lower","tag","addTag","setInput","removeTag","t","renderTagInput","tags","showSuggestions","setShowSuggestions","suggestions","suggestion","parseRA","trimmed","decimal","hmsMatch","hours","minutes","seconds","hmsShortMatch","parseDec","sign","working","dmsMatch","degrees","totalDegrees","dmsShortMatch","DEFAULT_PARAMS","AdvancedQueryPanel","runs","onSubmit","initialParams","params","setParams","expandedSections","setExpandedSections","validationErrors","setValidationErrors","raInput","setRaInput","decInput","setDecInput","debounceTimeoutRef","React","parseUrlHash","hash","urlParams","param","decoded","writeUrlHash","parts","newHash","validateParams","errors","useEffect","toggleSection","section","handleConeSearchResolved","handleReset","handleSubmit","activeFilterCount","hasValidationErrors","renderSection","id","title","children","isExpanded","run","Fragment","parsed","fluxValues","varValues","VariabilityControls","etaThreshold","vThreshold","etaSigma","vSigma","useSigmaThreshold","minDataPoints","colorBy","SourcePreview","sourceId","name","eta","peakFlux","nMeasurements","position","isHover","onNavigate","onClose","formatCoord","isRa","h","m","s","d","style","EtaVPlot","sources","onSourceSelect","height","chartRef","chartInstance","controls","setControls","hoverSource","setHoverSource","hoverPosition","setHoverPosition","selectedSource","setSelectedSource","calculateThresholds","etaValues","vValues","mean","arr","a","b","std","sum","x","etaMean","etaStd","vMean","vStd","filteredSources","filteredOutCount","etaLine","vLine","candidates","colorMaxValues","getPointColor","source","isCandidate","max","ratio","r","g","echarts.init","handleResize","candidateIds","c","scatterData","etaMin","etaMax","vMin","vMax","excludedInfo","option","chart","event","handleControlChange","handleNavigate","SourcesListPage","useSources","activeTab","setActiveTab","queryParams","setQueryParams","showAdvancedFilters","setShowAdvancedFilters","advFilterValues","setAdvFilterValues","showExportModal","setShowExportModal","advFilterDefs","selectedSources","useSelectionStore","toggleSourceSelection","selectAllSources","clearSourceSelection","selectedIds","handleExportSelected","confirmExport","radius","dRa","dDec","term","sortColumn","sortDirection","handleSort","sortedData","useTableSort","variabilityData","LoadingSpinner","Modal","el","SortableTableHeader","Link"],"mappings":"4VA0DA,MAAMA,GAA0D,CAAC,CAC/D,QAAAC,EACA,OAAAC,EACA,SAAAC,EACA,QAAAC,EACA,QAAAC,EACA,UAAAC,EAAY,EACd,IAAM,CACJ,KAAM,CAACC,EAAgBC,CAAiB,EAAIC,EAAAA,aAA0B,IAAI,CAAC,KAAK,CAAC,CAAC,EAG5EC,EAAiBC,EAAAA,QAAQ,IAAM,CACnC,MAAMC,EAA6C,CAAA,EACnD,OAAAX,EAAQ,QAASY,GAAW,CAC1B,MAAMC,EAAQD,EAAO,OAAS,UACzBD,EAAOE,CAAK,IAAGF,EAAOE,CAAK,EAAI,CAAA,GACpCF,EAAOE,CAAK,EAAE,KAAKD,CAAM,CAC3B,CAAC,EACMD,CACT,EAAG,CAACX,CAAO,CAAC,EAENc,EAAcC,cAAaF,GAAkB,CACjDN,EAAmBS,GAAS,CAC1B,MAAMC,EAAO,IAAI,IAAID,CAAI,EACzB,OAAIC,EAAK,IAAIJ,CAAK,EAChBI,EAAK,OAAOJ,CAAK,EAEjBI,EAAK,IAAIJ,CAAK,EAETI,CACT,CAAC,CACH,EAAG,CAAA,CAAE,EAECC,EAAqBH,EAAAA,YACzB,CAACI,EAAkBC,IAAmB,CACpClB,EAAS,CACP,GAAGD,EACH,CAACkB,CAAQ,EAAGC,CAAA,CACb,CACH,EACA,CAACnB,EAAQC,CAAQ,CAAA,EAIbmB,EAAcX,EAAAA,QAAQ,IAAM,CAChC,IAAIY,EAAQ,EACZ,cAAO,QAAQrB,CAAM,EAAE,QAAQ,CAAC,CAACsB,EAAKH,CAAK,IAAM,CAC/C,MAAMR,EAASZ,EAAQ,KAAMwB,GAAMA,EAAE,KAAOD,CAAG,EAC/C,GAAKX,EAEL,GAAIA,EAAO,OAAS,QAAS,CAC3B,MAAMa,EAAWL,EACbK,IAAaA,EAAS,MAAQb,EAAO,KAAOa,EAAS,MAAQb,EAAO,MACtEU,GAEJ,SAAWV,EAAO,OAAS,WACrB,MAAM,QAAQQ,CAAK,GAAKA,EAAM,OAAS,GAAGE,YACrCV,EAAO,OAAS,cAAe,CACxC,MAAMc,EAAUN,GACZM,GAAS,IAAMA,GAAS,KAAOA,GAAS,SAAQJ,GACtD,MAAWF,GACTE,GAEJ,CAAC,EACMA,CACT,EAAG,CAACrB,EAAQD,CAAO,CAAC,EAEd2B,EAAgBf,GAA6B,CACjD,OAAQA,EAAO,KAAA,CACb,IAAK,QAAS,CACZ,MAAMgB,EAAa3B,EAAOW,EAAO,EAAE,EACnC,OACEiB,EAAAA,IAACC,EAAA,CACC,IAAKlB,EAAO,KAAO,EACnB,IAAKA,EAAO,KAAO,IACnB,KAAMA,EAAO,KACb,KAAMA,EAAO,KACb,SAAUgB,GAAY,IACtB,SAAUA,GAAY,IACtB,SAAU,CAACG,EAAQC,IACjBd,EAAmBN,EAAO,GAAI,CAAE,IAAKmB,EAAQ,IAAKC,CAAA,CAAQ,EAE5D,UAAWpB,EAAO,SAAA,CAAA,CAGxB,CAEA,IAAK,SACH,OACEqB,EAAAA,KAAC,SAAA,CACC,MAAQhC,EAAOW,EAAO,EAAE,GAAgB,GACxC,SAAWsB,GAAMhB,EAAmBN,EAAO,GAAIsB,EAAE,OAAO,KAAK,EAC7D,UAAU,qBAEV,SAAA,CAAAL,EAAAA,IAAC,SAAA,CAAO,MAAM,GAAG,SAAA,MAAG,EACnBjB,EAAO,SAAS,IAAKuB,GACpBF,EAAAA,KAAC,SAAA,CAAuB,MAAOE,EAAI,MAChC,SAAA,CAAAA,EAAI,MACJA,EAAI,QAAU,QAAa,KAAKA,EAAI,KAAK,GAAA,CAAA,EAF/BA,EAAI,KAGjB,CACD,CAAA,CAAA,CAAA,EAIP,IAAK,WACH,OACEN,EAAAA,IAAC,MAAA,CAAI,UAAU,qCACZ,SAAAjB,EAAO,SAAS,IAAKuB,GACpBF,OAAC,QAAA,CAAsB,UAAU,kCAC/B,SAAA,CAAAJ,EAAAA,IAAC,QAAA,CACC,KAAK,WACL,SAAW5B,EAAOW,EAAO,EAAE,GAAkB,IAAI,SAASuB,EAAI,KAAK,EACnE,SAAWD,GAAM,CACf,MAAME,EAAWnC,EAAOW,EAAO,EAAE,GAAkB,CAAA,EAC7CK,EAAOiB,EAAE,OAAO,QAClB,CAAC,GAAGE,EAASD,EAAI,KAAK,EACtBC,EAAQ,OAAQC,GAAMA,IAAMF,EAAI,KAAK,EACzCjB,EAAmBN,EAAO,GAAIK,CAAI,CACpC,EACA,UAAU,uEAAA,CAAA,EAEZY,EAAAA,IAAC,OAAA,CAAM,SAAAM,EAAI,KAAA,CAAM,EAChBA,EAAI,QAAU,QAAaF,EAAAA,KAAC,OAAA,CAAK,UAAU,gBAAgB,SAAA,CAAA,IAAEE,EAAI,MAAM,GAAA,CAAA,CAAC,CAAA,CAAA,EAd/DA,EAAI,KAehB,CACD,EACH,EAGJ,IAAK,OACH,OACEN,EAAAA,IAAC,QAAA,CACC,KAAK,OACL,MAAQ5B,EAAOW,EAAO,EAAE,GAAgB,GACxC,SAAWsB,GAAMhB,EAAmBN,EAAO,GAAIsB,EAAE,OAAO,KAAK,EAC7D,YAAatB,EAAO,aAAe,UAAUA,EAAO,MAAM,aAAa,MACvE,UAAU,qBAAA,CAAA,EAIhB,IAAK,cACH,MAAM0B,EAAarC,EAAOW,EAAO,EAAE,GAAyB,CAC1D,GAAI,GACJ,IAAK,GACL,OAAQ,GAAA,EAEV,OACEqB,EAAAA,KAAC,MAAA,CAAI,UAAU,YACb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,yBACb,SAAA,CAAAA,OAAC,MAAA,CACC,SAAA,CAAAJ,EAAAA,IAAC,QAAA,CAAM,UAAU,wBAAwB,SAAA,kBAAe,EACxDA,EAAAA,IAAC,QAAA,CACC,KAAK,OACL,MAAOS,EAAU,GACjB,SAAWJ,GACThB,EAAmBN,EAAO,GAAI,CAC5B,GAAG0B,EACH,GAAIJ,EAAE,OAAO,KAAA,CACd,EAEH,YAAY,oBACZ,UAAU,qBAAA,CAAA,CACZ,EACF,SACC,MAAA,CACC,SAAA,CAAAL,EAAAA,IAAC,QAAA,CAAM,UAAU,wBAAwB,SAAA,mBAAgB,EACzDA,EAAAA,IAAC,QAAA,CACC,KAAK,OACL,MAAOS,EAAU,IACjB,SAAWJ,GACThB,EAAmBN,EAAO,GAAI,CAC5B,GAAG0B,EACH,IAAKJ,EAAE,OAAO,KAAA,CACf,EAEH,YAAY,qBACZ,UAAU,qBAAA,CAAA,CACZ,CAAA,CACF,CAAA,EACF,SACC,MAAA,CACC,SAAA,CAAAL,EAAAA,IAAC,QAAA,CAAM,UAAU,wBAAwB,SAAA,kBAAe,EACxDA,EAAAA,IAAC,QAAA,CACC,KAAK,SACL,MAAOS,EAAU,OACjB,SAAWJ,GACThB,EAAmBN,EAAO,GAAI,CAC5B,GAAG0B,EACH,OAAQJ,EAAE,OAAO,KAAA,CAClB,EAEH,IAAK,GACL,IAAK,GACL,KAAM,GACN,UAAU,qBAAA,CAAA,CACZ,CAAA,CACF,CAAA,EACF,EAGJ,QACE,OAAO,IAAA,CAEb,EAEA,OACED,EAAAA,KAAC,MAAA,CAAI,UAAW,QAAQ5B,CAAS,GAC/B,SAAA,CAAA4B,EAAAA,KAAC,MAAA,CAAI,UAAU,gDACb,SAAA,CAAAA,EAAAA,KAAC,KAAA,CAAG,UAAU,gDAAgD,SAAA,CAAA,UAE3DZ,EAAc,GAAKY,OAAC,OAAA,CAAK,UAAU,sBAAuB,SAAA,CAAAZ,EAAY,SAAA,CAAA,CAAO,CAAA,EAChF,QACC,SAAA,CAAO,QAASjB,EAAS,UAAU,2CAA2C,SAAA,WAAA,CAE/E,CAAA,EACF,QAEC,MAAA,CAAI,UAAU,2BACZ,SAAA,OAAO,QAAQK,CAAc,EAAE,IAAI,CAAC,CAACI,EAAO0B,CAAY,IACvDN,EAAAA,KAAC,MAAA,CAAgB,UAAU,kBAEzB,SAAA,CAAAA,EAAAA,KAAC,SAAA,CACC,QAAS,IAAMnB,EAAYD,CAAK,EAChC,UAAU,oGAEV,SAAA,CAAAgB,EAAAA,IAAC,OAAA,CAAK,UAAU,4BAA6B,SAAAhB,EAAM,EACnDgB,EAAAA,IAAC,MAAA,CACC,UAAW,8CACTvB,EAAe,IAAIO,CAAK,EAAI,aAAe,EAC7C,GACA,KAAK,OACL,OAAO,eACP,QAAQ,YAER,SAAAgB,EAAAA,IAAC,OAAA,CACC,cAAc,QACd,eAAe,QACf,YAAa,EACb,EAAE,gBAAA,CAAA,CACJ,CAAA,CACF,CAAA,CAAA,EAIDvB,EAAe,IAAIO,CAAK,SACtB,MAAA,CAAI,UAAU,gBACZ,SAAA0B,EAAa,IAAK3B,GACjBqB,EAAAA,KAAC,MAAA,CAAoB,UAAU,cAC7B,SAAA,CAAAJ,EAAAA,IAAC,QAAA,CAAM,UAAU,aAAc,SAAAjB,EAAO,MAAM,EAC3Ce,EAAaf,CAAM,CAAA,GAFZA,EAAO,EAGjB,CACD,CAAA,CACH,CAAA,GAjCMC,CAmCV,CACD,EACH,EAGAgB,EAAAA,IAAC,MAAA,CAAI,UAAU,0CACb,SAAAA,EAAAA,IAAC,SAAA,CAAO,QAAS1B,EAAS,UAAU,yBAAyB,SAAA,eAAA,CAE7D,CAAA,CACF,CAAA,EACF,CAEJ,EChTMqC,MAAmB,IAMnBC,GAAgD,CAAC,CAAE,WAAAC,EAAY,UAAArC,EAAY,MAAS,CACxF,KAAM,CAACsC,EAAYC,CAAa,EAAIpC,EAAAA,SAAS,EAAE,EACzC,CAACqC,EAASC,CAAU,EAAItC,EAAAA,SAAwB,KAAK,EACrD,CAACuC,EAAWC,CAAY,EAAIxC,EAAAA,SAAS,EAAK,EAC1C,CAACyC,EAAOC,CAAQ,EAAI1C,EAAAA,SAAwB,IAAI,EAChD,CAAC2C,EAAQC,CAAS,EAAI5C,EAAAA,SAA+B,IAAI,EAGzD6C,EAAqBC,EAAAA,OAA+B,IAAI,EAExDC,EAAgBxC,EAAAA,YAAY,SAAY,CAC5C,MAAMyC,EAAcb,EAAW,KAAA,EAC/B,GAAI,CAACa,EAAa,CAChBN,EAAS,6BAA6B,EACtC,MACF,CAGA,MAAMO,EAAW,GAAGZ,CAAO,IAAIW,EAAY,aAAa,GAClDE,EAASlB,EAAa,IAAIiB,CAAQ,EACxC,GAAIC,EAAQ,CACVN,EAAUM,CAAM,EAChBR,EAAS,IAAI,EACbR,EAAWgB,EAAO,GAAIA,EAAO,IAAKA,EAAO,UAAU,EACnD,MACF,CAGIL,EAAmB,SACrBA,EAAmB,QAAQ,MAAA,EAE7BA,EAAmB,QAAU,IAAI,gBAEjCL,EAAa,EAAI,EACjBE,EAAS,IAAI,EACbE,EAAU,IAAI,EAEd,GAAI,CAIF,MAAMO,EAAM,sDADQd,IAAY,MAAQ,IAAMA,EAAQ,OAAO,CAAC,EAAE,YAAA,CACa,IAAI,mBAC/EW,CAAA,CACD,GAEKI,EAAW,MAAM,MAAMD,EAAK,CAChC,OAAQN,EAAmB,QAAQ,MAAA,CACpC,EAED,GAAI,CAACO,EAAS,GACZ,MAAM,IAAI,MAAM,eAAeA,EAAS,MAAM,EAAE,EAQlD,MAAMC,GALO,MAAMD,EAAS,KAAA,GAKT,MAAM;AAAA,CAAI,EAAE,KAAME,GAASA,EAAK,WAAW,IAAI,CAAC,EAEnE,GAAI,CAACD,EACH,MAAM,IAAI,MAAM,gEAAgE,EAGlF,MAAME,EAAQF,EAAM,MAAM,8BAA8B,EACxD,GAAI,CAACE,EACH,MAAM,IAAI,MAAM,4CAA4C,EAG9D,MAAMC,EAAK,WAAWD,EAAM,CAAC,CAAC,EACxBE,EAAM,WAAWF,EAAM,CAAC,CAAC,EAEzBG,EAA0B,CAC9B,GAAAF,EACA,IAAAC,EACA,WAAYT,EACZ,QAAAX,CAAA,EAIFL,EAAa,IAAIiB,EAAUS,CAAQ,EAEnCd,EAAUc,CAAQ,EAClBxB,EAAWsB,EAAIC,EAAKT,CAAW,CACjC,OAASW,EAAK,CAEZ,GAAIA,aAAe,OAASA,EAAI,OAAS,aACvC,OAEF,MAAMC,EAAUD,aAAe,MAAQA,EAAI,QAAU,oBAEjDC,EAAQ,SAAS,OAAO,GAAKA,EAAQ,SAAS,SAAS,EACzDlB,EAAS,6EAA6E,EAEtFA,EAASkB,CAAO,CAEpB,QAAA,CACEpB,EAAa,EAAK,CACpB,CACF,EAAG,CAACL,EAAYE,EAASH,CAAU,CAAC,EAE9B2B,EAAiBnC,GAA2B,CAC5CA,EAAE,MAAQ,SACZqB,EAAA,CAEJ,EAEA,OACEtB,EAAAA,KAAC,MAAA,CAAI,UAAW,aAAa5B,CAAS,GACpC,SAAA,CAAA4B,EAAAA,KAAC,MAAA,CAAI,UAAU,aACb,SAAA,CAAAJ,EAAAA,IAAC,QAAA,CACC,KAAK,OACL,MAAOc,EACP,SAAWT,GAAMU,EAAcV,EAAE,OAAO,KAAK,EAC7C,UAAWmC,EACX,YAAY,uDACZ,UAAU,qBAAA,CAAA,EAEZxC,EAAAA,IAAC,SAAA,CACC,QAAS0B,EACT,SAAUR,GAAa,CAACJ,EAAW,KAAA,EACnC,UAAU,kBAET,SAAAI,EACCd,OAAC,OAAA,CAAK,UAAU,0BACd,SAAA,CAAAJ,EAAAA,IAAC,OAAA,CAAK,UAAU,8EAAA,CAA+E,EAAE,cAAA,CAAA,CAEnG,EAEA,SAAA,CAAA,CAEJ,EACF,EAGAI,EAAAA,KAAC,MAAA,CAAI,UAAU,kCACb,SAAA,CAAAJ,EAAAA,IAAC,OAAA,CAAK,UAAU,gBAAgB,SAAA,WAAQ,EACtC,CAAC,MAAO,SAAU,MAAO,QAAQ,EAAsB,IAAKyC,GAC5DrC,EAAAA,KAAC,QAAA,CAAgB,UAAU,yCACzB,SAAA,CAAAJ,EAAAA,IAAC,QAAA,CACC,KAAK,QACL,KAAK,iBACL,MAAOyC,EACP,QAASzB,IAAYyB,EACrB,SAAU,IAAMxB,EAAWwB,CAAG,EAC9B,UAAU,yBAAA,CAAA,EAEZzC,EAAAA,IAAC,QAAK,UAAU,aAAc,aAAQ,MAAQ,MAAQyC,EAAI,YAAA,CAAY,CAAE,CAAA,CAAA,EAT9DA,CAUZ,CACD,CAAA,EACH,EAGCrB,GACChB,EAAAA,KAAC,MAAA,CAAI,UAAU,+CACb,SAAA,CAAAJ,MAAC,OAAI,UAAU,UAAU,KAAK,eAAe,QAAQ,YACnD,SAAAA,EAAAA,IAAC,OAAA,CACC,SAAS,UACT,EAAE,oHACF,SAAS,SAAA,CAAA,EAEb,EACCoB,CAAA,EACH,EAIDE,GACClB,EAAAA,KAAC,MAAA,CAAI,UAAU,iDACb,SAAA,CAAAJ,MAAC,OAAI,UAAU,UAAU,KAAK,eAAe,QAAQ,YACnD,SAAAA,EAAAA,IAAC,OAAA,CACC,SAAS,UACT,EAAE,wIACF,SAAS,SAAA,CAAA,EAEb,SACC,OAAA,CAAK,SAAA,CAAA,gBACUsB,EAAO,GAAG,QAAQ,CAAC,EAAE,UAAQA,EAAO,IAAI,QAAQ,CAAC,EAAE,GAAA,CAAA,CACnE,CAAA,CAAA,CACF,CAAA,EAEJ,CAEJ,EC9LMoB,GAA0C,CAAC,CAAE,OAAAtE,EAAQ,SAAAC,EAAU,UAAAG,EAAY,MAAS,CACxF,MAAMmE,EAAe,CACnBC,EACAC,EACAtD,IACG,CACH,MAAMgB,EAAUnC,EAAOwE,CAAK,GAAK,CAAE,KAAM,MAAA,EACzCvE,EAAS,CACP,GAAGD,EACH,CAACwE,CAAK,EAAG,CACP,GAAGrC,EACH,CAACsC,CAAQ,EAAGA,IAAa,OAAStD,EAAQA,IAAU,GAAK,OAAY,OAAOA,CAAK,CAAA,CACnF,CACD,CACH,EAEMuD,EAAgB,CACpBC,EACAH,EACAI,IACG,CACH,MAAMzC,EAAUnC,EAAOwE,CAAK,GAAK,CAAE,KAAM,MAAA,EACzC,OACExC,EAAAA,KAAC,MAAA,CAAI,UAAU,aACb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,+BACb,SAAA,CAAAJ,EAAAA,IAAC,QAAA,CAAM,UAAU,gCAAiC,SAAA+C,EAAM,EACxD/C,EAAAA,IAAC,OAAA,CAAK,UAAU,4BAA4B,MAAOgD,EACjD,SAAAhD,EAAAA,IAAC,MAAA,CAAI,UAAU,UAAU,KAAK,eAAe,QAAQ,YACnD,SAAAA,EAAAA,IAAC,OAAA,CACC,SAAS,UACT,EAAE,yLACF,SAAS,SAAA,CAAA,EAEb,CAAA,CACF,CAAA,EACF,EACAI,EAAAA,KAAC,MAAA,CAAI,UAAU,yBACb,SAAA,CAAAJ,EAAAA,IAAC,QAAA,CACC,KAAK,SACL,MAAOO,EAAQ,KAAO,GACtB,SAAWF,GAAMsC,EAAaC,EAAO,MAAOvC,EAAE,OAAO,KAAK,EAC1D,YAAY,YACZ,KAAK,OACL,UAAU,cAAA,CAAA,EAEZL,EAAAA,IAAC,QAAA,CACC,KAAK,SACL,MAAOO,EAAQ,KAAO,GACtB,SAAWF,GAAMsC,EAAaC,EAAO,MAAOvC,EAAE,OAAO,KAAK,EAC1D,YAAY,YACZ,KAAK,OACL,UAAU,cAAA,CAAA,EAEZD,EAAAA,KAAC,SAAA,CACC,MAAOG,EAAQ,MAAQ,OACvB,SAAWF,GAAMsC,EAAaC,EAAO,OAAQvC,EAAE,OAAO,KAAK,EAC3D,UAAU,cAEV,SAAA,CAAAL,EAAAA,IAAC,SAAA,CAAO,MAAM,OAAO,SAAA,YAAS,EAC9BA,EAAAA,IAAC,SAAA,CAAO,MAAM,MAAM,SAAA,UAAA,CAAQ,CAAA,CAAA,CAAA,CAC9B,CAAA,CACF,CAAA,EACF,CAEJ,EAEA,OACEI,EAAAA,KAAC,MAAA,CAAI,UAAW,aAAa5B,CAAS,GACnC,SAAA,CAAAsE,EACC,YACA,UACA,wEAAA,EAEDA,EACC,YACA,UACA,wEAAA,EAEDA,EACC,YACA,UACA,wEAAA,CACF,EACF,CAEJ,ECpFMG,GAAwD,CAAC,CAC7D,OAAA7E,EACA,SAAAC,EACA,UAAAG,EAAY,EACd,IAAM,CACJ,MAAMmE,EAAe,CACnBC,EACAC,EACAtD,IACG,CACH,MAAMgB,EAAUnC,EAAOwE,CAAK,GAAK,CAAE,KAAM,MAAA,EACzCvE,EAAS,CACP,GAAGD,EACH,CAACwE,CAAK,EAAG,CACP,GAAGrC,EACH,CAACsC,CAAQ,EAAGA,IAAa,OAAStD,EAAQA,IAAU,GAAK,OAAY,OAAOA,CAAK,CAAA,CACnF,CACD,CACH,EAEM2D,EAAkB,CACtBH,EACAH,EACAI,EACAG,EAAoB,KACjB,CACH,MAAM5C,EAAUnC,EAAOwE,CAAK,GAAK,CAAE,KAAM,MAAA,EACzC,OACExC,EAAAA,KAAC,MAAA,CAAI,UAAU,aACb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,+BACb,SAAA,CAAAJ,EAAAA,IAAC,QAAA,CAAM,UAAU,gCAAiC,SAAA+C,EAAM,EACxD/C,EAAAA,IAAC,OAAA,CAAK,UAAU,4BAA4B,MAAOgD,EACjD,SAAAhD,EAAAA,IAAC,MAAA,CAAI,UAAU,UAAU,KAAK,eAAe,QAAQ,YACnD,SAAAA,EAAAA,IAAC,OAAA,CACC,SAAS,UACT,EAAE,yLACF,SAAS,SAAA,CAAA,EAEb,CAAA,CACF,CAAA,EACF,SACC,MAAA,CAAI,UAAW,QAAQmD,EAAW,cAAgB,aAAa,SAC9D,SAAA,CAAAnD,EAAAA,IAAC,QAAA,CACC,KAAK,SACL,MAAOO,EAAQ,KAAO,GACtB,SAAWF,GAAMsC,EAAaC,EAAO,MAAOvC,EAAE,OAAO,KAAK,EAC1D,YAAY,MACZ,KAAK,OACL,UAAU,cAAA,CAAA,EAEZL,EAAAA,IAAC,QAAA,CACC,KAAK,SACL,MAAOO,EAAQ,KAAO,GACtB,SAAWF,GAAMsC,EAAaC,EAAO,MAAOvC,EAAE,OAAO,KAAK,EAC1D,YAAY,MACZ,KAAK,OACL,UAAU,cAAA,CAAA,EAEX8C,GACC/C,EAAAA,KAAC,SAAA,CACC,MAAOG,EAAQ,MAAQ,OACvB,SAAWF,GAAMsC,EAAaC,EAAO,OAAQvC,EAAE,OAAO,KAAK,EAC3D,UAAU,cAEV,SAAA,CAAAL,EAAAA,IAAC,SAAA,CAAO,MAAM,OAAO,SAAA,YAAS,EAC9BA,EAAAA,IAAC,SAAA,CAAO,MAAM,MAAM,SAAA,UAAA,CAAQ,CAAA,CAAA,CAAA,CAC9B,CAAA,CAEJ,CAAA,EACF,CAEJ,EAEA,OACEI,EAAAA,KAAC,MAAA,CAAI,UAAW,aAAa5B,CAAS,GACnC,SAAA,CAAA0E,EACC,iBACA,MACA,+FAAA,EAEDA,EACC,WACA,IACA,uEAAA,EAEDA,EACC,kBACA,KACA,8EAAA,EAEDA,EACC,iBACA,IACA,0FAAA,CACF,EACF,CAEJ,EChGME,GAAsC,CAAC,CAC3C,cAAAC,EACA,YAAAC,EACA,YAAAC,EACA,gBAAAC,EACA,gBAAAC,EACA,UAAAjF,EAAY,EACd,IAAM,CACJ,KAAM,CAACkF,EAAcC,CAAe,EAAIhF,EAAAA,SAAS,EAAE,EAC7C,CAACiF,EAAcC,CAAe,EAAIlF,EAAAA,SAAS,EAAE,EAC7C,CAACmF,EAAwBC,CAAyB,EAAIpF,EAAAA,SAAS,EAAK,EACpE,CAACqF,EAAwBC,CAAyB,EAAItF,EAAAA,SAAS,EAAK,EAEpEuF,EAAyB,CAACC,EAAeC,IAA0B,CACvE,GAAI,CAACD,EAAM,KAAA,QAAe,CAAA,EAC1B,MAAME,EAAQF,EAAM,YAAA,EACpB,OAAOd,EACJ,OAAQiB,GAAQA,EAAI,YAAA,EAAc,SAASD,CAAK,GAAK,CAACD,EAAY,SAASE,CAAG,CAAC,EAC/E,MAAM,EAAG,EAAE,CAChB,EAEMC,EAAS,CACbD,EACAF,EACA/F,EACAmG,IACG,CACEJ,EAAY,SAASE,CAAG,GAC3BjG,EAAS,CAAC,GAAG+F,EAAaE,CAAG,CAAC,EAEhCE,EAAS,EAAE,CACb,EAEMC,EAAY,CAACH,EAAaF,EAAuB/F,IAAuC,CAC5FA,EAAS+F,EAAY,OAAQM,GAAMA,IAAMJ,CAAG,CAAC,CAC/C,EAEMK,EAAiB,CACrB5B,EACAoB,EACAK,EACAI,EACAvG,EACAwG,EACAC,EACA9B,IACG,CACH,MAAM+B,EAAcb,EAAuBC,EAAOS,CAAI,EAEtD,OACExE,EAAAA,KAAC,MAAA,CAAI,UAAU,aACb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,+BACb,SAAA,CAAAJ,EAAAA,IAAC,QAAA,CAAM,UAAU,gCAAiC,SAAA+C,EAAM,EACxD/C,EAAAA,IAAC,OAAA,CAAK,UAAU,4BAA4B,MAAOgD,EACjD,SAAAhD,EAAAA,IAAC,MAAA,CAAI,UAAU,UAAU,KAAK,eAAe,QAAQ,YACnD,SAAAA,EAAAA,IAAC,OAAA,CACC,SAAS,UACT,EAAE,yLACF,SAAS,SAAA,CAAA,EAEb,CAAA,CACF,CAAA,EACF,EAGC4E,EAAK,OAAS,GACb5E,EAAAA,IAAC,OAAI,UAAU,4BACZ,SAAA4E,EAAK,IAAKN,GACTlE,EAAAA,KAAC,OAAA,CAAe,UAAU,gDACvB,SAAA,CAAAkE,EACDtE,EAAAA,IAAC,SAAA,CACC,QAAS,IAAMyE,EAAUH,EAAKM,EAAMvG,CAAQ,EAC5C,UAAU,qBACX,SAAA,GAAA,CAAA,CAED,GAPSiG,CAQX,CACD,EACH,EAIFlE,EAAAA,KAAC,MAAA,CAAI,UAAU,WACb,SAAA,CAAAJ,EAAAA,IAAC,QAAA,CACC,KAAK,OACL,MAAOmE,EACP,SAAW9D,GAAM,CACfmE,EAASnE,EAAE,OAAO,KAAK,EACvByE,EAAmB,EAAI,CACzB,EACA,QAAS,IAAMA,EAAmB,EAAI,EACtC,OAAQ,IAAM,WAAW,IAAMA,EAAmB,EAAK,EAAG,GAAG,EAC7D,UAAYzE,GAAM,CACZA,EAAE,MAAQ,SAAW8D,EAAM,SAC7B9D,EAAE,eAAA,EACE0E,EAAY,OAAS,EACvBR,EAAOQ,EAAY,CAAC,EAAGH,EAAMvG,EAAUmG,CAAQ,EACtCnB,EAAc,SAASc,EAAM,KAAA,CAAM,GAC5CI,EAAOJ,EAAM,KAAA,EAAQS,EAAMvG,EAAUmG,CAAQ,EAGnD,EACA,YAAY,yBACZ,UAAU,qBAAA,CAAA,EAIXK,GAAmBE,EAAY,OAAS,GACvC/E,EAAAA,IAAC,MAAA,CAAI,UAAU,wGACZ,SAAA+E,EAAY,IAAKC,GAChBhF,EAAAA,IAAC,SAAA,CAEC,QAAS,IAAMuE,EAAOS,EAAYJ,EAAMvG,EAAUmG,CAAQ,EAC1D,UAAU,uDAET,SAAAQ,CAAA,EAJIA,CAAA,CAMR,CAAA,CACH,CAAA,CAAA,CAEJ,CAAA,EACF,CAEJ,EAEA,OACE5E,EAAAA,KAAC,MAAA,CAAI,UAAW,aAAa5B,CAAS,GACnC,SAAA,CAAAmG,EACC,eACAjB,EACAC,EACAL,EACAE,EACAM,EACAC,EACA,+CAAA,EAEDY,EACC,eACAf,EACAC,EACAN,EACAE,EACAO,EACAC,EACA,sDAAA,CACF,EACF,CAEJ,ECzJO,SAASgB,GAAQd,EAA8B,CACpD,GAAI,CAACA,GAAS,OAAOA,GAAU,SAAU,OAAO,KAEhD,MAAMe,EAAUf,EAAM,KAAA,EACtB,GAAI,CAACe,EAAS,OAAO,KAGrB,MAAMC,EAAU,WAAWD,CAAO,EAClC,GAAI,CAAC,MAAMC,CAAO,GAAK,CAACD,EAAQ,SAAS,GAAG,GAAK,CAACA,EAAQ,MAAM,WAAW,EAEzE,OAAIC,GAAW,GAAKA,EAAU,IACrBA,EAGLA,GAAW,GAAKA,EAAU,GACrBA,EAAU,GAEZ,KAIT,MAAMC,EAAWF,EAAQ,MACvB,yEAAA,EAGF,GAAIE,EAAU,CACZ,MAAMC,EAAQ,SAASD,EAAS,CAAC,EAAG,EAAE,EAChCE,EAAU,SAASF,EAAS,CAAC,EAAG,EAAE,EAClCG,EAAU,WAAWH,EAAS,CAAC,CAAC,EAEtC,GAAIC,GAAS,GAAKA,EAAQ,IAAMC,GAAW,GAAKA,EAAU,IAAMC,GAAW,GAAKA,EAAU,GAExF,OADmBF,EAAQC,EAAU,GAAKC,EAAU,MAChC,EAExB,CAGA,MAAMC,EAAgBN,EAAQ,MAAM,0CAA0C,EAE9E,GAAIM,EAAe,CACjB,MAAMH,EAAQ,SAASG,EAAc,CAAC,EAAG,EAAE,EACrCF,EAAU,SAASE,EAAc,CAAC,EAAG,EAAE,EAE7C,GAAIH,GAAS,GAAKA,EAAQ,IAAMC,GAAW,GAAKA,EAAU,GAExD,OADmBD,EAAQC,EAAU,IACjB,EAExB,CAEA,OAAO,IACT,CAYO,SAASG,GAAStB,EAA8B,CACrD,GAAI,CAACA,GAAS,OAAOA,GAAU,SAAU,OAAO,KAEhD,MAAMe,EAAUf,EAAM,KAAA,EACtB,GAAI,CAACe,EAAS,OAAO,KAGrB,IAAIQ,EAAO,EACPC,EAAUT,EAEVS,EAAQ,WAAW,GAAG,GACxBD,EAAO,GACPC,EAAUA,EAAQ,MAAM,CAAC,EAAE,KAAA,GAClBA,EAAQ,WAAW,GAAG,IAC/BA,EAAUA,EAAQ,MAAM,CAAC,EAAE,KAAA,GAI7B,MAAMR,EAAU,WAAWQ,CAAO,EAClC,GAAI,CAAC,MAAMR,CAAO,GAAK,CAACQ,EAAQ,SAAS,GAAG,GAAK,CAACA,EAAQ,MAAM,WAAW,EAAG,CAC5E,MAAMrE,EAASoE,EAAOP,EACtB,OAAI7D,GAAU,KAAOA,GAAU,GACtBA,EAEF,IACT,CAGA,MAAMsE,EAAWD,EAAQ,MACvB,mFAAA,EAGF,GAAIC,EAAU,CACZ,MAAMC,EAAU,SAASD,EAAS,CAAC,EAAG,EAAE,EAClCN,EAAU,SAASM,EAAS,CAAC,EAAG,EAAE,EAClCL,EAAU,WAAWK,EAAS,CAAC,CAAC,EAEtC,GACEC,GAAW,GACXA,GAAW,IACXP,GAAW,GACXA,EAAU,IACVC,GAAW,GACXA,EAAU,GACV,CACA,MAAMO,EAAeD,EAAUP,EAAU,GAAKC,EAAU,KAClDjE,EAASoE,EAAOI,EACtB,GAAIxE,GAAU,KAAOA,GAAU,GAC7B,OAAOA,CAEX,CACF,CAGA,MAAMyE,EAAgBJ,EAAQ,MAAM,8CAA8C,EAElF,GAAII,EAAe,CACjB,MAAMF,EAAU,SAASE,EAAc,CAAC,EAAG,EAAE,EACvCT,EAAU,SAASS,EAAc,CAAC,EAAG,EAAE,EAE7C,GAAIF,GAAW,GAAKA,GAAW,IAAMP,GAAW,GAAKA,EAAU,GAAI,CACjE,MAAMQ,EAAeD,EAAUP,EAAU,GACnChE,EAASoE,EAAOI,EACtB,GAAIxE,GAAU,KAAOA,GAAU,GAC7B,OAAOA,CAEX,CACF,CAEA,OAAO,IACT,CCtFA,MAAM0E,EAAoC,CACxC,WAAY,SACZ,WAAY,OACZ,YAAa,CAAA,EACb,YAAa,CAAA,CACf,EAMMC,GAAwD,CAAC,CAC7D,KAAAC,EAAO,CAAA,EACP,cAAA7C,EAAgB,CAAA,EAChB,SAAA8C,EACA,QAAA5H,EACA,cAAA6H,EACA,UAAA5H,EAAY,EACd,IAAM,CACJ,KAAM,CAAC6H,EAAQC,CAAS,EAAI3H,WAA4B,CACtD,GAAGqH,EACH,GAAGI,CAAA,CACJ,EACK,CAACG,EAAkBC,CAAmB,EAAI7H,EAAAA,SAC9C,IAAI,IAAI,CAAC,OAAQ,SAAS,CAAC,CAAA,EAEvB,CAAC8H,EAAkBC,CAAmB,EAAI/H,EAAAA,SAAiC,CAAA,CAAE,EAC7E,CAACgI,EAASC,CAAU,EAAIjI,EAAAA,SAAiByH,GAAe,IAAI,SAAA,GAAc,EAAE,EAC5E,CAACS,EAAUC,CAAW,EAAInI,EAAAA,SAAiByH,GAAe,KAAK,SAAA,GAAc,EAAE,EAC/EW,EAAqBC,EAAM,OAA6C,IAAI,EAG5EC,EAAe/H,EAAAA,YAAY,IAAkC,CACjE,MAAMgI,EAAO,OAAO,SAAS,KAAK,MAAM,CAAC,EACzC,GAAI,CAACA,EAAM,MAAO,CAAA,EAElB,MAAMC,EAAwC,CAAA,EAC9C,OAAAD,EAAK,MAAM,GAAG,EAAE,QAASE,GAAU,CACjC,KAAM,CAAC1H,EAAKH,CAAK,EAAI6H,EAAM,MAAM,GAAG,EACpC,GAAI,CAAC1H,GAAO,CAACH,EAAO,OAEpB,MAAM8H,EAAU,mBAAmB9H,CAAK,EACxC,OAAQG,EAAA,CACN,IAAK,KACHyH,EAAU,GAAK,WAAWE,CAAO,EACjC,MACF,IAAK,MACHF,EAAU,IAAM,WAAWE,CAAO,EAClC,MACF,IAAK,SACHF,EAAU,OAAS,WAAWE,CAAO,EACrC,MACF,IAAK,cACC,CAAC,SAAU,SAAU,KAAK,EAAE,SAASA,CAAO,IAC9CF,EAAU,WAAaE,GAEzB,MACF,IAAK,cACC,CAAC,OAAQ,UAAU,EAAE,SAASA,CAAO,IACvCF,EAAU,WAAaE,GAEzB,MACF,IAAK,aACHF,EAAU,UAAYE,IAAY,OAClC,MACF,IAAK,cACHF,EAAU,WAAaE,IAAY,OACnC,MACF,IAAK,WACHF,EAAU,QAAUE,EACpB,MACF,IAAK,eACHF,EAAU,YAAcE,EAAQ,MAAM,GAAG,EAAE,OAAO,OAAO,EACzD,MACF,IAAK,eACHF,EAAU,YAAcE,EAAQ,MAAM,GAAG,EAAE,OAAO,OAAO,EACzD,MAEF,IAAK,eACHF,EAAU,QAAU,CAAE,GAAGA,EAAU,QAAS,IAAK,WAAWE,CAAO,EAAG,KAAM,MAAA,EAC5E,MACF,IAAK,eACHF,EAAU,QAAU,CAAE,GAAGA,EAAU,QAAS,IAAK,WAAWE,CAAO,EAAG,KAAM,MAAA,EAC5E,MACF,IAAK,eACHF,EAAU,QAAU,CAAE,GAAGA,EAAU,QAAS,IAAK,WAAWE,CAAO,EAAG,KAAM,MAAA,EAC5E,MACF,IAAK,eACHF,EAAU,QAAU,CAAE,GAAGA,EAAU,QAAS,IAAK,WAAWE,CAAO,EAAG,KAAM,MAAA,EAC5E,MAEF,IAAK,UACHF,EAAU,IAAM,CAAE,GAAGA,EAAU,IAAK,IAAK,WAAWE,CAAO,EAAG,KAAM,MAAA,EACpE,MACF,IAAK,UACHF,EAAU,IAAM,CAAE,GAAGA,EAAU,IAAK,IAAK,WAAWE,CAAO,EAAG,KAAM,MAAA,EACpE,MACF,IAAK,QACHF,EAAU,EAAI,CAAE,GAAGA,EAAU,EAAG,IAAK,WAAWE,CAAO,EAAG,KAAM,MAAA,EAChE,MACF,IAAK,QACHF,EAAU,EAAI,CAAE,GAAGA,EAAU,EAAG,IAAK,WAAWE,CAAO,EAAG,KAAM,MAAA,EAChE,KAAA,CAEN,CAAC,EACMF,CACT,EAAG,CAAA,CAAE,EAGCG,EAAepI,cAAamH,GAA8B,CAC9D,MAAMkB,EAAkB,CAAA,EAEpBlB,EAAO,IAAM,MAAMkB,EAAM,KAAK,MAAMlB,EAAO,GAAG,QAAQ,CAAC,CAAC,EAAE,EAC1DA,EAAO,KAAO,MAAMkB,EAAM,KAAK,OAAOlB,EAAO,IAAI,QAAQ,CAAC,CAAC,EAAE,EAC7DA,EAAO,QAAU,MAAMkB,EAAM,KAAK,UAAUlB,EAAO,MAAM,EAAE,EAC3DA,EAAO,aAAeL,EAAe,YACvCuB,EAAM,KAAK,eAAelB,EAAO,UAAU,EAAE,EAE3CA,EAAO,aAAeL,EAAe,YACvCuB,EAAM,KAAK,eAAelB,EAAO,UAAU,EAAE,EAE3CA,EAAO,WAAWkB,EAAM,KAAK,iBAAiB,EAC9ClB,EAAO,YAAYkB,EAAM,KAAK,kBAAkB,EAChDlB,EAAO,SAASkB,EAAM,KAAK,YAAY,mBAAmBlB,EAAO,OAAO,CAAC,EAAE,EAC3EA,EAAO,YAAY,OAAS,GAC9BkB,EAAM,KAAK,gBAAgBlB,EAAO,YAAY,IAAI,kBAAkB,EAAE,KAAK,GAAG,CAAC,EAAE,EAE/EA,EAAO,YAAY,OAAS,GAC9BkB,EAAM,KAAK,gBAAgBlB,EAAO,YAAY,IAAI,kBAAkB,EAAE,KAAK,GAAG,CAAC,EAAE,EAG/EA,EAAO,SAAS,KAAO,MAAMkB,EAAM,KAAK,gBAAgBlB,EAAO,QAAQ,GAAG,EAAE,EAC5EA,EAAO,SAAS,KAAO,MAAMkB,EAAM,KAAK,gBAAgBlB,EAAO,QAAQ,GAAG,EAAE,EAC5EA,EAAO,SAAS,KAAO,MAAMkB,EAAM,KAAK,gBAAgBlB,EAAO,QAAQ,GAAG,EAAE,EAC5EA,EAAO,SAAS,KAAO,MAAMkB,EAAM,KAAK,gBAAgBlB,EAAO,QAAQ,GAAG,EAAE,EAE5EA,EAAO,KAAK,KAAO,MAAMkB,EAAM,KAAK,WAAWlB,EAAO,IAAI,GAAG,EAAE,EAC/DA,EAAO,KAAK,KAAO,MAAMkB,EAAM,KAAK,WAAWlB,EAAO,IAAI,GAAG,EAAE,EAC/DA,EAAO,GAAG,KAAO,MAAMkB,EAAM,KAAK,SAASlB,EAAO,EAAE,GAAG,EAAE,EACzDA,EAAO,GAAG,KAAO,MAAMkB,EAAM,KAAK,SAASlB,EAAO,EAAE,GAAG,EAAE,EAE7D,MAAMmB,EAAUD,EAAM,OAAS,EAAI,IAAIA,EAAM,KAAK,GAAG,CAAC,GAAK,GACvD,OAAO,SAAS,OAASC,GAC3B,OAAO,QAAQ,aAAa,KAAM,GAAIA,GAAW,OAAO,SAAS,QAAQ,CAE7E,EAAG,CAAA,CAAE,EAGCC,EAAiBvI,cAAamH,GAAsD,CACxF,MAAMqB,EAAiC,CAAA,EAGvC,OAAIrB,EAAO,IAAM,OAASA,EAAO,GAAK,GAAKA,EAAO,GAAK,OACrDqB,EAAO,GAAK,wCAEVrB,EAAO,KAAO,OAASA,EAAO,IAAM,KAAOA,EAAO,IAAM,MAC1DqB,EAAO,IAAM,0CAEXrB,EAAO,QAAU,MAAQA,EAAO,OAAS,IAC3CqB,EAAO,OAAS,gCAKfrB,EAAO,IAAM,MAAQA,EAAO,KAAO,MAAQA,EAAO,QAAU,QAC5DA,EAAO,IAAM,MAAQA,EAAO,KAAO,MAAQA,EAAO,QAAU,QAEzDA,EAAO,IAAM,OAAMqB,EAAO,GAAK,+BAC/BrB,EAAO,KAAO,OAAMqB,EAAO,IAAM,gCACjCrB,EAAO,QAAU,OAAMqB,EAAO,OAAS,oCAGtCA,CACT,EAAG,CAAA,CAAE,EAGLC,EAAAA,UAAU,IAAM,CACd,MAAMR,EAAYF,EAAA,EACd,OAAO,KAAKE,CAAS,EAAE,OAAS,GAClCb,EAAWnH,IAAU,CAAE,GAAGA,EAAM,GAAGgI,GAAY,CAEnD,EAAG,CAACF,CAAY,CAAC,EAGjBU,EAAAA,UAAU,KACJZ,EAAmB,SACrB,OAAO,aAAaA,EAAmB,OAAO,EAEhDA,EAAmB,QAAU,OAAO,WAAW,IAAM,CACnDO,EAAajB,CAAM,EACnBK,EAAoBe,EAAepB,CAAM,CAAC,CAC5C,EAAG,GAAG,EAEC,IAAM,CACPU,EAAmB,SACrB,OAAO,aAAaA,EAAmB,OAAO,CAElD,GACC,CAACV,EAAQiB,EAAcG,CAAc,CAAC,EAEzC,MAAMG,EAAgB1I,cAAa2I,GAAoB,CACrDrB,EAAqBrH,GAAS,CAC5B,MAAMC,EAAO,IAAI,IAAID,CAAI,EACzB,OAAIC,EAAK,IAAIyI,CAAO,EAClBzI,EAAK,OAAOyI,CAAO,EAEnBzI,EAAK,IAAIyI,CAAO,EAEXzI,CACT,CAAC,CACH,EAAG,CAAA,CAAE,EAEC0I,EAA2B5I,EAAAA,YAAY,CAACiD,EAAYC,IAAgB,CACxEkE,EAAWnH,IAAU,CAAE,GAAGA,EAAM,GAAAgD,EAAI,IAAAC,GAAM,EAC1CwE,EAAWzE,EAAG,QAAQ,CAAC,CAAC,EACxB2E,EAAY1E,EAAI,QAAQ,CAAC,CAAC,CAC5B,EAAG,CAAA,CAAE,EAEC2F,EAAc7I,EAAAA,YAAY,IAAM,CACpCoH,EAAU,CAAE,GAAGN,EAAgB,EAC/BU,EAAoB,CAAA,CAAE,EACtBE,EAAW,EAAE,EACbE,EAAY,EAAE,EACd,OAAO,QAAQ,aAAa,KAAM,GAAI,OAAO,SAAS,QAAQ,EAC9DvI,IAAA,CACF,EAAG,CAACA,CAAO,CAAC,EAENyJ,EAAe9I,EAAAA,YAAY,IAAM,CACrC,MAAMwI,EAASD,EAAepB,CAAM,EACpCK,EAAoBgB,CAAM,EACtB,OAAO,KAAKA,CAAM,EAAE,SAAW,GACjCvB,EAASE,CAAM,CAEnB,EAAG,CAACA,EAAQF,EAAUsB,CAAc,CAAC,EAG/BQ,EAAoBpJ,EAAAA,QAAQ,IAAM,CACtC,IAAIY,EAAQ,EACZ,OAAI4G,EAAO,IAAM,MAAQA,EAAO,KAAO,MAAM5G,KACzC4G,EAAO,SAAS,KAAO,MAAQA,EAAO,SAAS,KAAO,OAAM5G,KAC5D4G,EAAO,SAAS,KAAO,MAAQA,EAAO,SAAS,KAAO,OAAM5G,KAC5D4G,EAAO,SAAS,KAAO,MAAQA,EAAO,SAAS,KAAO,OAAM5G,KAC5D4G,EAAO,KAAK,KAAO,MAAQA,EAAO,KAAK,KAAO,OAAM5G,KACpD4G,EAAO,GAAG,KAAO,MAAQA,EAAO,GAAG,KAAO,OAAM5G,KAChD4G,EAAO,QAAQ,KAAO,MAAQA,EAAO,QAAQ,KAAO,OAAM5G,KAC1D4G,EAAO,QAAQ,KAAO,MAAQA,EAAO,QAAQ,KAAO,OAAM5G,KAC1D4G,EAAO,YAAY,KAAO,MAAQA,EAAO,YAAY,KAAO,OAAM5G,IAClE4G,EAAO,WAAW5G,IAClB4G,EAAO,YAAY5G,IACnB4G,EAAO,YAAY,OAAS,GAAG5G,IAC/B4G,EAAO,YAAY,OAAS,GAAG5G,IAC/B4G,EAAO,SAAS5G,IACbA,CACT,EAAG,CAAC4G,CAAM,CAAC,EAEL6B,EAAsB,OAAO,KAAKzB,CAAgB,EAAE,OAAS,EAE7D0B,EAAgB,CAACC,EAAYC,EAAeC,IAA8B,CAC9E,MAAMC,EAAahC,EAAiB,IAAI6B,CAAE,EAC1C,OACEhI,EAAAA,KAAC,MAAA,CAAI,UAAU,2BACb,SAAA,CAAAA,EAAAA,KAAC,SAAA,CACC,QAAS,IAAMwH,EAAcQ,CAAE,EAC/B,UAAU,oGAEV,SAAA,CAAApI,EAAAA,IAAC,OAAA,CAAK,UAAU,8BAA+B,SAAAqI,EAAM,EACrDrI,EAAAA,IAAC,MAAA,CACC,UAAW,8CACTuI,EAAa,aAAe,EAC9B,GACA,KAAK,OACL,OAAO,eACP,QAAQ,YAER,SAAAvI,EAAAA,IAAC,QAAK,cAAc,QAAQ,eAAe,QAAQ,YAAa,EAAG,EAAE,gBAAA,CAAiB,CAAA,CAAA,CACxF,CAAA,CAAA,EAEDuI,GAAcvI,EAAAA,IAAC,MAAA,CAAI,UAAU,gBAAiB,SAAAsI,CAAA,CAAS,CAAA,EAC1D,CAEJ,EAEA,OACElI,EAAAA,KAAC,MAAA,CAAI,UAAW,QAAQ5B,CAAS,GAC/B,SAAA,CAAA4B,EAAAA,KAAC,MAAA,CAAI,UAAU,gDACb,SAAA,CAAAA,EAAAA,KAAC,KAAA,CAAG,UAAU,gDAAgD,SAAA,CAAA,eAE3D6H,EAAoB,GACnB7H,OAAC,OAAA,CAAK,UAAU,sBAAuB,SAAA,CAAA6H,EAAkB,UAAA,CAAA,CAAQ,CAAA,EAErE,QACC,SAAA,CAAO,QAASF,EAAa,UAAU,2CAA2C,SAAA,WAAA,CAEnF,CAAA,EACF,EAEA3H,EAAAA,KAAC,MAAA,CAAI,UAAU,2BAEZ,SAAA,CAAA+H,EACC,SACA,cACA/H,EAAAA,KAAC,MAAA,CAAI,UAAU,aACb,SAAA,CAAAJ,EAAAA,IAAC,QAAA,CAAM,UAAU,aAAa,SAAA,eAAY,EAC1CI,EAAAA,KAAC,SAAA,CACC,MAAOiG,EAAO,SAAW,GACzB,SAAWhG,GACTiG,EAAWnH,IAAU,CAAE,GAAGA,EAAM,QAASkB,EAAE,OAAO,OAAS,QAAY,EAEzE,UAAU,qBAEV,SAAA,CAAAL,EAAAA,IAAC,SAAA,CAAO,MAAM,GAAG,SAAA,WAAQ,EACxBkG,EAAK,IAAKsC,GACTxI,EAAAA,IAAC,SAAA,CAAoB,MAAOwI,EAAI,KAC7B,SAAAA,EAAI,IAAA,EADMA,EAAI,EAEjB,CACD,CAAA,CAAA,CAAA,CACH,CAAA,CACF,CAAA,EAIDL,EACC,OACA,cACA/H,OAAAqI,EAAAA,SAAA,CACE,SAAA,CAAAzI,EAAAA,IAACY,GAAA,CAAe,WAAYkH,CAAA,CAA0B,EAEtD1H,EAAAA,KAAC,MAAA,CAAI,UAAU,yBACb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,aACb,SAAA,CAAAJ,EAAAA,IAAC,QAAA,CAAM,UAAU,aAAa,SAAA,kBAAe,EAC7CA,EAAAA,IAAC,QAAA,CACC,KAAK,OACL,MAAO2G,EACP,SAAWtG,GAAM,CACf,MAAMd,EAAQc,EAAE,OAAO,MACvBuG,EAAWrH,CAAK,EAEhB,MAAMmJ,EAASzD,GAAQ1F,CAAK,EAC5B+G,EAAWnH,IAAU,CACnB,GAAGA,EACH,GAAIuJ,GAAU,MAAA,EACd,CACJ,EACA,OAAQ,IAAM,CAERrC,EAAO,IAAM,MACfO,EAAWP,EAAO,GAAG,QAAQ,CAAC,CAAC,CAEnC,EACA,YAAY,oBACZ,UAAW,gBAAgBI,EAAiB,GAAK,iBAAmB,EAAE,EAAA,CAAA,EAEvEA,EAAiB,IAChBzG,EAAAA,IAAC,KAAE,UAAU,4BAA6B,WAAiB,EAAA,CAAG,CAAA,EAElE,EACAI,EAAAA,KAAC,MAAA,CAAI,UAAU,aACb,SAAA,CAAAJ,EAAAA,IAAC,QAAA,CAAM,UAAU,aAAa,SAAA,mBAAgB,EAC9CA,EAAAA,IAAC,QAAA,CACC,KAAK,OACL,MAAO6G,EACP,SAAWxG,GAAM,CACf,MAAMd,EAAQc,EAAE,OAAO,MACvByG,EAAYvH,CAAK,EAEjB,MAAMmJ,EAASjD,GAASlG,CAAK,EAC7B+G,EAAWnH,IAAU,CACnB,GAAGA,EACH,IAAKuJ,GAAU,MAAA,EACf,CACJ,EACA,OAAQ,IAAM,CAERrC,EAAO,KAAO,MAChBS,EAAYT,EAAO,IAAI,QAAQ,CAAC,CAAC,CAErC,EACA,YAAY,qBACZ,UAAW,gBAAgBI,EAAiB,IAAM,iBAAmB,EAAE,EAAA,CAAA,EAExEA,EAAiB,KAChBzG,EAAAA,IAAC,KAAE,UAAU,4BAA6B,WAAiB,GAAA,CAAI,CAAA,CAAA,CAEnE,CAAA,EACF,EAEAI,EAAAA,KAAC,MAAA,CAAI,UAAU,yBACb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,aACb,SAAA,CAAAJ,EAAAA,IAAC,QAAA,CAAM,UAAU,aAAa,SAAA,SAAM,EACpCA,EAAAA,IAAC,QAAA,CACC,KAAK,SACL,MAAOqG,EAAO,QAAU,GACxB,SAAWhG,GACTiG,EAAWnH,IAAU,CACnB,GAAGA,EACH,OAAQkB,EAAE,OAAO,MAAQ,WAAWA,EAAE,OAAO,KAAK,EAAI,MAAA,EACtD,EAEJ,YAAY,IACZ,IAAK,EACL,KAAM,GACN,UAAW,gBAAgBoG,EAAiB,OAAS,iBAAmB,EAAE,EAAA,CAAA,EAE3EA,EAAiB,QAChBzG,EAAAA,IAAC,KAAE,UAAU,4BAA6B,WAAiB,MAAA,CAAO,CAAA,EAEtE,EACAI,EAAAA,KAAC,MAAA,CAAI,UAAU,aACb,SAAA,CAAAJ,EAAAA,IAAC,QAAA,CAAM,UAAU,aAAa,SAAA,OAAI,EAClCI,EAAAA,KAAC,SAAA,CACC,MAAOiG,EAAO,WACd,SAAWhG,GACTiG,EAAWnH,IAAU,CACnB,GAAGA,EACH,WAAYkB,EAAE,OAAO,KAAA,EACrB,EAEJ,UAAU,cAEV,SAAA,CAAAL,EAAAA,IAAC,SAAA,CAAO,MAAM,SAAS,SAAA,SAAM,EAC7BA,EAAAA,IAAC,SAAA,CAAO,MAAM,SAAS,SAAA,SAAM,EAC7BA,EAAAA,IAAC,SAAA,CAAO,MAAM,MAAM,SAAA,KAAA,CAAG,CAAA,CAAA,CAAA,CACzB,EACF,EACAI,EAAAA,KAAC,MAAA,CAAI,UAAU,aACb,SAAA,CAAAJ,EAAAA,IAAC,QAAA,CAAM,UAAU,aAAa,SAAA,QAAK,EACnCI,EAAAA,KAAC,SAAA,CACC,MAAOiG,EAAO,WACd,SAAWhG,GACTiG,EAAWnH,IAAU,CACnB,GAAGA,EACH,WAAYkB,EAAE,OAAO,KAAA,EACrB,EAEJ,UAAU,cAEV,SAAA,CAAAL,EAAAA,IAAC,SAAA,CAAO,MAAM,OAAO,SAAA,OAAI,EACzBA,EAAAA,IAAC,SAAA,CAAO,MAAM,WAAW,SAAA,UAAA,CAAQ,CAAA,CAAA,CAAA,CACnC,CAAA,CACF,CAAA,CAAA,CACF,CAAA,CAAA,CACF,CAAA,EAIDmI,EACC,OACA,eACAnI,EAAAA,IAAC0C,GAAA,CACC,OAAQ,CACN,QAAS2D,EAAO,QAChB,QAASA,EAAO,QAChB,QAASA,EAAO,OAAA,EAElB,SAAWsC,GAAerC,EAAWnH,IAAU,CAAE,GAAGA,EAAM,GAAGwJ,GAAa,CAAA,CAAA,CAC5E,EAIDR,EACC,cACA,sBACAnI,EAAAA,IAACiD,GAAA,CACC,OAAQ,CACN,IAAKoD,EAAO,IACZ,EAAGA,EAAO,EACV,GAAIA,EAAO,GACX,EAAGA,EAAO,CAAA,EAEZ,SAAWuC,GAActC,EAAWnH,IAAU,CAAE,GAAGA,EAAM,GAAGyJ,GAAY,CAAA,CAAA,CAC1E,EAIDT,EACC,MACA,oBACA/H,EAAAA,KAAC,MAAA,CAAI,UAAU,YACb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,yBACb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,aACb,SAAA,CAAAJ,EAAAA,IAAC,QAAA,CAAM,UAAU,aAAa,SAAA,UAAO,EACrCI,EAAAA,KAAC,MAAA,CAAI,UAAU,yBACb,SAAA,CAAAJ,EAAAA,IAAC,QAAA,CACC,KAAK,SACL,MAAOqG,EAAO,QAAQ,KAAO,GAC7B,SAAWhG,GACTiG,EAAWnH,IAAU,CACnB,GAAGA,EACH,OAAQ,CACN,GAAGA,EAAK,OACR,IAAKkB,EAAE,OAAO,MAAQ,OAAOA,EAAE,OAAO,KAAK,EAAI,MAAA,CACjD,EACA,EAEJ,YAAY,MACZ,UAAU,cAAA,CAAA,EAEZL,EAAAA,IAAC,QAAA,CACC,KAAK,SACL,MAAOqG,EAAO,QAAQ,KAAO,GAC7B,SAAWhG,GACTiG,EAAWnH,IAAU,CACnB,GAAGA,EACH,OAAQ,CACN,GAAGA,EAAK,OACR,IAAKkB,EAAE,OAAO,MAAQ,OAAOA,EAAE,OAAO,KAAK,EAAI,MAAA,CACjD,EACA,EAEJ,YAAY,MACZ,UAAU,cAAA,CAAA,CACZ,CAAA,CACF,CAAA,EACF,EACAD,EAAAA,KAAC,MAAA,CAAI,UAAU,aACb,SAAA,CAAAJ,EAAAA,IAAC,QAAA,CAAM,UAAU,aAAa,SAAA,UAAO,EACrCI,EAAAA,KAAC,MAAA,CAAI,UAAU,yBACb,SAAA,CAAAJ,EAAAA,IAAC,QAAA,CACC,KAAK,SACL,MAAOqG,EAAO,QAAQ,KAAO,GAC7B,SAAWhG,GACTiG,EAAWnH,IAAU,CACnB,GAAGA,EACH,OAAQ,CACN,GAAGA,EAAK,OACR,IAAKkB,EAAE,OAAO,MAAQ,OAAOA,EAAE,OAAO,KAAK,EAAI,MAAA,CACjD,EACA,EAEJ,YAAY,MACZ,UAAU,cAAA,CAAA,EAEZL,EAAAA,IAAC,QAAA,CACC,KAAK,SACL,MAAOqG,EAAO,QAAQ,KAAO,GAC7B,SAAWhG,GACTiG,EAAWnH,IAAU,CACnB,GAAGA,EACH,OAAQ,CACN,GAAGA,EAAK,OACR,IAAKkB,EAAE,OAAO,MAAQ,OAAOA,EAAE,OAAO,KAAK,EAAI,MAAA,CACjD,EACA,EAEJ,YAAY,MACZ,UAAU,cAAA,CAAA,CACZ,CAAA,CACF,CAAA,CAAA,CACF,CAAA,EACF,EAEAD,EAAAA,KAAC,MAAA,CAAI,UAAU,aACb,SAAA,CAAAJ,EAAAA,IAAC,QAAA,CAAM,UAAU,aAAa,SAAA,aAAU,EACxCI,EAAAA,KAAC,MAAA,CAAI,UAAU,yBACb,SAAA,CAAAJ,EAAAA,IAAC,QAAA,CACC,KAAK,SACL,MAAOqG,EAAO,YAAY,KAAO,GACjC,SAAWhG,GACTiG,EAAWnH,IAAU,CACnB,GAAGA,EACH,WAAY,CACV,GAAGA,EAAK,WACR,IAAKkB,EAAE,OAAO,MAAQ,OAAOA,EAAE,OAAO,KAAK,EAAI,MAAA,CACjD,EACA,EAEJ,YAAY,MACZ,IAAK,EACL,UAAU,cAAA,CAAA,EAEZL,EAAAA,IAAC,QAAA,CACC,KAAK,SACL,MAAOqG,EAAO,YAAY,KAAO,GACjC,SAAWhG,GACTiG,EAAWnH,IAAU,CACnB,GAAGA,EACH,WAAY,CACV,GAAGA,EAAK,WACR,IAAKkB,EAAE,OAAO,MAAQ,OAAOA,EAAE,OAAO,KAAK,EAAI,MAAA,CACjD,EACA,EAEJ,YAAY,MACZ,IAAK,EACL,UAAU,cAAA,CAAA,CACZ,CAAA,CACF,CAAA,CAAA,CACF,CAAA,CAAA,CACF,CAAA,EAID8H,EACC,QACA,cACA/H,EAAAA,KAAC,MAAA,CAAI,UAAU,YACb,SAAA,CAAAA,EAAAA,KAAC,QAAA,CAAM,UAAU,yCACf,SAAA,CAAAJ,EAAAA,IAAC,QAAA,CACC,KAAK,WACL,QAASqG,EAAO,WAAa,GAC7B,SAAWhG,GAAMiG,EAAWnH,IAAU,CAAE,GAAGA,EAAM,UAAWkB,EAAE,OAAO,SAAU,EAC/E,UAAU,iCAAA,CAAA,EAEZL,EAAAA,IAAC,QAAK,SAAA,YAAA,CAAU,EAChBA,EAAAA,IAAC,OAAA,CAAK,UAAU,wBAAwB,SAAA,oCAAA,CAAkC,CAAA,EAC5E,EACAI,EAAAA,KAAC,QAAA,CAAM,UAAU,yCACf,SAAA,CAAAJ,EAAAA,IAAC,QAAA,CACC,KAAK,WACL,QAASqG,EAAO,YAAc,GAC9B,SAAWhG,GAAMiG,EAAWnH,IAAU,CAAE,GAAGA,EAAM,WAAYkB,EAAE,OAAO,SAAU,EAChF,UAAU,iCAAA,CAAA,EAEZL,EAAAA,IAAC,QAAK,SAAA,aAAA,CAAW,EACjBA,EAAAA,IAAC,OAAA,CAAK,UAAU,wBAAwB,SAAA,8BAAA,CAA4B,CAAA,CAAA,CACtE,CAAA,CAAA,CACF,CAAA,EAIDmI,EACC,OACA,OACAnI,EAAAA,IAACoD,GAAA,CACC,cAAAC,EACA,YAAagD,EAAO,YACpB,YAAaA,EAAO,YACpB,gBAAkBzB,GAAS0B,EAAWnH,IAAU,CAAE,GAAGA,EAAM,YAAayF,CAAA,EAAO,EAC/E,gBAAkBA,GAAS0B,EAAWnH,IAAU,CAAE,GAAGA,EAAM,YAAayF,GAAO,CAAA,CAAA,CACjF,CACF,EACF,EAGCsD,GACClI,EAAAA,IAAC,MAAA,CAAI,UAAU,8CACb,eAAC,KAAA,CAAG,UAAU,6CACX,SAAA,OAAO,QAAQyG,CAAgB,EAAE,IAAI,CAAC,CAAC7D,EAAOxB,CAAK,IAClDpB,EAAAA,IAAC,KAAA,CAAgB,SAAAoB,CAAA,EAARwB,CAAc,CACxB,CAAA,CACH,CAAA,CACF,EAIFxC,EAAAA,KAAC,MAAA,CAAI,UAAU,iEACb,SAAA,CAAAJ,MAAC,SAAA,CAAO,QAAS+H,EAAa,UAAU,oBAAoB,SAAA,QAE5D,EACA/H,EAAAA,IAAC,SAAA,CACC,QAASgI,EACT,UAAW,mBAAmBE,EAAsB,aAAe,EAAE,GACrE,SAAUA,EACX,SAAA,QAAA,CAAA,CAED,CAAA,CACF,CAAA,EACF,CAEJ,EC/qBMW,GAA0D,CAAC,CAC/D,aAAAC,EACA,WAAAC,EACA,SAAAC,EACA,OAAAC,EACA,kBAAAC,EACA,cAAAC,EACA,QAAAC,EACA,SAAA/K,CACF,IAEI+B,EAAAA,KAAC,MAAA,CAAI,UAAU,2DAEb,SAAA,CAAAA,OAAC,MAAA,CACC,SAAA,CAAAA,EAAAA,KAAC,QAAA,CAAM,UAAU,yCACf,SAAA,CAAAJ,EAAAA,IAAC,QAAA,CACC,KAAK,WACL,QAASkJ,EACT,SAAW7I,GAAMhC,EAAS,CAAE,kBAAmBgC,EAAE,OAAO,QAAS,EACjE,UAAU,iBAAA,CAAA,EAEZL,EAAAA,IAAC,OAAA,CAAK,UAAU,UAAU,SAAA,wBAAA,CAAsB,CAAA,EAClD,EACAA,EAAAA,IAAC,IAAA,CAAE,UAAU,6BAA6B,SAAA,8DAAA,CAE1C,CAAA,EACF,EAGCkJ,GACC9I,EAAAA,KAAC,MAAA,CAAI,UAAU,2CACb,SAAA,CAAAA,OAAC,MAAA,CACC,SAAA,CAAAA,EAAAA,KAAC,QAAA,CAAM,UAAU,iDACf,SAAA,CAAAA,OAAC,OAAA,CAAK,SAAA,CAAA,gBAAc4I,EAAS,GAAA,EAAC,EAC9BhJ,EAAAA,IAAC,OAAA,CAAK,UAAU,wBAAwB,SAAA,YAAA,CAAU,CAAA,EACpD,EACAA,EAAAA,IAAC,QAAA,CACC,KAAK,QACL,IAAK,EACL,IAAK,EACL,KAAM,GACN,MAAOgJ,EACP,SAAW3I,GAAMhC,EAAS,CAAE,SAAU,WAAWgC,EAAE,OAAO,KAAK,EAAG,EAClE,UAAU,iFAAA,CAAA,CACZ,EACF,SACC,MAAA,CACC,SAAA,CAAAD,EAAAA,KAAC,QAAA,CAAM,UAAU,iDACf,SAAA,CAAAA,OAAC,OAAA,CAAK,SAAA,CAAA,gBAAc6I,EAAO,GAAA,EAAC,EAC5BjJ,EAAAA,IAAC,OAAA,CAAK,UAAU,wBAAwB,SAAA,YAAA,CAAU,CAAA,EACpD,EACAA,EAAAA,IAAC,QAAA,CACC,KAAK,QACL,IAAK,EACL,IAAK,EACL,KAAM,GACN,MAAOiJ,EACP,SAAW5I,GAAMhC,EAAS,CAAE,OAAQ,WAAWgC,EAAE,OAAO,KAAK,EAAG,EAChE,UAAU,iFAAA,CAAA,CACZ,CAAA,CACF,CAAA,EACF,EAID,CAAC6I,GACA9I,EAAAA,KAAC,MAAA,CAAI,UAAU,yBACb,SAAA,CAAAA,OAAC,MAAA,CACC,SAAA,CAAAJ,EAAAA,IAAC,QAAA,CAAM,UAAU,qBAAqB,SAAA,cAAW,EACjDA,EAAAA,IAAC,QAAA,CACC,KAAK,SACL,MAAO8I,EACP,SAAWzI,GAAMhC,EAAS,CAAE,aAAc,WAAWgC,EAAE,OAAO,KAAK,GAAK,CAAA,CAAG,EAC3E,KAAM,GACN,UAAU,yDAAA,CAAA,CACZ,EACF,SACC,MAAA,CACC,SAAA,CAAAL,EAAAA,IAAC,QAAA,CAAM,UAAU,qBAAqB,SAAA,cAAW,EACjDA,EAAAA,IAAC,QAAA,CACC,KAAK,SACL,MAAO+I,EACP,SAAW1I,GAAMhC,EAAS,CAAE,WAAY,WAAWgC,EAAE,OAAO,KAAK,GAAK,CAAA,CAAG,EACzE,KAAM,IACN,UAAU,yDAAA,CAAA,CACZ,CAAA,CACF,CAAA,EACF,SAID,MAAA,CACC,SAAA,CAAAD,EAAAA,KAAC,QAAA,CAAM,UAAU,qBAAqB,SAAA,CAAA,oBAAkB+I,CAAA,EAAc,EACtEnJ,EAAAA,IAAC,QAAA,CACC,KAAK,QACL,IAAK,EACL,IAAK,GACL,MAAOmJ,EACP,SAAW9I,GAAMhC,EAAS,CAAE,cAAe,SAASgC,EAAE,OAAO,MAAO,EAAE,CAAA,CAAG,EACzE,UAAU,iFAAA,CAAA,EAEZD,EAAAA,KAAC,MAAA,CAAI,UAAU,6CACb,SAAA,CAAAJ,EAAAA,IAAC,QAAK,SAAA,GAAA,CAAC,EACPA,EAAAA,IAAC,QAAK,SAAA,IAAA,CAAE,CAAA,CAAA,CACV,CAAA,EACF,SAGC,MAAA,CACC,SAAA,CAAAA,EAAAA,IAAC,QAAA,CAAM,UAAU,qBAAqB,SAAA,WAAQ,EAC9CI,EAAAA,KAAC,SAAA,CACC,MAAOgJ,EACP,SAAW/I,GACThC,EAAS,CACP,QAASgC,EAAE,OAAO,KAAA,CACnB,EAEH,UAAU,0DAEV,SAAA,CAAAL,EAAAA,IAAC,SAAA,CAAO,MAAM,cAAc,SAAA,sBAAmB,EAC/CA,EAAAA,IAAC,SAAA,CAAO,MAAM,OAAO,SAAA,YAAS,EAC9BA,EAAAA,IAAC,SAAA,CAAO,MAAM,eAAe,SAAA,iBAAc,EAC3CA,EAAAA,IAAC,SAAA,CAAO,MAAM,OAAO,SAAA,mBAAA,CAAiB,CAAA,CAAA,CAAA,CACxC,CAAA,CACF,CAAA,EACF,EC/HEqJ,EAA8C,CAAC,CACnD,SAAAC,EACA,KAAAC,EACA,GAAApH,EACA,IAAAC,EACA,IAAAoH,EACA,EAAAhJ,EACA,SAAAiJ,EACA,cAAAC,EACA,SAAAC,EACA,QAAAC,EAAU,GACV,WAAAC,EACA,QAAAC,CACF,IAAM,CACJ,MAAMC,EAAc,CAACxK,EAAeyK,IAAkB,CACpD,GAAIA,EAAM,CACR,MAAM3E,EAAQ9F,EAAQ,GAChB0K,EAAI,KAAK,MAAM5E,CAAK,EACpB6E,EAAI,KAAK,OAAO7E,EAAQ4E,GAAK,EAAE,EAC/BE,IAAM9E,EAAQ4E,EAAIC,EAAI,IAAM,MAAM,QAAQ,CAAC,EACjD,MAAO,GAAGD,CAAC,KAAKC,CAAC,KAAKC,CAAC,GACzB,KAAO,CACL,MAAMzE,EAAOnG,GAAS,EAAI,IAAM,GAC1B6K,EAAI,KAAK,MAAM,KAAK,IAAI7K,CAAK,CAAC,EAC9B2K,EAAI,KAAK,OAAO,KAAK,IAAI3K,CAAK,EAAI6K,GAAK,EAAE,EACzCD,IAAM,KAAK,IAAI5K,CAAK,EAAI6K,EAAIF,EAAI,IAAM,MAAM,QAAQ,CAAC,EAC3D,MAAO,GAAGxE,CAAI,GAAG0E,CAAC,KAAKF,CAAC,KAAKC,CAAC,GAChC,CACF,EAEME,EAA6BV,EAC/B,CACE,SAAU,WACV,KAAMA,EAAS,EAAI,GACnB,IAAKA,EAAS,EAAI,GAClB,OAAQ,GAAA,EAEV,CAAA,EAEJ,OACEvJ,EAAAA,KAAC,MAAA,CACC,UAAW,4DACTwJ,EAAU,WAAa,UACzB,GACA,MAAAS,EAGA,SAAA,CAAAjK,EAAAA,KAAC,MAAA,CAAI,UAAU,yCACb,SAAA,CAAAJ,EAAAA,IAAC,OAAA,CAAK,UAAU,+CAAgD,SAAAuJ,GAAQD,EAAS,EAChF,CAACM,GAAWE,GACX9J,EAAAA,IAAC,SAAA,CACC,QAAS8J,EACT,UAAU,yDACX,SAAA,GAAA,CAAA,CAED,EAEJ,EAGA1J,EAAAA,KAAC,MAAA,CAAI,UAAU,6BACb,SAAA,CAAAA,OAAC,MAAA,CAAI,SAAA,CAAA,OAAK2J,EAAY5H,EAAI,EAAI,CAAA,EAAE,SAC/B,MAAA,CAAI,SAAA,CAAA,QAAM4H,EAAY3H,EAAK,EAAK,CAAA,CAAA,CAAE,CAAA,EACrC,EAGAhC,EAAAA,KAAC,MAAA,CAAI,UAAU,kBACb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,cACb,SAAA,CAAAJ,MAAC,OAAI,UAAU,qCAAsC,SAAAwJ,EAAI,QAAQ,CAAC,EAAE,EACpExJ,EAAAA,IAAC,MAAA,CAAI,UAAU,wBAAwB,SAAA,GAAA,CAAC,CAAA,EAC1C,EACAI,EAAAA,KAAC,MAAA,CAAI,UAAU,cACb,SAAA,CAAAJ,MAAC,OAAI,UAAU,qCAAsC,SAAAQ,EAAE,QAAQ,CAAC,EAAE,EAClER,EAAAA,IAAC,MAAA,CAAI,UAAU,wBAAwB,SAAA,GAAA,CAAC,CAAA,EAC1C,EACCyJ,IAAa,QACZrJ,OAAC,MAAA,CAAI,UAAU,cACb,SAAA,CAAAJ,MAAC,OAAI,UAAU,sCAAuC,SAAAyJ,EAAS,QAAQ,CAAC,EAAE,EAC1EzJ,EAAAA,IAAC,MAAA,CAAI,UAAU,wBAAwB,SAAA,KAAA,CAAG,CAAA,EAC5C,EAED0J,IAAkB,QACjBtJ,OAAC,MAAA,CAAI,UAAU,cACb,SAAA,CAAAJ,EAAAA,IAAC,MAAA,CAAI,UAAU,sCAAuC,SAAA0J,EAAc,EACpE1J,EAAAA,IAAC,MAAA,CAAI,UAAU,wBAAwB,SAAA,KAAA,CAAG,CAAA,CAAA,CAC5C,CAAA,EAEJ,EAGC,CAAC4J,GAAWC,GACX7J,EAAAA,IAAC,SAAA,CACC,QAAS,IAAM6J,EAAWP,CAAQ,EAClC,UAAU,8FACX,SAAA,qBAAA,CAAA,CAED,CAAA,CAAA,CAIR,ECnGMgB,GAAoC,CAAC,CACzC,QAAAC,EACA,UAAArJ,EAAY,GACZ,eAAAsJ,EACA,OAAAC,EAAS,IACT,UAAAjM,EAAY,EACd,IAAM,CACJ,MAAMkM,EAAWjJ,EAAAA,OAAuB,IAAI,EACtCkJ,EAAgBlJ,EAAAA,OAA+B,IAAI,EAGnD,CAACmJ,EAAUC,CAAW,EAAIlM,WAAoC,CAClE,aAAc,IACd,WAAY,GACZ,SAAU,EACV,OAAQ,EACR,kBAAmB,GACnB,cAAe,EACf,QAAS,aAAA,CACV,EAGK,CAACmM,EAAaC,CAAc,EAAIpM,EAAAA,SAA6B,IAAI,EACjE,CAACqM,EAAeC,CAAgB,EAAItM,EAAAA,SAAS,CAAE,EAAG,EAAG,EAAG,EAAG,EAC3D,CAACuM,EAAgBC,CAAiB,EAAIxM,EAAAA,SAA6B,IAAI,EAG7EgJ,EAAAA,UAAU,IAAM,CACd,MAAMnF,EAAiBnC,GAAqB,CACtCA,EAAE,MAAQ,UAAY6K,GACxBC,EAAkB,IAAI,CAE1B,EACA,GAAID,EACF,cAAO,iBAAiB,UAAW1I,CAAa,EACzC,IAAM,OAAO,oBAAoB,UAAWA,CAAa,CAEpE,EAAG,CAAC0I,CAAc,CAAC,EAGnB,MAAME,EAAsBlM,EAAAA,YAAY,IAAM,CAC5C,GAAI,CAAC0L,EAAS,mBAAqBL,EAAQ,SAAW,EACpD,MAAO,CAAE,QAASK,EAAS,aAAc,MAAOA,EAAS,UAAA,EAG3D,MAAMS,EAAYd,EAAQ,IAAKJ,GAAMA,EAAE,GAAG,EACpCmB,EAAUf,EAAQ,IAAKJ,GAAMA,EAAE,CAAC,EAEhCoB,EAAQC,GAAkBA,EAAI,OAAO,CAACC,EAAGC,IAAMD,EAAIC,EAAG,CAAC,EAAIF,EAAI,OAC/DG,EAAOH,GAAkB,CAC7B,MAAMtB,EAAIqB,EAAKC,CAAG,EAClB,OAAO,KAAK,KAAKA,EAAI,OAAO,CAACI,EAAKC,IAAMD,GAAOC,EAAI3B,IAAM,EAAG,CAAC,EAAIsB,EAAI,MAAM,CAC7E,EAEMM,EAAUP,EAAKF,CAAS,EACxBU,EAASJ,EAAIN,CAAS,EACtBW,EAAQT,EAAKD,CAAO,EACpBW,EAAON,EAAIL,CAAO,EAExB,MAAO,CACL,QAASQ,EAAUlB,EAAS,SAAWmB,EACvC,MAAOC,EAAQpB,EAAS,OAASqB,CAAA,CAErC,EAAG,CAAC1B,EAASK,CAAQ,CAAC,EAGhBsB,EAAkBrN,EAAAA,QACtB,IACE0L,EAAQ,OACLJ,IAAOA,EAAE,eAAiB,KAAOS,EAAS,eAAiBT,EAAE,IAAM,GAAKA,EAAE,EAAI,CAAA,EAEnF,CAACI,EAASK,EAAS,aAAa,CAAA,EAI5BuB,EAAmB5B,EAAQ,OAAS2B,EAAgB,OAGpD,CAAE,QAAAE,EAAS,MAAAC,CAAA,EAAUjB,EAAA,EACrBkB,EAAazN,EAAAA,QACjB,IAAMqN,EAAgB,OAAQ/B,GAAMA,EAAE,IAAMiC,GAAWjC,EAAE,EAAIkC,CAAK,EAClE,CAACH,EAAiBE,EAASC,CAAK,CAAA,EAI5BE,EAAiB1N,EAAAA,QAAQ,IACzBqN,EAAgB,SAAW,EAAU,CAAE,YAAa,EAAG,KAAM,EAAG,aAAc,CAAA,EAC3E,CACL,YAAa,KAAK,IAAI,GAAGA,EAAgB,IAAK/B,GAAMA,EAAE,IAAMA,EAAE,CAAC,EAAG,CAAC,EACnE,KAAM,KAAK,IAAI,GAAG+B,EAAgB,IAAK/B,GAAMA,EAAE,UAAY,CAAC,EAAG,CAAC,EAChE,aAAc,KAAK,IAAI,GAAG+B,EAAgB,IAAK/B,GAAMA,EAAE,eAAiB,CAAC,EAAG,CAAC,CAAA,EAE9E,CAAC+B,CAAe,CAAC,EAGdM,EAAgBtN,EAAAA,YACpB,CAACuN,EAAqBC,IAAyB,CAC7C,GAAIA,EAAa,MAAO,UACxB,GAAI9B,EAAS,UAAY,OAAQ,MAAO,0BAExC,IAAIrL,EAAQ,EACRoN,EAAM,EAEV,OAAQ/B,EAAS,QAAA,CACf,IAAK,cACHrL,EAAQkN,EAAO,IAAMA,EAAO,EAC5BE,EAAMJ,EAAe,YACrB,MACF,IAAK,OACHhN,EAAQkN,EAAO,UAAY,EAC3BE,EAAMJ,EAAe,KACrB,MACF,IAAK,eACHhN,EAAQkN,EAAO,eAAiB,EAChCE,EAAMJ,EAAe,aACrB,KAAA,CAGJ,MAAMK,EAAQ,KAAK,IAAIrN,EAAQoN,EAAK,CAAC,EAE/BE,EAAI,KAAK,MAAM,GAAKD,EAAS,GAAS,EACtCE,EAAI,KAAK,MAAM,IAAMF,EAAS,CAAU,EACxClB,EAAI,KAAK,MAAM,IAAMkB,EAAS,EAAU,EAC9C,MAAO,QAAQC,CAAC,KAAKC,CAAC,KAAKpB,CAAC,QAC9B,EACA,CAACd,EAAS,QAAS2B,CAAc,CAAA,EAInC5E,EAAAA,UAAU,IAAM,CACd,GAAI,CAAC+C,EAAS,QAAS,OAEvBC,EAAc,QAAUoC,EAAarC,EAAS,OAAO,EAErD,MAAMsC,EAAe,IAAM,CACzBrC,EAAc,SAAS,OAAA,CACzB,EACA,cAAO,iBAAiB,SAAUqC,CAAY,EAEvC,IAAM,CACX,OAAO,oBAAoB,SAAUA,CAAY,EACjDrC,EAAc,SAAS,QAAA,CACzB,CACF,EAAG,CAAA,CAAE,EAGLhD,EAAAA,UAAU,IAAM,CACd,GAAI,CAACgD,EAAc,SAAWzJ,EAAW,OAEzC,MAAM+L,EAAe,IAAI,IAAIX,EAAW,IAAKY,GAAMA,EAAE,EAAE,CAAC,EAGlDC,EAAcjB,EAAgB,IAAKO,IAAY,CACnD,MAAO,CAACA,EAAO,IAAKA,EAAO,CAAC,EAC5B,UAAW,CACT,MAAOD,EAAcC,EAAQQ,EAAa,IAAIR,EAAO,EAAE,CAAC,CAAA,EAE1D,WAAYQ,EAAa,IAAIR,EAAO,EAAE,EAAI,GAAK,EAC/C,OAAAA,CAAA,EACA,EAGIpB,EAAYa,EAAgB,IAAK/B,GAAMA,EAAE,GAAG,EAC5CmB,EAAUY,EAAgB,IAAK/B,GAAMA,EAAE,CAAC,EACxCiD,EAAS,KAAK,IAAI,GAAG/B,CAAS,EAAI,GAClCgC,EAAS,KAAK,IAAI,GAAGhC,CAAS,EAAI,EAClCiC,EAAO,KAAK,IAAI,GAAGhC,CAAO,EAAI,GAC9BiC,EAAO,KAAK,IAAI,GAAGjC,CAAO,EAAI,EAG9BkC,EAAerB,EAAmB,EAAI,KAAKA,CAAgB,yBAA2B,GAGtFsB,EAAgC,CACpC,MAAO,CACL,KAAM,uBACN,QALY,GAAGvB,EAAgB,MAAM,aAAaI,EAAW,MAAM,cAAckB,CAAY,GAM7F,KAAM,SACN,UAAW,CAAE,MAAO,UAAW,SAAU,EAAA,EACzC,aAAc,CAAE,MAAO,MAAA,CAAO,EAEhC,QAAS,CACP,QAAS,OACT,UAAW,IAAM,GACjB,KAAM,EAAA,EAER,MAAO,CACL,KAAM,UACN,aAAc,SACd,QAAS,GACT,KAAM,MACN,UAAW,CAAE,UAAW,SAAA,CAAU,EAEpC,MAAO,CACL,KAAM,IACN,aAAc,SACd,QAAS,GACT,KAAM,KAAA,EAER,OAAQ,CACN,CACE,KAAM,UACN,KAAML,EACN,SAAU,CACR,UAAW,CACT,YAAa,UACb,YAAa,CAAA,CACf,CACF,EAGF,CACE,KAAM,OACN,SAAU,CACR,OAAQ,GACR,OAAQ,OACR,UAAW,CAAE,MAAO,UAAW,KAAM,SAAU,MAAO,CAAA,EACtD,KAAM,CACJ,CACE,CAAE,MAAOf,EAAS,MAAOkB,CAAA,EACzB,CAAE,MAAOlB,EAAS,MAAOmB,CAAA,CAAK,CAChC,EAEF,MAAO,CACL,UAAW,OAAOnB,EAAQ,QAAQ,CAAC,CAAC,GACpC,SAAU,KAAA,CACZ,CACF,EAGF,CACE,KAAM,OACN,SAAU,CACR,OAAQ,GACR,OAAQ,OACR,UAAW,CAAE,MAAO,UAAW,KAAM,SAAU,MAAO,CAAA,EACtD,KAAM,CACJ,CACE,CAAE,MAAOgB,EAAQ,MAAOf,CAAA,EACxB,CAAE,MAAOgB,EAAQ,MAAOhB,CAAA,CAAM,CAChC,EAEF,MAAO,CACL,UAAW,OAAOA,EAAM,QAAQ,CAAC,CAAC,GAClC,SAAU,KAAA,CACZ,CACF,CACF,EAEF,QAAS,CACP,MAAO,GACP,QAAS,CACP,SAAU,CAAE,MAAO,CAAE,KAAM,OAAQ,KAAM,QAAQ,EACjD,QAAS,CAAE,MAAO,OAAA,EAClB,YAAa,CAAE,MAAO,MAAA,CAAO,CAC/B,EAEF,SAAU,CACR,CAAE,KAAM,SAAU,WAAY,CAAA,EAC9B,CAAE,KAAM,SAAU,WAAY,CAAA,CAAE,CAClC,EAGF1B,EAAc,QAAQ,UAAU8C,EAAQ,CAAE,SAAU,GAAO,EAG3D,MAAMC,EAAQ/C,EAAc,QAC5B+C,EAAM,IAAI,WAAW,EACrBA,EAAM,IAAI,UAAU,EACpBA,EAAM,IAAI,OAAO,EAGjBA,EAAM,GAAG,YAAcrH,GAAgB,CACrC,GAAIA,EAAO,gBAAkB,UAAYA,EAAO,MAAM,OAAQ,CAC5D,MAAMsH,EAAQtH,EAAO,OAAO,MAC5B0E,EAAe1E,EAAO,KAAK,MAAM,EAC7BsH,GACF1C,EAAiB,CAAE,EAAG0C,EAAM,QAAS,EAAGA,EAAM,QAAS,CAE3D,CACF,CAAC,EAEDD,EAAM,GAAG,WAAY,IAAM,CACzB3C,EAAe,IAAI,CACrB,CAAC,EAED2C,EAAM,GAAG,QAAUrH,GAAgB,CAC7BA,EAAO,gBAAkB,UAAYA,EAAO,MAAM,SACpD8E,EAAkB9E,EAAO,KAAK,MAAM,EACpC0E,EAAe,IAAI,EAEvB,CAAC,CACH,EAAG,CACDmB,EACAC,EACAG,EACA1B,EACA1J,EACAkL,EACAC,EACAG,CAAA,CACD,EAED,MAAMoB,EAAuBxP,GAA+C,CAC1EyM,EAAa1L,IAAU,CAAE,GAAGA,EAAM,GAAGf,GAAS,CAChD,EAEMyP,EAAkBvE,GAAqB,CAC3CkB,IAAiBlB,CAAQ,EACzB6B,EAAkB,IAAI,CACxB,EAEA,OACE/K,EAAAA,KAAC,MAAA,CAAI,UAAW,GAAG5B,CAAS,GAC1B,SAAA,CAAA4B,EAAAA,KAAC,MAAA,CAAI,UAAU,aAEb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,kBACZ,SAAA,CAAAc,EACClB,EAAAA,IAAC,MAAA,CACC,UAAU,yDACV,MAAO,CAAE,OAAAyK,CAAA,EAET,SAAArK,EAAAA,KAAC,MAAA,CAAI,UAAU,cACb,SAAA,CAAAJ,EAAAA,IAAC,MAAA,CAAI,UAAU,6FAAA,CAA8F,EAC7GA,EAAAA,IAAC,OAAA,CAAK,UAAU,gBAAgB,SAAA,oBAAA,CAAkB,CAAA,CAAA,CACpD,CAAA,CAAA,EAGFA,MAAC,MAAA,CAAI,IAAK0K,EAAU,MAAO,CAAE,OAAAD,EAAQ,MAAO,MAAA,EAAU,EAIvDK,GACC9K,EAAAA,IAACqJ,EAAA,CACE,GAAGyB,EACJ,SAAUA,EAAY,GACtB,SAAUE,EACV,QAAS,EAAA,CAAA,CACX,EAEJ,EAGA5K,EAAAA,KAAC,MAAA,CAAI,UAAU,qBACb,SAAA,CAAAJ,EAAAA,IAAC6I,GAAA,CAAqB,GAAG+B,EAAU,SAAUgD,CAAA,CAAqB,EAGjEtB,EAAW,OAAS,GACnBlM,EAAAA,KAAC,MAAA,CAAI,UAAU,sDACb,SAAA,CAAAA,EAAAA,KAAC,KAAA,CAAG,UAAU,0CAA0C,SAAA,CAAA,eACzCkM,EAAW,OAAO,GAAA,EACjC,EACAlM,EAAAA,KAAC,MAAA,CAAI,UAAU,qCACZ,SAAA,CAAAkM,EAAW,MAAM,EAAG,EAAE,EAAE,IAAKY,GAC5B9M,EAAAA,KAAC,SAAA,CAEC,QAAS,IAAM+K,EAAkB+B,CAAC,EAClC,UAAU,qFAEV,SAAA,CAAAlN,MAAC,QAAK,UAAU,cAAe,SAAAkN,EAAE,MAAQA,EAAE,GAAG,EAC9C9M,EAAAA,KAAC,OAAA,CAAK,UAAU,qBAAqB,SAAA,CAAA,KAChC8M,EAAE,IAAI,QAAQ,CAAC,EAAE,OAAKA,EAAE,EAAE,QAAQ,CAAC,CAAA,CAAA,CACxC,CAAA,CAAA,EAPKA,EAAE,EAAA,CASV,EACAZ,EAAW,OAAS,IACnBlM,EAAAA,KAAC,IAAA,CAAE,UAAU,uBAAuB,SAAA,CAAA,IAAEkM,EAAW,OAAS,GAAG,OAAA,CAAA,CAAK,CAAA,CAAA,CAEtE,CAAA,CAAA,CACF,CAAA,CAAA,CAEJ,CAAA,EACF,EAGCpB,GACClL,EAAAA,IAAC,MAAA,CAAI,UAAU,kEACb,SAAAA,EAAAA,IAACqJ,EAAA,CACE,GAAG6B,EACJ,SAAUA,EAAe,GACzB,QAAS,GACT,WAAY2C,EACZ,QAAS,IAAM1C,EAAkB,IAAI,CAAA,CAAA,CACvC,CACF,CAAA,EAEJ,CAEJ,EC1YM2C,GAA4B,IAAM,CACtC,KAAM,CAAE,KAAMvD,EAAS,UAAArJ,EAAW,MAAAE,CAAA,EAAU2M,EAAA,EACtC,CAACC,EAAWC,CAAY,EAAItP,EAAAA,SAAiC,MAAM,EACnE,CAACuP,EAAaC,CAAc,EAAIxP,EAAAA,SAA4B,CAAA,CAAE,EAC9D,CAACyP,EAAqBC,CAAsB,EAAI1P,EAAAA,SAAS,EAAK,EAC9D,CAAC2P,EAAiBC,CAAkB,EAAI5P,EAAAA,SAA0B,CAAA,CAAE,EACpE,CAAC6P,EAAiBC,CAAkB,EAAI9P,EAAAA,SAAS,EAAK,EAGtD+P,EAAoC,CACxC,CACE,GAAI,OACJ,MAAO,cACP,KAAM,OACN,MAAO,QACP,YAAa,mBAAA,EAEf,CACE,GAAI,UACJ,MAAO,gBACP,KAAM,QACN,MAAO,OACP,IAAK,EACL,IAAK,EACL,KAAM,KACN,KAAM,IAAA,EAER,CACE,GAAI,UACJ,MAAO,gBACP,KAAM,QACN,MAAO,OACP,IAAK,EACL,IAAK,EACL,KAAM,KACN,KAAM,IAAA,EAER,CACE,GAAI,YACJ,MAAO,iBACP,KAAM,QACN,MAAO,cACP,IAAK,EACL,IAAK,IACL,KAAM,CAAA,EAER,CAAE,GAAI,WAAY,MAAO,gBAAiB,KAAM,WAAY,MAAO,aAAA,CAAc,EAI7EC,EAAkBC,EAAmB,GAAM,EAAE,eAAe,EAC5DC,EAAwBD,EAAmB,GAAM,EAAE,qBAAqB,EACxEE,EAAmBF,EAAmB,GAAM,EAAE,gBAAgB,EAC9DG,EAAuBH,EAAmB,GAAM,EAAE,oBAAoB,EAEtEI,EAAcnQ,EAAAA,QAAQ,IAAM,MAAM,KAAK8P,CAAe,EAAG,CAACA,CAAe,CAAC,EAE1EM,EAAuB/P,EAAAA,YAAY,IAAM,CACzC8P,EAAY,SAAW,GAC3BP,EAAmB,EAAI,CACzB,EAAG,CAACO,CAAW,CAAC,EAEVE,EAAgBhQ,EAAAA,YAAY,IAAM,CAEtC,OAAO,KAAK,2EAAiC8P,EAAY,KAAK,GAAG,CAAC,GAAI,QAAQ,EAC9EP,EAAmB,EAAK,CAC1B,EAAG,CAACO,CAAW,CAAC,EAGV9C,EAAkBrN,EAAAA,QAAQ,IAAM,CACpC,GAAI,CAAC0L,EAAS,MAAO,CAAA,EACrB,IAAIjJ,EAASiJ,EAGb,GAAI2D,EAAY,KAAO,QAAaA,EAAY,MAAQ,QAAaA,EAAY,OAAQ,CACvF,KAAM,CAAE,GAAA/L,EAAI,IAAAC,EAAK,OAAA+M,CAAA,EAAWjB,EAC5B5M,EAASA,EAAO,OAAQ6I,GAAM,CAC5B,GAAIA,EAAE,SAAW,QAAaA,EAAE,UAAY,OAAW,MAAO,GAE9D,MAAMiF,GAAOjF,EAAE,OAAShI,GAAM,KAAK,IAAKC,EAAM,KAAK,GAAM,GAAG,EACtDiN,EAAOlF,EAAE,QAAU/H,EAEzB,OADa,KAAK,KAAKgN,EAAMA,EAAMC,EAAOA,CAAI,EAAI,IACnCF,CACjB,CAAC,CACH,CAaA,GAVIjB,EAAY,UAAY,SAC1B5M,EAASA,EAAO,OAAQ6I,IAAOA,EAAE,cAAgB,KAAO+D,EAAY,SAAW,EAAE,GAE/EA,EAAY,UAAY,SAC1B5M,EAASA,EAAO,OACb6I,IAAOA,EAAE,cAAgB,OAAc+D,EAAY,SAAW,IAAA,GAK/DI,EAAgB,MAAQ,OAAOA,EAAgB,MAAS,SAAU,CACpE,MAAMgB,EAAOhB,EAAgB,KAAK,YAAA,EAClChN,EAASA,EAAO,OACb6I,GAAMA,EAAE,MAAM,cAAc,SAASmF,CAAI,GAAKnF,EAAE,GAAG,YAAA,EAAc,SAASmF,CAAI,CAAA,CAEnF,CACA,OAAIhB,EAAgB,WAAa,OAAOA,EAAgB,WAAc,WACpEhN,EAASA,EAAO,OAAQ6I,IAAOA,EAAE,YAAc,IAAOmE,EAAgB,SAAoB,GAExFA,EAAgB,WAAa,KAC/BhN,EAASA,EAAO,OACb6I,GAAMA,EAAE,MAAQ,QAAaA,EAAE,IAAM,SAAcA,EAAE,IAAM,GAAKA,EAAE,EAAI,GAAA,GAIpE7I,CACT,EAAG,CAACiJ,EAAS2D,EAAaI,CAAe,CAAC,EAEpC,CAAE,WAAAiB,EAAY,cAAAC,EAAe,WAAAC,EAAY,WAAAC,CAAA,EAC7CC,EAAqBzD,CAAe,EAGhC0D,EAAiC/Q,EAAAA,QAAQ,IACxC0L,EACGA,EACL,OACE,GACC,EAAE,MAAQ,QACV,EAAE,IAAM,QACR,EAAE,SAAW,QACb,EAAE,UAAY,MAAA,EAEjB,IAAK,IAAO,CACX,GAAI,EAAE,GACN,KAAM,EAAE,MAAQ,EAAE,GAClB,GAAI,EAAE,OACN,IAAK,EAAE,QACP,IAAK,EAAE,IACP,EAAG,EAAE,EACL,SAAU,EAAE,aACZ,cAAe,EAAE,UAAA,EACjB,EAlBiB,CAAA,EAmBpB,CAACA,CAAO,CAAC,EAEZ,OAAIrJ,EACKlB,EAAAA,IAAC6P,EAAA,CAAe,MAAM,qBAAqB,EAGhDzO,EAEAhB,EAAAA,KAAC,MAAA,CAAI,UAAU,oEAAoE,SAAA,CAAA,2BACxDgB,EAAM,OAAA,EACjC,EAKFhB,EAAAA,KAAC,MAAA,CAAI,UAAU,oBACb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,yCACb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,0BACb,SAAA,OAAC,KAAA,CAAG,UAAU,mCAAmC,SAAA,UAAO,EACvD4O,EAAY,OAAS,GACpB5O,EAAAA,KAAC,OAAA,CAAK,UAAU,wBAAyB,SAAA,CAAA4O,EAAY,OAAO,WAAA,EAAS,CAAA,EAEzE,EACA5O,EAAAA,KAAC,MAAA,CAAI,UAAU,aACZ,SAAA,CAAA4O,EAAY,OAAS,GACpBhP,EAAAA,IAAC,SAAA,CACC,QAASiP,EACT,UAAU,wGACX,SAAA,iBAAA,CAAA,EAIHjP,EAAAA,IAAC,SAAA,CACC,UAAW,8DACTgO,IAAc,OACV,yBACA,6CACN,GACA,QAAS,IAAMC,EAAa,MAAM,EACnC,SAAA,WAAA,CAAA,EAGDjO,EAAAA,IAAC,SAAA,CACC,UAAW,8DACTgO,IAAc,cACV,yBACA,6CACN,GACA,QAAS,IAAMC,EAAa,aAAa,EAC1C,SAAA,kBAAA,CAAA,CAED,EACF,CAAA,EACF,EAGAjO,EAAAA,IAAC,OAAI,UAAU,OACb,eAACiG,GAAA,CAAmB,cAAekI,CAAA,CAAgB,EACrD,EAGA/N,EAAAA,KAAC,MAAA,CAAI,UAAU,OACb,SAAA,CAAAJ,EAAAA,IAAC,SAAA,CACC,QAAS,IAAMqO,EAAuB,CAACD,CAAmB,EAC1D,UAAU,iDAET,WAAsB,wBAA0B,uBAAA,CAAA,EAElDA,GACCpO,EAAAA,IAAC9B,GAAA,CACC,QAASwQ,EACT,OAAQJ,EACR,SAAUC,EACV,QAAS,IAAM,CAAC,EAChB,QAAS,IAAMA,EAAmB,CAAA,CAAE,CAAA,CAAA,CACtC,EAEJ,EAGAvO,EAAAA,IAAC8P,EAAA,CACC,OAAQtB,EACR,QAAS,IAAMC,EAAmB,EAAK,EACvC,MAAM,iBACN,KAAK,KACL,OACErO,EAAAA,KAAC,MAAA,CAAI,UAAU,yBACb,SAAA,CAAAJ,EAAAA,IAAC,SAAA,CACC,QAAS,IAAMyO,EAAmB,EAAK,EACvC,UAAU,wEACX,SAAA,QAAA,CAAA,EAGDrO,EAAAA,KAAC,SAAA,CACC,QAAS8O,EACT,UAAU,uEACX,SAAA,CAAA,UACSF,EAAY,OAAO,UAAA,CAAA,CAAA,CAC7B,EACF,EAGF,SAAA5O,EAAAA,KAAC,IAAA,CAAE,UAAU,gBAAgB,SAAA,CAAA,iCACF,SAAA,CAAQ,SAAA4O,EAAY,OAAO,EAAS,wEAAA,EAE/D,CAAA,CAAA,EAGDhB,IAAc,oBAEZ,MAAA,CAAI,UAAU,WACZ,SAAA4B,EAAgB,OAAS,EACxB5P,EAAAA,IAACsK,GAAA,CACC,QAASsF,EACT,eAAiBtG,GAAc,OAAO,SAAS,KAAO,YAAYA,CAAQ,GAC1E,OAAQ,GAAA,CAAA,EAGVtJ,EAAAA,IAAC,IAAA,CAAE,UAAU,iCAAiC,uGAG9C,CAAA,CAEJ,EAGAI,OAAAqI,EAAAA,SAAA,CACE,SAAA,CAAArI,EAAAA,KAAC,IAAA,CAAE,UAAU,6BAA6B,SAAA,CAAA,WAC/B8L,EAAgB,OAAO,OAAM3B,GAAsB,QAAU,EAAE,UAAA,EAC1E,EAECmF,GAAcA,EAAW,OAAS,QAChC,MAAA,CAAI,UAAU,uBACb,SAAAtP,EAAAA,KAAC,QAAA,CAAM,UAAU,QACf,SAAA,OAAC,QAAA,CACC,gBAAC,KAAA,CACC,SAAA,CAAAJ,EAAAA,IAAC,KAAA,CAAG,UAAU,iBACZ,SAAAA,EAAAA,IAAC,QAAA,CACC,KAAK,WACL,QAASgP,EAAY,SAAWU,EAAW,QAAUA,EAAW,OAAS,EACzE,IAAMK,GAAO,CACPA,IACFA,EAAG,cACDf,EAAY,OAAS,GAAKA,EAAY,OAASU,EAAW,OAChE,EACA,SAAU,IAAM,CACVV,EAAY,SAAWU,EAAW,OACpCX,EAAA,EAEAD,EAAiBY,EAAW,IAAK,GAAM,EAAE,EAAE,CAAC,CAEhD,EACA,UAAU,+BAAA,CAAA,EAEd,EACA1P,EAAAA,IAACgQ,EAAA,CACC,UAAU,KACV,WAAAT,EACA,cAAAC,EACA,OAAQC,EACT,SAAA,IAAA,CAAA,EAGDzP,EAAAA,IAACgQ,EAAA,CACC,UAAU,OACV,WAAAT,EACA,cAAAC,EACA,OAAQC,EACT,SAAA,MAAA,CAAA,EAGDzP,EAAAA,IAACgQ,EAAA,CACC,UAAU,SACV,WAAAT,EACA,cAAAC,EACA,OAAQC,EACR,UAAU,aACX,SAAA,UAAA,CAAA,EAGDzP,EAAAA,IAACgQ,EAAA,CACC,UAAU,UACV,WAAAT,EACA,cAAAC,EACA,OAAQC,EACR,UAAU,aACX,SAAA,WAAA,CAAA,EAGDzP,EAAAA,IAACgQ,EAAA,CACC,UAAU,aACV,WAAAT,EACA,cAAAC,EACA,OAAQC,EACR,UAAU,cACX,SAAA,QAAA,CAAA,CAED,CAAA,CACF,CAAA,CACF,QACC,QAAA,CAAM,UAAU,2BACd,SAAAC,EAAW,IAAKjD,GACfrM,EAAAA,KAAC,KAAA,CAEC,UAAWuO,EAAgB,IAAIlC,EAAO,EAAE,EAAI,aAAe,GAE3D,SAAA,CAAAzM,EAAAA,IAAC,KAAA,CAAG,UAAU,OACZ,SAAAA,EAAAA,IAAC,QAAA,CACC,KAAK,WACL,QAAS2O,EAAgB,IAAIlC,EAAO,EAAE,EACtC,SAAU,IAAMoC,EAAsBpC,EAAO,EAAE,EAC/C,UAAU,+BAAA,CAAA,EAEd,QACC,KAAA,CACC,SAAAzM,EAAAA,IAACiQ,EAAA,CACC,GAAI,YAAYxD,EAAO,EAAE,GACzB,UAAU,gDAET,SAAAA,EAAO,EAAA,CAAA,EAEZ,QACC,KAAA,CAAI,SAAAA,EAAO,MAAQ,IAAI,EACxBzM,EAAAA,IAAC,MAAG,UAAU,uBAAwB,WAAO,QAAQ,QAAQ,CAAC,EAAE,EAChEA,EAAAA,IAAC,MAAG,UAAU,uBAAwB,WAAO,SAAS,QAAQ,CAAC,EAAE,QAChE,KAAA,CAAG,UAAU,cAAe,SAAAyM,EAAO,YAAc,GAAA,CAAI,CAAA,CAAA,EAtBjDA,EAAO,EAAA,CAwBf,EACH,CAAA,EACF,CAAA,CACF,EAEAzM,MAAC,IAAA,CAAE,UAAU,gBAAgB,SAAA,mBAAA,CAAiB,CAAA,EAElD,CAAA,EAEJ,CAEJ"}