// vitest.config.ts
import { defineConfig } from "file:///data/dsa110-contimg/frontend/node_modules/vitest/dist/config.js";
import react from "file:///data/dsa110-contimg/frontend/node_modules/@vitejs/plugin-react/dist/index.js";
import { webcrypto } from "node:crypto";
import { execSync } from "child_process";
var CASA6_NODE = "/opt/miniforge/envs/casa6/bin/node";
var REQUIRED_VERSION = "22.0.0";
function checkCasa6Node() {
  try {
    const currentNode = execSync("which node", { encoding: "utf-8" }).trim();
    const currentVersion = execSync("node --version", { encoding: "utf-8" }).trim().replace("v", "");
    if (currentNode !== CASA6_NODE) {
      console.error("\n\u274C ERROR: Frontend tests require casa6 Node.js v22.6.0");
      console.error(`   Current: ${currentNode} (v${currentVersion})`);
      console.error(`   Required: ${CASA6_NODE} (v22.6.0)`);
      console.error("\n   Fix: source /opt/miniforge/etc/profile.d/conda.sh && conda activate casa6\n");
      process.exit(1);
    }
    const versionParts = currentVersion.split(".").map(Number);
    const requiredParts = REQUIRED_VERSION.split(".").map(Number);
    if (versionParts[0] < requiredParts[0] || versionParts[0] === requiredParts[0] && versionParts[1] < requiredParts[1]) {
      console.error("\n\u274C ERROR: Node.js version too old");
      console.error(`   Current: v${currentVersion}`);
      console.error(`   Required: v${REQUIRED_VERSION}+`);
      console.error("\n   Fix: Use casa6 Node.js v22.6.0\n");
      process.exit(1);
    }
  } catch (error) {
    console.error("\n\u274C ERROR: Failed to check Node.js version");
    console.error("   Fix: Ensure casa6 is activated\n");
    process.exit(1);
  }
}
checkCasa6Node();
if (typeof globalThis.crypto === "undefined") {
  globalThis.crypto = webcrypto;
}
if (globalThis.crypto && !globalThis.crypto.getRandomValues) {
  globalThis.crypto.getRandomValues = webcrypto.getRandomValues.bind(webcrypto);
}
var API_PROXY_TARGET = process.env.API_PROXY_TARGET || "http://localhost:8010";
var vitest_config_default = defineConfig({
  plugins: [react()],
  server: {
    proxy: {
      "/api": {
        target: API_PROXY_TARGET,
        changeOrigin: true
      }
    }
  },
  test: {
    globals: true,
    environment: "jsdom",
    // Use node environment for backend API/client smoke tests to avoid jsdom/webcrypto issues
    environmentMatchGlobs: [["src/api/**", "node"]],
    setupFiles: "./src/test/setup.ts"
  }
});
export {
  vitest_config_default as default
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsidml0ZXN0LmNvbmZpZy50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiY29uc3QgX192aXRlX2luamVjdGVkX29yaWdpbmFsX2Rpcm5hbWUgPSBcIi9kYXRhL2RzYTExMC1jb250aW1nL2Zyb250ZW5kXCI7Y29uc3QgX192aXRlX2luamVjdGVkX29yaWdpbmFsX2ZpbGVuYW1lID0gXCIvZGF0YS9kc2ExMTAtY29udGltZy9mcm9udGVuZC92aXRlc3QuY29uZmlnLnRzXCI7Y29uc3QgX192aXRlX2luamVjdGVkX29yaWdpbmFsX2ltcG9ydF9tZXRhX3VybCA9IFwiZmlsZTovLy9kYXRhL2RzYTExMC1jb250aW1nL2Zyb250ZW5kL3ZpdGVzdC5jb25maWcudHNcIjtpbXBvcnQgeyBkZWZpbmVDb25maWcgfSBmcm9tICd2aXRlc3QvY29uZmlnJztcbmltcG9ydCByZWFjdCBmcm9tICdAdml0ZWpzL3BsdWdpbi1yZWFjdCc7XG5pbXBvcnQgeyB3ZWJjcnlwdG8gfSBmcm9tICdub2RlOmNyeXB0byc7XG5pbXBvcnQgeyBleGVjU3luYyB9IGZyb20gJ2NoaWxkX3Byb2Nlc3MnO1xuaW1wb3J0IHsgZXhpc3RzU3luYyB9IGZyb20gJ2ZzJztcblxuLy8gQ1JJVElDQUw6IEVuZm9yY2UgY2FzYTYgTm9kZS5qcyB2MjIuNi4wIHJlcXVpcmVtZW50XG4vLyBUaGlzIGNoZWNrIHJ1bnMgYmVmb3JlIFZpdGVzdCBsb2FkcywgcHJldmVudGluZyBjcnlwdG8gZXJyb3JzXG5jb25zdCBDQVNBNl9OT0RFID0gJy9vcHQvbWluaWZvcmdlL2VudnMvY2FzYTYvYmluL25vZGUnO1xuY29uc3QgUkVRVUlSRURfVkVSU0lPTiA9ICcyMi4wLjAnO1xuXG5mdW5jdGlvbiBjaGVja0Nhc2E2Tm9kZSgpOiB2b2lkIHtcbiAgdHJ5IHtcbiAgICBjb25zdCBjdXJyZW50Tm9kZSA9IGV4ZWNTeW5jKCd3aGljaCBub2RlJywgeyBlbmNvZGluZzogJ3V0Zi04JyB9KS50cmltKCk7XG4gICAgY29uc3QgY3VycmVudFZlcnNpb24gPSBleGVjU3luYygnbm9kZSAtLXZlcnNpb24nLCB7IGVuY29kaW5nOiAndXRmLTgnIH0pLnRyaW0oKS5yZXBsYWNlKCd2JywgJycpO1xuICAgIFxuICAgIGlmIChjdXJyZW50Tm9kZSAhPT0gQ0FTQTZfTk9ERSkge1xuICAgICAgY29uc29sZS5lcnJvcignXFxuXHUyNzRDIEVSUk9SOiBGcm9udGVuZCB0ZXN0cyByZXF1aXJlIGNhc2E2IE5vZGUuanMgdjIyLjYuMCcpO1xuICAgICAgY29uc29sZS5lcnJvcihgICAgQ3VycmVudDogJHtjdXJyZW50Tm9kZX0gKHYke2N1cnJlbnRWZXJzaW9ufSlgKTtcbiAgICAgIGNvbnNvbGUuZXJyb3IoYCAgIFJlcXVpcmVkOiAke0NBU0E2X05PREV9ICh2MjIuNi4wKWApO1xuICAgICAgY29uc29sZS5lcnJvcignXFxuICAgRml4OiBzb3VyY2UgL29wdC9taW5pZm9yZ2UvZXRjL3Byb2ZpbGUuZC9jb25kYS5zaCAmJiBjb25kYSBhY3RpdmF0ZSBjYXNhNlxcbicpO1xuICAgICAgcHJvY2Vzcy5leGl0KDEpO1xuICAgIH1cbiAgICBcbiAgICAvLyBDaGVjayB2ZXJzaW9uIG1lZXRzIG1pbmltdW1cbiAgICBjb25zdCB2ZXJzaW9uUGFydHMgPSBjdXJyZW50VmVyc2lvbi5zcGxpdCgnLicpLm1hcChOdW1iZXIpO1xuICAgIGNvbnN0IHJlcXVpcmVkUGFydHMgPSBSRVFVSVJFRF9WRVJTSU9OLnNwbGl0KCcuJykubWFwKE51bWJlcik7XG4gICAgXG4gICAgaWYgKHZlcnNpb25QYXJ0c1swXSA8IHJlcXVpcmVkUGFydHNbMF0gfHwgXG4gICAgICAgICh2ZXJzaW9uUGFydHNbMF0gPT09IHJlcXVpcmVkUGFydHNbMF0gJiYgdmVyc2lvblBhcnRzWzFdIDwgcmVxdWlyZWRQYXJ0c1sxXSkpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1xcblx1Mjc0QyBFUlJPUjogTm9kZS5qcyB2ZXJzaW9uIHRvbyBvbGQnKTtcbiAgICAgIGNvbnNvbGUuZXJyb3IoYCAgIEN1cnJlbnQ6IHYke2N1cnJlbnRWZXJzaW9ufWApO1xuICAgICAgY29uc29sZS5lcnJvcihgICAgUmVxdWlyZWQ6IHYke1JFUVVJUkVEX1ZFUlNJT059K2ApO1xuICAgICAgY29uc29sZS5lcnJvcignXFxuICAgRml4OiBVc2UgY2FzYTYgTm9kZS5qcyB2MjIuNi4wXFxuJyk7XG4gICAgICBwcm9jZXNzLmV4aXQoMSk7XG4gICAgfVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ1xcblx1Mjc0QyBFUlJPUjogRmFpbGVkIHRvIGNoZWNrIE5vZGUuanMgdmVyc2lvbicpO1xuICAgIGNvbnNvbGUuZXJyb3IoJyAgIEZpeDogRW5zdXJlIGNhc2E2IGlzIGFjdGl2YXRlZFxcbicpO1xuICAgIHByb2Nlc3MuZXhpdCgxKTtcbiAgfVxufVxuXG4vLyBSdW4gY2hlY2sgYmVmb3JlIFZpdGVzdCBsb2FkcyAoY2Fubm90IGJlIGJ5cGFzc2VkKVxuY2hlY2tDYXNhNk5vZGUoKTtcblxuLy8gRW5zdXJlIFdlYiBDcnlwdG8gQVBJIGV4aXN0cyBlYXJseSBmb3IgVml0ZS9WaXRlc3Qgc3RhcnR1cFxuLy8gTm9kZSAxNisgcmVxdWlyZXMgZXhwbGljaXQgc2V0dXAgZm9yIGNyeXB0by5nZXRSYW5kb21WYWx1ZXNcbmlmICh0eXBlb2YgZ2xvYmFsVGhpcy5jcnlwdG8gPT09ICd1bmRlZmluZWQnKSB7XG4gIChnbG9iYWxUaGlzIGFzIGFueSkuY3J5cHRvID0gd2ViY3J5cHRvIGFzIGFueTtcbn1cblxuLy8gRW5zdXJlIGdldFJhbmRvbVZhbHVlcyBpcyBhdmFpbGFibGUgKHJlcXVpcmVkIGJ5IFZpdGUvVml0ZXN0KVxuaWYgKGdsb2JhbFRoaXMuY3J5cHRvICYmICFnbG9iYWxUaGlzLmNyeXB0by5nZXRSYW5kb21WYWx1ZXMpIHtcbiAgKGdsb2JhbFRoaXMuY3J5cHRvIGFzIGFueSkuZ2V0UmFuZG9tVmFsdWVzID0gd2ViY3J5cHRvLmdldFJhbmRvbVZhbHVlcy5iaW5kKHdlYmNyeXB0byk7XG59XG5cbi8vIGh0dHBzOi8vdml0ZS5kZXYvY29uZmlnL1xuY29uc3QgQVBJX1BST1hZX1RBUkdFVCA9IHByb2Nlc3MuZW52LkFQSV9QUk9YWV9UQVJHRVQgfHwgJ2h0dHA6Ly9sb2NhbGhvc3Q6ODAxMCc7XG5cbmV4cG9ydCBkZWZhdWx0IGRlZmluZUNvbmZpZyh7XG4gIHBsdWdpbnM6IFtyZWFjdCgpXSxcbiAgc2VydmVyOiB7XG4gICAgcHJveHk6IHtcbiAgICAgICcvYXBpJzoge1xuICAgICAgICB0YXJnZXQ6IEFQSV9QUk9YWV9UQVJHRVQsXG4gICAgICAgIGNoYW5nZU9yaWdpbjogdHJ1ZSxcbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIHRlc3Q6IHtcbiAgICBnbG9iYWxzOiB0cnVlLFxuICAgIGVudmlyb25tZW50OiAnanNkb20nLFxuICAgIC8vIFVzZSBub2RlIGVudmlyb25tZW50IGZvciBiYWNrZW5kIEFQSS9jbGllbnQgc21va2UgdGVzdHMgdG8gYXZvaWQganNkb20vd2ViY3J5cHRvIGlzc3Vlc1xuICAgIGVudmlyb25tZW50TWF0Y2hHbG9iczogW1tcInNyYy9hcGkvKipcIiwgXCJub2RlXCJdXSxcbiAgICBzZXR1cEZpbGVzOiAnLi9zcmMvdGVzdC9zZXR1cC50cycsXG4gIH0sXG59KTtcbiJdLAogICJtYXBwaW5ncyI6ICI7QUFBNlEsU0FBUyxvQkFBb0I7QUFDMVMsT0FBTyxXQUFXO0FBQ2xCLFNBQVMsaUJBQWlCO0FBQzFCLFNBQVMsZ0JBQWdCO0FBS3pCLElBQU0sYUFBYTtBQUNuQixJQUFNLG1CQUFtQjtBQUV6QixTQUFTLGlCQUF1QjtBQUM5QixNQUFJO0FBQ0YsVUFBTSxjQUFjLFNBQVMsY0FBYyxFQUFFLFVBQVUsUUFBUSxDQUFDLEVBQUUsS0FBSztBQUN2RSxVQUFNLGlCQUFpQixTQUFTLGtCQUFrQixFQUFFLFVBQVUsUUFBUSxDQUFDLEVBQUUsS0FBSyxFQUFFLFFBQVEsS0FBSyxFQUFFO0FBRS9GLFFBQUksZ0JBQWdCLFlBQVk7QUFDOUIsY0FBUSxNQUFNLDhEQUF5RDtBQUN2RSxjQUFRLE1BQU0sZUFBZSxXQUFXLE1BQU0sY0FBYyxHQUFHO0FBQy9ELGNBQVEsTUFBTSxnQkFBZ0IsVUFBVSxZQUFZO0FBQ3BELGNBQVEsTUFBTSxrRkFBa0Y7QUFDaEcsY0FBUSxLQUFLLENBQUM7QUFBQSxJQUNoQjtBQUdBLFVBQU0sZUFBZSxlQUFlLE1BQU0sR0FBRyxFQUFFLElBQUksTUFBTTtBQUN6RCxVQUFNLGdCQUFnQixpQkFBaUIsTUFBTSxHQUFHLEVBQUUsSUFBSSxNQUFNO0FBRTVELFFBQUksYUFBYSxDQUFDLElBQUksY0FBYyxDQUFDLEtBQ2hDLGFBQWEsQ0FBQyxNQUFNLGNBQWMsQ0FBQyxLQUFLLGFBQWEsQ0FBQyxJQUFJLGNBQWMsQ0FBQyxHQUFJO0FBQ2hGLGNBQVEsTUFBTSx5Q0FBb0M7QUFDbEQsY0FBUSxNQUFNLGdCQUFnQixjQUFjLEVBQUU7QUFDOUMsY0FBUSxNQUFNLGlCQUFpQixnQkFBZ0IsR0FBRztBQUNsRCxjQUFRLE1BQU0sdUNBQXVDO0FBQ3JELGNBQVEsS0FBSyxDQUFDO0FBQUEsSUFDaEI7QUFBQSxFQUNGLFNBQVMsT0FBTztBQUNkLFlBQVEsTUFBTSxpREFBNEM7QUFDMUQsWUFBUSxNQUFNLHFDQUFxQztBQUNuRCxZQUFRLEtBQUssQ0FBQztBQUFBLEVBQ2hCO0FBQ0Y7QUFHQSxlQUFlO0FBSWYsSUFBSSxPQUFPLFdBQVcsV0FBVyxhQUFhO0FBQzVDLEVBQUMsV0FBbUIsU0FBUztBQUMvQjtBQUdBLElBQUksV0FBVyxVQUFVLENBQUMsV0FBVyxPQUFPLGlCQUFpQjtBQUMzRCxFQUFDLFdBQVcsT0FBZSxrQkFBa0IsVUFBVSxnQkFBZ0IsS0FBSyxTQUFTO0FBQ3ZGO0FBR0EsSUFBTSxtQkFBbUIsUUFBUSxJQUFJLG9CQUFvQjtBQUV6RCxJQUFPLHdCQUFRLGFBQWE7QUFBQSxFQUMxQixTQUFTLENBQUMsTUFBTSxDQUFDO0FBQUEsRUFDakIsUUFBUTtBQUFBLElBQ04sT0FBTztBQUFBLE1BQ0wsUUFBUTtBQUFBLFFBQ04sUUFBUTtBQUFBLFFBQ1IsY0FBYztBQUFBLE1BQ2hCO0FBQUEsSUFDRjtBQUFBLEVBQ0Y7QUFBQSxFQUNBLE1BQU07QUFBQSxJQUNKLFNBQVM7QUFBQSxJQUNULGFBQWE7QUFBQTtBQUFBLElBRWIsdUJBQXVCLENBQUMsQ0FBQyxjQUFjLE1BQU0sQ0FBQztBQUFBLElBQzlDLFlBQVk7QUFBQSxFQUNkO0FBQ0YsQ0FBQzsiLAogICJuYW1lcyI6IFtdCn0K
