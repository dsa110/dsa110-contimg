<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Quicklook QA</title>
  <style>
    body { font-family: system-ui, sans-serif; margin: 16px; }
    h2 { margin-bottom: 8px; }
    .toolbar { display: flex; gap: 8px; align-items: center; margin-bottom: 12px; }
    .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); grid-gap: 12px; }
    .card { border: 1px solid #ddd; border-radius: 6px; padding: 8px; }
    .meta { font-size: 12px; color: #666; margin: 4px 0; }
    img { max-width: 100%; height: auto; display: block; border: 1px solid #eee; }
  </style>
  <script>
    async function load() {
      const limit = document.getElementById('limit').value || 100;
      const resp = await fetch(`/api/qa?limit=${encodeURIComponent(limit)}`);
      if (!resp.ok) throw new Error(`HTTP ${resp.status}`);
      const data = await resp.json();
      const items = (data && data.items) || [];
      const grid = document.getElementById('grid');
      if (!items.length) { grid.innerHTML = '<div class="meta">No QA artifacts</div>'; return; }
      grid.innerHTML = items.map(it => {
        const url = `/api/qa/file/${encodeURIComponent(it.group_id)}/${encodeURIComponent(it.name)}`;
        const ts = it.created_at || '';
        return `<div class="card">
          <div class="meta"><strong>${it.group_id}</strong></div>
          <div class="meta">${it.name}</div>
          <div class="meta">${ts}</div>
          <a href="${url}" target="_blank"><img src="${url}" alt="${it.name}"/></a>
        </div>`;
      }).join('');
    }
    function init(){
      document.getElementById('refresh').addEventListener('click', load);
      load();
    }
    window.addEventListener('DOMContentLoaded', init);
  </script>
</head>
<body>
  <h2>Quicklook QA</h2>
  <div class="toolbar">
    <label>Limit <input type="number" id="limit" value="100" min="1" max="500" style="width:80px;"></label>
    <button id="refresh">Refresh</button>
  </div>
  <div id="grid" class="grid"></div>
</body>
</html>

